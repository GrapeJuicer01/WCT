param_list:
  PPBillDiscount:
    default_local_currency_precision:
      -1000000
    default_apply_region_id:
      731
    default_create_user:
      3044336
    default_project:
      "'PTCL'"

PPBillDiscount:
  dst_table:
    - cpc.BILLING_PLAN_TYPE
    - cpc.DP
    - cpc.DISCT_OBJ
    - cpc.DISCT_OBJ_TYPE
    - cpc.DISTRIBUTE_METHOD
    - cpc.DP_TYPE
    - cpc.DP_RULE
    - cpc.TAB_DP
    - cpc.TAB_DP_DT
    - cpc.TAB_DP_TYPE
    - cpc.DISCT_CALC_METHOD
    - cpc.TAB_DP_COND_GRP
    - cpc.DP_REF_COND_TYPE
    - cpc.TAB_DP_COND_GRP_DT
    - cpc.REF_VALUE


  mid_table:
    - DC_CONFIG_PP_BILL_DISCT
    - DC_CONFIG_PP_BILL_ACCTITEM
    - DC_CONFIG_PP_DISCT_COND
    - DELETE_BILL_DISCT_ACCTITEM
    - DELETE_BILL_DISCT_COND
    - DELETE_BILL_DISCT

  insert_Bill_Discount_ALL:
    - |
      INSERT INTO cpc.DP
        ( DP_ID   ,
          DP_TYPE ,
          BILLING_PLAN_TYPE  ,
          PRICE_SET_ID   ,
          DP_NAME ,
          COMMENTS  ,
          PRIORITY ,
          SP_ID ,
          GST_TYPE
        )
        SELECT  DP_ID_SEQ.nextval ,
               'T',t1.BILLING_PLAN_TYPE,
               t5.PRICE_SET_ID,
               t.DP_NAME,
               t.OLD_OFFER_ID||'-'||nvl( t.COMMENTS, t.DP_NAME),
               t.DP_SEQ,
               0,null
        FROM DC_CONFIG_PP_BILL_DISCT t
         inner join cpc.BILLING_PLAN_TYPE t1
               on t.BILLING_PLAN_TYPE = t1.BILLING_PLAN_TYPE_NAME
         inner join price_plan t3
               on t3.PRICE_PLAN_ID= t.PRICE_PLAN_ID
         inner join PRICE_PLAN_VER t4
               on t4.PRICE_PLAN_ID= t3.PRICE_PLAN_ID
         inner join PRICE_PLAN_MEMBER t5
               on t4.PRICE_PLAN_VER_ID= t5.PRICE_PLAN_VER_ID
         left join DP t6
               on t6.DP_NAME = t.DP_NAME
                and t6.PRICE_SET_ID = t5.PRICE_SET_ID
                and t6.PRIORITY = t.DP_SEQ
       where t.SEQ_NBR =1
              and t6.DP_ID is  null
              and  (t.oper_type is null or t.oper_type = 'A')

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP
        (  TAB_DP_COND_GRP_ID   ,
           TAB_DP_COND_GRP_NAME ,
           DP_REF_COND_TYPE   ,
           DP_ID
         )
        SELECT  TAB_DP_COND_GRP_ID_SEQ.nextval ,
                t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.REF_DISCT_OBJ_NAME||'-Refer',
               'A',
                null
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan t1
                 on t1.PRICE_PLAN_ID = t.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t1.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
        where t.REF_DISCT_OBJ_NAME is not null and t.SEQ_NBR = 1

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP
        (  TAB_DP_COND_GRP_ID   ,
           TAB_DP_COND_GRP_NAME ,
           DP_REF_COND_TYPE   ,
           DP_ID
         )
        SELECT  TAB_DP_COND_GRP_ID_SEQ.nextval ,
                t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.CALC_DISCT_OBJ_NAME||'-Calc',
               'A',
                null
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan t1
                 on t1.PRICE_PLAN_ID = t.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t1.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
        where t.CALC_DISCT_OBJ_NAME is not null and t.SEQ_NBR = 1


    - |
      INSERT INTO cpc.TAB_DP_COND_GRP
        (  TAB_DP_COND_GRP_ID   ,
           TAB_DP_COND_GRP_NAME ,
           DP_REF_COND_TYPE ,
           DP_ID
         )
        SELECT  TAB_DP_COND_GRP_ID_SEQ.nextval ,
                t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.APPLY_DISCT_OBJ_NAME||'-Disct',
               'A',
                null
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan t1
                 on t1.PRICE_PLAN_ID = t.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t1.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
        where t.APPLY_DISCT_OBJ_NAME is not null and t.SEQ_NBR = 1

    - |
      INSERT INTO cpc.DISCT_OBJ
        (  DISCT_OBJ_ID   ,
          DISCT_OBJ_NAME  ,
          DISCT_OBJ_TYPE ,
          TAB_DP_COND_GRP_ID ,
          SP_ID  ,
          MEMBER_ALIAS ,
          GST_SEQ  ,
          CURRENCY_CODE,
          IF_INCLUDE,
          ACCT_ITEM_GROUP_ID
         )
        SELECT  DISCT_OBJ_ID_SEQ.nextval,
                t.REF_DISCT_OBJ_NAME||'-Refer','A', t2.TAB_DP_COND_GRP_ID,
                0,null,null,null,'Y',t4.ACCT_ITEM_GROUP_ID
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan t1
                 on t1.PRICE_PLAN_ID = t.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t1.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP_COND_GRP T2
                on t2.TAB_DP_COND_GRP_NAME = t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.REF_DISCT_OBJ_NAME||'-Refer'
             left join CBEC_ACCT_ITEM_GROUP t4
                on t4.ACCT_ITEM_GROUP_NAME = t.REF_DISCT_ACCT_ITEM_GNP
        where t.REF_DISCT_OBJ_NAME is not null and t.SEQ_NBR = 1


    - |
      INSERT INTO cpc.DISCT_OBJ
        (  DISCT_OBJ_ID   ,
          DISCT_OBJ_NAME  ,
          DISCT_OBJ_TYPE ,
          TAB_DP_COND_GRP_ID ,
          SP_ID  ,
          MEMBER_ALIAS ,
          GST_SEQ  ,
          CURRENCY_CODE,
          IF_INCLUDE,
          ACCT_ITEM_GROUP_ID
         )
        SELECT  DISCT_OBJ_ID_SEQ.nextval,
                t.CALC_DISCT_OBJ_NAME||'-Calc','A', t2.TAB_DP_COND_GRP_ID,
                0,null,null,null,'Y',t4.ACCT_ITEM_GROUP_ID
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan t1
                 on t1.PRICE_PLAN_ID = t.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t1.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP_COND_GRP T2
                on t2.TAB_DP_COND_GRP_NAME = t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.CALC_DISCT_OBJ_NAME||'-Calc'
             left join CBEC_ACCT_ITEM_GROUP t4
                on t4.ACCT_ITEM_GROUP_NAME = t.CALC_DISCT_ACCT_ITEM_GNP
        where t.CALC_DISCT_OBJ_NAME is not null and t.SEQ_NBR = 1

    - |
      INSERT INTO cpc.DISCT_OBJ
        (  DISCT_OBJ_ID   ,
          DISCT_OBJ_NAME  ,
          DISCT_OBJ_TYPE ,
          TAB_DP_COND_GRP_ID ,
          SP_ID  ,
          MEMBER_ALIAS ,
          GST_SEQ  ,
          CURRENCY_CODE,
          IF_INCLUDE,
          ACCT_ITEM_GROUP_ID
         )
        SELECT  DISCT_OBJ_ID_SEQ.nextval,
                t.APPLY_DISCT_OBJ_NAME||'-Disct','A', t2.TAB_DP_COND_GRP_ID,
                0,null,null,null,'Y',t4.ACCT_ITEM_GROUP_ID
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan t1
                 on t1.PRICE_PLAN_ID = t.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t1.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP_COND_GRP T2
                on t2.TAB_DP_COND_GRP_NAME = t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.APPLY_DISCT_OBJ_NAME||'-Disct'
             left join CBEC_ACCT_ITEM_GROUP t4
                on t4.ACCT_ITEM_GROUP_NAME = t.APPLY_DISCT_ACCT_ITEM_GNP
        where t.APPLY_DISCT_OBJ_NAME is not null and t.SEQ_NBR = 1


    - |
      INSERT INTO cpc.TAB_DP
        ( DP_ID ,
          TAB_DP_TYPE ,
          REF_DISCT_OBJ_ID  ,
          ACCT_ITEM_TYPE_ID,
          DISTRIBUTE_OBJ ,
          DISTRIBUTE_METHOD  ,
          CALC_DISCT_OBJ_ID,
          APPLY_DISCT_OBJ_ID,
          NEGATIVE_FLAG ,
          SP_ID  ,
          NET_FLAG
         )
        SELECT  t1.DP_ID, t2.TAB_DP_TYPE, nvl(t3.DISCT_OBJ_ID,'-1') , '-1',
               decode(t.DISTRIBUTE_OBJ,'Acct Item','1', 'Subscriber','2', 'Account','3'),
                decode(t.DISTRIBUTE_METHOD,'Distribute by Contribution of GLID','A', 'Distribute Averagely','B', 'Deduct one by one order by priority','C'),
               nvl(t4.DISCT_OBJ_ID,'-1'),nvl(t5.DISCT_OBJ_ID,'-1'),
               nvl(t.NEGATIVE_FLAG,'N'),0,'Y'
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP_TYPE t2
                on  regexp_like(t2.TAB_DP_TYPE_NAME,t.DISCOUNT_METHOD)
             left join TAB_DP_COND_GRP t6
                on t6.TAB_DP_COND_GRP_NAME =t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.REF_DISCT_OBJ_NAME||'-Refer'
              left join TAB_DP_COND_GRP t7
                on t7.TAB_DP_COND_GRP_NAME =t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.CALC_DISCT_OBJ_NAME||'-Calc'
              left join TAB_DP_COND_GRP t8
                on t8.TAB_DP_COND_GRP_NAME =t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.APPLY_DISCT_OBJ_NAME||'-Disct'
             left join DISCT_OBJ t3
                on t3.DISCT_OBJ_NAME = t.REF_DISCT_OBJ_NAME||'-Refer'
                and t3.TAB_DP_COND_GRP_ID = t6.TAB_DP_COND_GRP_ID
             left join DISCT_OBJ t4
                on t4.DISCT_OBJ_NAME =  t.CALC_DISCT_OBJ_NAME||'-Calc'
                and t4.TAB_DP_COND_GRP_ID = t7.TAB_DP_COND_GRP_ID
             left join DISCT_OBJ t5
                on t5.DISCT_OBJ_NAME = t.APPLY_DISCT_OBJ_NAME||'-Disct'
                and t5.TAB_DP_COND_GRP_ID = t8.TAB_DP_COND_GRP_ID
         where  t.SEQ_NBR = 1

    - |
      INSERT INTO cpc.DISCT_OBJ_AITID
        (  DISCT_OBJ_ID   ,
           ACCT_ITEM_TYPE_ID  ,
           PRIORITY ,
           SP_ID
         )
        SELECT t3.DISCT_OBJ_ID,CAIT.ACCT_ITEM_TYPE_ID,a.SEQ,null
         from    DC_CONFIG_PP_BILL_ACCTITEM a
             inner join price_plan p
                 on a.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on a.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = a.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join TAB_DP_COND_GRP t6
                on t6.TAB_DP_COND_GRP_NAME =a.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||a.ACCT_ITEM_GNP_NAME||'-Refer'
              left join TAB_DP_COND_GRP t7
                on t7.TAB_DP_COND_GRP_NAME =a.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||a.ACCT_ITEM_GNP_NAME||'-Calc'
              left join TAB_DP_COND_GRP t8
                on t8.TAB_DP_COND_GRP_NAME =a.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||a.ACCT_ITEM_GNP_NAME||'-Disct'
             inner join DISCT_OBJ t3
                on t3.DISCT_OBJ_NAME = a.DISCT_OBJ_NAME
                and
                (t3.TAB_DP_COND_GRP_ID = t8.TAB_DP_COND_GRP_ID
                 or   t3.TAB_DP_COND_GRP_ID = t7.TAB_DP_COND_GRP_ID
                 or   t3.TAB_DP_COND_GRP_ID = t6.TAB_DP_COND_GRP_ID
                )
             left join CBEC_ACCT_ITEM_TYPE CAIT
                 on a.ACCT_ITEM_TYPE_NAME = CAIT.ACCT_ITEM_TYPE_NAME
        where    a.ACCT_ITEM_GNP_NAME is not null

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
              '1',t.CALC_VAL,sysdate,'A',
             sysdate,null,null,p2.PRICE_SET_ID,null,t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-Value'
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-Value'
        where  t.CALC_VAL is not null
               and t4.REF_VALUE_ID is null



    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.S_VAL,sysdate,'A',
             sysdate,null,null,p2.PRICE_SET_ID,null,t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-Start Value'
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-Start Value'
        where   t.S_VAL is not null
               and t4.REF_VALUE_ID is null


    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
                '1', t.E_VAL,sysdate,'A',
             sysdate,null,null,p2.PRICE_SET_ID,null,t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-End Value'
         FROM DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-End Value'
        where  t.E_VAL is not null
               and t4.REF_VALUE_ID is null


    - |
      INSERT INTO cpc.TAB_DP_DT
         (DP_ID  ,
          SEQ_NO  ,
          DISCT_CALC_METHOD ,
          CALC_VAL   ,
          F_VAL ,
          C_VAL ,
          S_VAL ,
          E_VAL )
         SELECT   t1.DP_ID,  t.SEQ_NBR,t7.DISCT_CALC_METHOD,
                  t4.REF_VALUE_ID,null,null,t5.REF_VALUE_ID,t6.REF_VALUE_ID
          from DC_CONFIG_PP_BILL_DISCT t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRIORITY = t.DP_SEQ
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join PRICE_PLAN_VER t2
                 on t.PRICE_PLAN_ID = t2.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER t3
                 on t2.PRICE_PLAN_VER_ID = t3.PRICE_PLAN_VER_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-Value'
             left join REF_VALUE t5
                 on t5.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-Start Value'
             left join REF_VALUE t6
                 on t6.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.DP_SEQ||'-'||t.SEQ_NBR||'-'||'-End Value'
             inner join DISCT_CALC_METHOD  t7
                 on t7.DISCT_CALC_METHOD_NAME = t.DISCT_CALC_METHOD
            where t.DISCT_CALC_METHOD is not null

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP
        (  TAB_DP_COND_GRP_ID ,
           TAB_DP_COND_GRP_NAME ,
           DP_REF_COND_TYPE   ,
           DP_ID
         )
        SELECT  TAB_DP_COND_GRP_ID_SEQ.nextval ,
                t.PRICE_PLAN_ID||'-'||t.DP_NAME||' -Condition',
                'A',
                t1.DP_ID
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join TAB_DP_COND_GRP t2
                on t2.DP_ID = t1.DP_ID
        where t.DP_REF_COND_NAME is not null  and t2.DP_ID is  null and t.CON_GRP_SEQ =1
              and t.CONDITION = 'Discount Condtion'


    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.VALUE,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Condition'
        where  t.VALUE is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Discount Condtion'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.COND_PARAM,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Condition'
        where  t.COND_PARAM is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Discount Condtion'

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP_DT
         (TAB_DP_COND_GRP_ID   ,
          GRP_ID  ,
          SEQ_NO  ,
          L_DP_REF_COND_ID   ,
          L_PARAM  ,
          SORT_OPERATOR  ,
          R_VAL )
        SELECT   t2.TAB_DP_COND_GRP_ID,t.CON_GRP_SEQ,t.COND_SEQ,
               t4.DP_REF_COND_ID,v1.REF_VALUE_ID, t5.SORT_OPERATOR,
               t3.REF_VALUE_ID
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join  TAB_DP_COND_GRP t2
                on t2.dp_id=t1.DP_ID
             inner join ref_value t3
                on t3.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Condition'
             left join ref_value v1
                on v1.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Condition'
             inner join DP_REF_COND t4
                on t4.DP_REF_COND_NAME = t.DP_REF_COND_NAME
             inner join SORT_OPERATOR t5
                on t5.SORT_OPERATOR_NAME= t.OPERATOR
             left join TAB_DP_COND_GRP_DT T6
                on t6.R_VAL= t3.REF_VALUE_ID
                 and t6.TAB_DP_COND_GRP_ID = t2.TAB_DP_COND_GRP_ID
         where t6.TAB_DP_COND_GRP_ID is  null
                and   t.CONDITION = 'Discount Condtion'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.VALUE,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Reference Object Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Reference Object Condition'
             where  t.VALUE is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Reference Object Condition'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.COND_PARAM,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Reference Object Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Reference Object Condition'
        where  t.COND_PARAM is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Reference Object Condition'

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP_DT
         (TAB_DP_COND_GRP_ID   ,
          GRP_ID  ,
          SEQ_NO  ,
          L_DP_REF_COND_ID   ,
          L_PARAM  ,
          SORT_OPERATOR  ,
          R_VAL )
        SELECT   po1.TAB_DP_COND_GRP_ID,t.CON_GRP_SEQ,t.COND_SEQ,
               t4.DP_REF_COND_ID,v1.REF_VALUE_ID, t5.SORT_OPERATOR,
               t3.REF_VALUE_ID
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP  p4 on p4.DP_ID = t1.DP_ID
             inner join  DISCT_OBJ po1 on  po1.DISCT_OBJ_ID = p4.REF_DISCT_OBJ_ID
             inner join TAB_DP_COND_GRP td1 on td1.TAB_DP_COND_GRP_ID = po1.TAB_DP_COND_GRP_ID
             inner join ref_value t3
                on t3.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Reference Object Condition'
             left join ref_value v1
                on v1.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Reference Object Condition'
             inner join DP_REF_COND t4
                on t4.DP_REF_COND_NAME = t.DP_REF_COND_NAME
             inner join SORT_OPERATOR t5
                on t5.SORT_OPERATOR_NAME= t.OPERATOR
             left join TAB_DP_COND_GRP_DT T6
                on  t6.R_VAL= t3.REF_VALUE_ID
                and t6.TAB_DP_COND_GRP_ID = td1.TAB_DP_COND_GRP_ID
         where t6.TAB_DP_COND_GRP_ID is null
                and  t.CONDITION = 'Reference Object Condition'


  insert_Bill_Discount_AcctItem:

    - |
      INSERT INTO cpc.DISCT_OBJ_AITID
        (  DISCT_OBJ_ID   ,
           ACCT_ITEM_TYPE_ID  ,
           PRIORITY ,
           SP_ID
         )
        SELECT t3.DISCT_OBJ_ID,CAIT.ACCT_ITEM_TYPE_ID,a.SEQ,null
         from    DC_CONFIG_PP_BILL_ACCTITEM a
             inner join price_plan p
                 on a.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on a.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = a.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join TAB_DP_COND_GRP t6
                on t6.TAB_DP_COND_GRP_NAME =a.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||a.ACCT_ITEM_GNP_NAME||'-Refer'
              left join TAB_DP_COND_GRP t7
                on t7.TAB_DP_COND_GRP_NAME =a.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||a.ACCT_ITEM_GNP_NAME||'-Calc'
              left join TAB_DP_COND_GRP t8
                on t8.TAB_DP_COND_GRP_NAME =a.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||a.ACCT_ITEM_GNP_NAME||'-Disct'
             inner join DISCT_OBJ t3
                on t3.DISCT_OBJ_NAME = a.DISCT_OBJ_NAME
                and
                (t3.TAB_DP_COND_GRP_ID = t8.TAB_DP_COND_GRP_ID
                 or   t3.TAB_DP_COND_GRP_ID = t7.TAB_DP_COND_GRP_ID
                 or   t3.TAB_DP_COND_GRP_ID = t6.TAB_DP_COND_GRP_ID
                )
             left join CBEC_ACCT_ITEM_TYPE CAIT
                 on a.ACCT_ITEM_TYPE_NAME = CAIT.ACCT_ITEM_TYPE_NAME
        where    a.ACCT_ITEM_GNP_NAME is not null

  insert_Bill_Discount_condition:
    - |
      INSERT INTO cpc.TAB_DP_COND_GRP
        (  TAB_DP_COND_GRP_ID ,
           TAB_DP_COND_GRP_NAME ,
           DP_REF_COND_TYPE   ,
           DP_ID
         )
        SELECT  TAB_DP_COND_GRP_ID_SEQ.nextval ,
                t.PRICE_PLAN_ID||'-'||t.DP_NAME||' -Condition',
                'A',
                t1.DP_ID
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join TAB_DP_COND_GRP t2
                on t2.DP_ID = t1.DP_ID
        where t.DP_REF_COND_NAME is not null  and t2.DP_ID is  null and t.CON_GRP_SEQ =1 and t.COND_SEQ=1
              and t.CONDITION = 'Discount Condtion'


    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.VALUE,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Condition'
        where  t.VALUE is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Discount Condtion'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.COND_PARAM,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Condition'
        where  t.COND_PARAM is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Discount Condtion'

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP_DT
         (TAB_DP_COND_GRP_ID   ,
          GRP_ID  ,
          SEQ_NO  ,
          L_DP_REF_COND_ID   ,
          L_PARAM  ,
          SORT_OPERATOR  ,
          R_VAL )
        SELECT   t2.TAB_DP_COND_GRP_ID,t.CON_GRP_SEQ,t.COND_SEQ,
               t4.DP_REF_COND_ID,v1.REF_VALUE_ID, t5.SORT_OPERATOR,
               t3.REF_VALUE_ID
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join  TAB_DP_COND_GRP t2
                on t2.dp_id=t1.DP_ID
             inner join ref_value t3
                on t3.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Condition'
             left join ref_value v1
                on v1.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Condition'
             inner join DP_REF_COND t4
                on t4.DP_REF_COND_NAME = t.DP_REF_COND_NAME
                 and t4.DP_REF_COND_TYPE='A'
             inner join BILLING_SORT_OPERATOR t5
                on t5.SORT_OPERATOR_NAME= t.OPERATOR
             left join TAB_DP_COND_GRP_DT T6
                on t6.R_VAL= t3.REF_VALUE_ID
                 and t6.TAB_DP_COND_GRP_ID = t2.TAB_DP_COND_GRP_ID
         where t6.TAB_DP_COND_GRP_ID is  null
               and p.APPLY_LEVEL='S'
                and   t.CONDITION = 'Discount Condtion'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.VALUE,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Reference Object Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Reference Object Condition'
             where  t.VALUE is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Reference Object Condition'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE, STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
               '1',t.COND_PARAM,sysdate,'A',
               sysdate,null,null,p2.PRICE_SET_ID,null,
               t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Reference Object Condition'
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Reference Object Condition'
        where  t.COND_PARAM is not null
               and t4.REF_VALUE_ID is null
               and  t.CONDITION = 'Reference Object Condition'

    - |
      INSERT INTO cpc.TAB_DP_COND_GRP_DT
         (TAB_DP_COND_GRP_ID   ,
          GRP_ID  ,
          SEQ_NO  ,
          L_DP_REF_COND_ID   ,
          L_PARAM  ,
          SORT_OPERATOR  ,
          R_VAL )
        SELECT   po1.TAB_DP_COND_GRP_ID,t.CON_GRP_SEQ,t.COND_SEQ,
               t4.DP_REF_COND_ID,v1.REF_VALUE_ID, t5.SORT_OPERATOR,
               t3.REF_VALUE_ID
         FROM DC_CONFIG_PP_DISCT_COND t
             inner join price_plan p  on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on t.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_NAME = t.DP_NAME
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP  p4 on p4.DP_ID = t1.DP_ID
             inner join  DISCT_OBJ po1 on  po1.DISCT_OBJ_ID = p4.REF_DISCT_OBJ_ID
             inner join TAB_DP_COND_GRP td1 on td1.TAB_DP_COND_GRP_ID = po1.TAB_DP_COND_GRP_ID
             inner join ref_value t3
                on t3.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-Reference Object Condition'
             left join ref_value v1
                on v1.comments = t.PRICE_PLAN_ID||'-'||t1.DP_NAME||'-'||t.CON_GRP_SEQ||'-'||t.COND_SEQ||'-COND_PARAM-Reference Object Condition'
             inner join DP_REF_COND t4
                on t4.DP_REF_COND_NAME = t.DP_REF_COND_NAME
                 and t4.DP_REF_COND_TYPE='C'
             inner join BILLING_SORT_OPERATOR t5
                on t5.SORT_OPERATOR_NAME= t.OPERATOR
             left join TAB_DP_COND_GRP_DT T6
                on  t6.R_VAL= t3.REF_VALUE_ID
                and t6.TAB_DP_COND_GRP_ID = td1.TAB_DP_COND_GRP_ID
         where t6.TAB_DP_COND_GRP_ID is null
                and p.APPLY_LEVEL='A'
                and  t.CONDITION = 'Reference Object Condition'

  UPDATE_Bill_Discount_VAL_to_Prorate:
    - |
      drop table DC_CONFIG_BILL_VAL_Prorate_list
    - |
      create table DC_CONFIG_BILL_VAL_Prorate_list  as
       select p.PRICE_PLAN_ID,p.PRICE_PLAN_NAME,p2.PRICE_SET_ID,p3.DP_ID,p3.DP_NAME,p3.PRIORITY,t2.SEQ_NO,p3.COMMENTS,
       t7.DISCT_CALC_METHOD_NAME,t4.REF_VALUE_id,t4.REF_VALUE_TYPE,t4.value_string,t4.COMMENTS REF_VALUE_comments
       from DC_CONFIG_PP_BILL_VAL_PRORATE t
          inner join   price_plan p on p.PRICE_PLAN_ID = t.PRICE_PLAN_ID
          inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
          inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
          inner join DP p3 on p3.PRICE_SET_ID = p2.PRICE_SET_ID
          inner join TAB_DP  p4 on p4.DP_ID = p3.DP_ID and t.DP_ID=p4.DP_ID
          inner join TAB_DP_DT t2
                on t2.DP_ID = p3.DP_ID AND T2.SEQ_NO = T.SEQ_NO
          inner join DISCT_CALC_METHOD  t7
                on t7.DISCT_CALC_METHOD =  t2.DISCT_CALC_METHOD and t.DISCT_CALC_METHOD = t7.DISCT_CALC_METHOD_NAME
          inner join REF_VALUE t4
                on t4.PRICE_SET_ID = p2.PRICE_SET_ID
                  and  t2.CALC_VAL = t4.REF_VALUE_ID
                  and t.CALC_VAL=t4.VALUE_STRING
        where  not regexp_like(t.CALC_VAL,'/') and t.PRORATE='Y'

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE,FUNCTION_PARAM1 , STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT REF_VALUE_ID_SEQ.NEXTVAL,
              '8','getDaysWithSubsState',sysdate,'A','A',
             sysdate,null,null,p2.PRICE_SET_ID,null,t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-getDaysWithSubsState'
         FROM DC_CONFIG_BILL_VAL_Prorate_list t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_ID = t.DP_ID
                and t1.PRIORITY = t.PRIORITY
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-getDaysWithSubsState'
        where  t.VALUE_STRING is not null
               and t4.REF_VALUE_ID is null

    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE , STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT  REF_VALUE_ID_SEQ.NEXTVAL,
              '8','getDaysWithTheBillingCycle',sysdate,'A',
             sysdate,null,null,p2.PRICE_SET_ID,null,t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-getDaysWithTheBillingCycle'
         FROM DC_CONFIG_BILL_VAL_Prorate_list t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_ID = t.DP_ID
                and t1.PRIORITY = t.PRIORITY
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-getDaysWithTheBillingCycle'
        where  t.VALUE_STRING is not null
               and t4.REF_VALUE_ID is null


    - |
      INSERT INTO cpc.REF_VALUE
         (REF_VALUE_ID, REF_VALUE_TYPE, VALUE_STRING, CREATED_DATE , STATE, STATE_DATE, PRICE_ID, RATE_PLAN_ID, PRICE_SET_ID,
           SP_ID,COMMENTS)
        SELECT  REF_VALUE_ID_SEQ.NEXTVAL,
              '1',t.VALUE_STRING,sysdate,'A',
             sysdate,null,null,p2.PRICE_SET_ID,null,t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-ValueProrate'
         FROM DC_CONFIG_BILL_VAL_Prorate_list t
             inner join price_plan p
                 on t.PRICE_PLAN_ID = p.PRICE_PLAN_ID
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on t1.DP_ID = t.DP_ID
                and t1.PRIORITY = t.PRIORITY
                and t1.PRICE_SET_ID = p2.PRICE_SET_ID
             left join REF_VALUE t4
                 on t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t1.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-ValueProrate'
         where  t.VALUE_STRING is not null
                and t4.REF_VALUE_ID is null

    - |
      drop table dc_config_ref_value_bak
    - |
      create table dc_config_ref_value_bak as
             select * from REF_VALUE where  REF_VALUE_id  in (select t.REF_VALUE_id from DC_CONFIG_BILL_VAL_Prorate_list t)
    - |
      drop table dc_config_Prorate_list_update
    - |
      create table dc_config_Prorate_list_update as
          SELECT t.REF_VALUE_id,  t4.REF_VALUE_ID||'/'||t5.REF_VALUE_ID||'*'||t6.REF_VALUE_ID ref_value_string, t.REF_VALUE_comments||'--'||t4.VALUE_STRING||'/'||t5.VALUE_STRING||'*'||t6.VALUE_STRING ref_value_comments
                 FROM DC_CONFIG_BILL_VAL_Prorate_list t
                   inner join REF_VALUE t4
                       on  t4.REF_VALUE_TYPE=8
                           and t4.COMMENTS= t.PRICE_PLAN_ID||'-'||t.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-getDaysWithSubsState'
                   inner join REF_VALUE t5
                       on t5.REF_VALUE_TYPE=8
                          and t5.COMMENTS= t.PRICE_PLAN_ID||'-'||t.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-getDaysWithTheBillingCycle'
                   inner join REF_VALUE t6
                       on t6.REF_VALUE_TYPE=1
                          and  t6.COMMENTS= t.PRICE_PLAN_ID||'-'||t.DP_ID||'-'||t.PRIORITY||'-'||t.SEQ_NO||'-'||t.REF_VALUE_ID||'-ValueProrate'
    - |
      update ref_value r set  r.REF_VALUE_TYPE='4'
      where r.REF_VALUE_ID in (select t.REF_VALUE_id from dc_config_Prorate_list_update t  )
    - |
      update ref_value r set  r.VALUE_STRING =
                   (select u.ref_value_string  from  dc_config_Prorate_list_update u
                       where u.REF_VALUE_id=r.REF_VALUE_ID)
              ,r.COMMENTS =(select  u.ref_value_comments from  dc_config_Prorate_list_update u
                       where u.REF_VALUE_id=r.REF_VALUE_ID)
      where r.REF_VALUE_ID =(select t.REF_VALUE_id from dc_config_Prorate_list_update t
                                where t.REF_VALUE_ID=r.REF_VALUE_ID)

  Delete_Bill_Discount_ALL:
    - |
      drop table delete_bill_disct
    - |
      create table delete_bill_disct as
       select  t.PRICE_PLAN_ID,t.PRICE_PLAN_NAME,t1.DP_ID,t1.DP_NAME,
              t3.DISCT_OBJ_ID REF_DISCT_OBJ_ID,
              t4.DISCT_OBJ_ID CALC_DISCT_OBJ_ID,
              t5.DISCT_OBJ_ID APPLY_DISCT_OBJ_ID,
              t6.TAB_DP_COND_GRP_ID REF_DP_COND_GRP_ID,
              t7.TAB_DP_COND_GRP_ID CALC_DP_COND_GRP_ID,
              t8.TAB_DP_COND_GRP_ID APPLY_DP_COND_GRP_ID,
              t9.TAB_DP_COND_GRP_ID CON_DP_COND_GRP_ID
               FROM DC_CONFIG_PP_BILL_DISCT t
                   inner  join DP t1
                      on t1.DP_NAME = t.DP_NAME
                      and t1.PRIORITY = t.DP_SEQ
                   inner join TAB_DP_TYPE t2
                      on  regexp_like(t2.TAB_DP_TYPE_NAME,t.DISCOUNT_METHOD)
                   left join DISCT_OBJ t3
                      on t3.DISCT_OBJ_NAME = t.REF_DISCT_OBJ_NAME||'-Refer'
                   left join DISCT_OBJ t4
                      on t4.DISCT_OBJ_NAME =  t.CALC_DISCT_OBJ_NAME||'-Calc'
                   left join DISCT_OBJ t5
                      on t5.DISCT_OBJ_NAME = t.APPLY_DISCT_OBJ_NAME||'-Disct'
                   left join TAB_DP_COND_GRP t6
                      on t6.TAB_DP_COND_GRP_NAME =t.PRICE_PLAN_ID||' '||t.REF_DISCT_OBJ_NAME||'-Refer'
                         and t6.TAB_DP_COND_GRP_ID = t3.TAB_DP_COND_GRP_ID
                   left join TAB_DP_COND_GRP t7
                      on t7.TAB_DP_COND_GRP_NAME =t.PRICE_PLAN_ID||' '||t.CALC_DISCT_OBJ_NAME||'-Calc'
                         and t7.TAB_DP_COND_GRP_ID = t4.TAB_DP_COND_GRP_ID
                   left join TAB_DP_COND_GRP t8
                      on t8.TAB_DP_COND_GRP_NAME =t.PRICE_PLAN_ID||' '||t.APPLY_DISCT_OBJ_NAME||'-Disct'
                         and t8.TAB_DP_COND_GRP_ID = t5.TAB_DP_COND_GRP_ID
                   left join TAB_DP_COND_GRP t9
                      on t9.DP_ID = t1.DP_ID
                        and t9.TAB_DP_COND_GRP_NAME = t.PRICE_PLAN_ID||'-'||t.DP_NAME||' -Condtion'
                where  t.SEQ_NBR = 1 and t.OPER_TYPE='D'

    - |
      delete from  TAB_DP_COND_GRP_DT t  where t.TAB_DP_COND_GRP_ID in (select d.CON_DP_COND_GRP_ID from delete_bill_disct d)
    - |
      delete from ref_value t where  regexp_like(t.comments,'Condition')
        and t.PRICE_SET_ID
          in ( select distinct t3.PRICE_SET_ID FROM DC_CONFIG_PP_DISCT_COND t
                   inner  join DP t1
                      on t1.DP_NAME = t.DP_NAME
                   inner join PRICE_PLAN_VER t2
                       on t.PRICE_PLAN_ID = t2.PRICE_PLAN_ID
                   inner join PRICE_PLAN_MEMBER t3
                       on t2.PRICE_PLAN_VER_ID = t3.PRICE_PLAN_VER_ID
                   where t.OPER_TYPE='D'
            )
    - |
      delete from cpc.TAB_DP_COND_GRP c where c.TAB_DP_COND_GRP_ID in (select d.CON_DP_COND_GRP_ID from delete_bill_disct d)

    - |
      delete from  TAB_DP_DT t  where t.DP_ID in (select d.DP_ID from delete_bill_disct d)
    - |
      delete from ref_value t where  regexp_like(t.comments,'Value')
           and t.PRICE_SET_ID
          in ( select distinct t3.PRICE_SET_ID FROM DC_CONFIG_PP_BILL_DISCT t
                   inner  join DP t1
                      on t1.DP_NAME = t.DP_NAME
                      and t1.PRIORITY = t.DP_SEQ
                   inner join PRICE_PLAN_VER t2
                       on t.PRICE_PLAN_ID = t2.PRICE_PLAN_ID
                   inner join PRICE_PLAN_MEMBER t3
                       on t2.PRICE_PLAN_VER_ID = t3.PRICE_PLAN_VER_ID
                   where t.OPER_TYPE='D'
            )
    - |
      delete from  TAB_DP t  where t.DP_ID in (select d.DP_ID from delete_bill_disct d)
    - |
      delete from dp t where t.DP_ID in (select d.DP_ID from delete_bill_disct d)
    - |
      delete from DISCT_OBJ_AITID t where t.DISCT_OBJ_ID  in (select d.APPLY_DISCT_OBJ_ID from delete_bill_disct d)
    - |
      delete from DISCT_OBJ_AITID t where t.DISCT_OBJ_ID  in (select d.REF_DISCT_OBJ_ID from delete_bill_disct d)
    - |
      delete from DISCT_OBJ_AITID t where t.DISCT_OBJ_ID  in (select d.CALC_DISCT_OBJ_ID from delete_bill_disct d)
    - |
      delete from cpc.DISCT_OBJ  d where d.DISCT_OBJ_ID  in (select d.APPLY_DISCT_OBJ_ID  from delete_bill_disct d)
    - |
      delete from cpc.DISCT_OBJ  d where d.DISCT_OBJ_ID  in (select d.REF_DISCT_OBJ_ID  from delete_bill_disct d)
    - |
      delete from cpc.DISCT_OBJ  d where d.DISCT_OBJ_ID  in (select d.CALC_DISCT_OBJ_ID  from delete_bill_disct d)
    - |
      delete from cpc.TAB_DP_COND_GRP c where c.TAB_DP_COND_GRP_ID in (select d.APPLY_DP_COND_GRP_ID from delete_bill_disct d)
    - |
      delete from cpc.TAB_DP_COND_GRP c where c.TAB_DP_COND_GRP_ID in (select d.CALC_DP_COND_GRP_ID from delete_bill_disct d)
    - |
      delete from cpc.TAB_DP_COND_GRP c where c.TAB_DP_COND_GRP_ID in (select d.REF_DP_COND_GRP_ID from delete_bill_disct d)


  Delete_Bill_Discount_AcctItem:
    - |
      drop table delete_bill_disct_AcctItem
    - |
      create table delete_bill_disct_AcctItem as
       select p.PRICE_PLAN_ID,p.PRICE_PLAN_NAME,p2.PRICE_SET_ID,p3.DP_ID,p3.DP_NAME,p3.PRIORITY,p3.COMMENTS,
        po1.DISCT_OBJ_ID REF_DISCT_OBJ_ID ,po1.DISCT_OBJ_NAME  REF_DISCT_OBJ_name,
             po2.DISCT_OBJ_ID CALC_DISCT_OBJ_ID,po2.DISCT_OBJ_NAME  CALC_DISCT_OBJ_name,
             po3.DISCT_OBJ_ID APPLY_DISCT_OBJ_ID ,po3.DISCT_OBJ_NAME  APPLY_DISCT_OBJ_name
        from price_plan p
         inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
         inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
         inner join DP p3 on p3.PRICE_SET_ID = p2.PRICE_SET_ID
         inner join TAB_DP  p4 on p4.DP_ID = p3.DP_ID
         left join  DISCT_OBJ po1 on  po1.DISCT_OBJ_ID = p4.REF_DISCT_OBJ_ID
         left join  DISCT_OBJ po2 on  po2.DISCT_OBJ_ID = p4.CALC_DISCT_OBJ_ID
         left join  DISCT_OBJ po3 on  po3.DISCT_OBJ_ID = p4.APPLY_DISCT_OBJ_ID
       where p.PRICE_PLAN_ID in (select  PRICE_PLAN_ID from DC_CONFIG_PP_BILL_DISCT) ;
    - |
      delete from  DISCT_OBJ_AITID t  where t.DISCT_OBJ_ID  in (select d.REF_DISCT_OBJ_ID from delete_bill_disct_AcctItem d);
    - |
      delete  from  DISCT_OBJ_AITID t where t.DISCT_OBJ_ID  in (select d.CALC_DISCT_OBJ_ID from delete_bill_disct_AcctItem d);
    - |
      delete   from DISCT_OBJ_AITID t  where t.DISCT_OBJ_ID  in (select d.APPLY_DISCT_OBJ_ID from delete_bill_disct_AcctItem d);
  Delete_Bill_Discount_condition:
    - |
      drop table delete_bill_disct_cond
    - |
      create table delete_bill_disct_cond as
        SELECT p.PRICE_PLAN_ID,  p.PRICE_PLAN_NAME , t1.DP_ID,t1.DP_NAME,t2.TAB_DP_COND_GRP_ID,
               t2.TAB_DP_COND_GRP_NAME,t8.DP_REF_COND_NAME, t4.REF_VALUE_id,t4.value_string,
               t9.SORT_OPERATOR_NAME,t5.REF_VALUE_id Condition_REF_VALUE_id,t5.value_string Condition_value_string
          from   price_plan p
             inner join PRICE_PLAN_VER p1 on p.PRICE_PLAN_ID=p1.PRICE_PLAN_ID
             inner join PRICE_PLAN_MEMBER p2 on p2.PRICE_PLAN_VER_ID = p1.PRICE_PLAN_VER_ID
             inner  join DP t1
                on  t1.PRICE_SET_ID = p2.PRICE_SET_ID
             inner join TAB_DP_COND_GRP t2
              on t2.DP_ID = t1.DP_ID
             inner join tab_dp_cond_grp_dt  t7
                 on t7.TAB_DP_COND_GRP_ID =  t2.TAB_DP_COND_GRP_ID
             inner join  DP_REF_COND t8
                 on t8.DP_REF_COND_ID = t7.L_DP_REF_COND_ID
             inner join SORT_OPERATOR t9
                 on t9.SORT_OPERATOR= t7.SORT_OPERATOR
             left join REF_VALUE t4
                 on t4.PRICE_SET_ID = p2.PRICE_SET_ID
                    and  t7.L_PARAM = t4.REF_VALUE_ID
             left join REF_VALUE t5
                  on t5.PRICE_SET_ID = p2.PRICE_SET_ID
                    and  t7.R_VAL = t5.REF_VALUE_ID
             inner  join DC_CONFIG_PP_DISCT_COND t
                  on t.PRICE_PLAN_ID=p.PRICE_PLAN_ID

    - |
      delete from  TAB_DP_COND_GRP_DT t  where t.TAB_DP_COND_GRP_ID in (select d.TAB_DP_COND_GRP_ID from delete_bill_disct_cond d)
    - |
      delete from ref_value t  where t.ref_value_id in (select Condition_REF_VALUE_id from delete_bill_disct_cond d)
    - |
      delete from ref_value t  where t.ref_value_id in (select REF_VALUE_id from delete_bill_disct_cond d)
    - |
      delete from cpc.TAB_DP_COND_GRP c where c.TAB_DP_COND_GRP_ID in (select d.TAB_DP_COND_GRP_ID from delete_bill_disct_cond d)
