UserList:
    cc

ErrorData:



    OFFER_NO_Catg_A:
        des: offer havent configure management catg
        sql: "SELECT *
              FROM offer a
             WHERE offer_id BETWEEN 2000 AND 399999
               AND NOT EXISTS
                   (SELECT 1
                     FROM OFFER_CATG_MEM b, offer_catg c
                    WHERE a.OFFER_ID = b.OFFER_ID
                      AND b.OFFER_CATG_ID = c.OFFER_CATG_ID
                      AND c.OFFER_CATG_CLASS = 'A')
               AND a.offer_type != 7
               AND NOT EXISTS
                   (SELECT 1
                     FROM subs_price_plan spp
                    WHERE spp.PRICE_PLAN_TYPE = '1'
                      AND a.OFFER_ID = spp.PRICE_PLAN_ID)"

    PP_NO_GROUP:
        des: PRICE PLAN no group
        sql: "SELECT *
               FROM offer a
              WHERE offer_id BETWEEN 2000 AND 399999
               AND a.offer_type IN ('4')
               and a.state='A'
               and a.offer_id not in (122483, 123010, 123008, 122485, 123011,133706,133707,133708,133709,133710,133711,133712,
                                      233636,233634,233635,'128903','129235','128932','129208','128888','129319','129140','128963')
               AND NOT EXISTS
                  (SELECT 1
              FROM subs_plan_offer_select spos, offer_group b, offer_group_mem c
             WHERE spos.offer_group_id = b.offer_group_id
               and a.OFFER_ID = c.OFFER_ID
               AND b.OFFER_GROUP_ID = c.OFFER_GROUP_ID
               AND b.OFFER_GROUP_TYPE in ('6', '4'))
               AND not exists (select 1
              from acct_price_plan app
             where app.price_plan_id = a.offer_id)"

    MAIN_OFFER_NO_DPP_GROUP:
        des: main offer no default price plan
        sql: "SELECT *
              FROM offer a, offer_ver ov
             WHERE a.offer_id BETWEEN 2000 AND 399999
               AND a.offer_type IN (7)
               AND a.OFFER_ID = ov.OFFER_ID
               AND NOT EXISTS
                   (SELECT 1
                     FROM subs_plan_offer_select spos, offer_group og
                    WHERE spos.OFFER_VER_ID = ov.OFFER_VER_ID
                      AND spos.OFFER_GROUP_ID = og.OFFER_GROUP_ID
                      AND og.OFFER_GROUP_TYPE = '6')"

    MAIN_OFFER_HAVE_MULTIPLE_DPP_GRP:
        des: main offer have multiple dpp group
        sql: "SELECT a.OFFER_ID, COUNT(*)
               FROM offer a, offer_ver ov, subs_plan_offer_select spos, offer_group og
              WHERE a.offer_id BETWEEN 2000 AND 399999
                AND a.offer_type IN (7)
                AND a.OFFER_ID = ov.OFFER_ID
                AND spos.OFFER_VER_ID = ov.OFFER_VER_ID
                AND spos.OFFER_GROUP_ID = og.OFFER_GROUP_ID
                AND og.OFFER_GROUP_TYPE = '6'
                GROUP BY a.OFFER_ID HAVING COUNT(1)>1"

    OFFER_GROUP_NO_MAIN_OFFER:
        des: offer group no main offer
        sql: "SELECT *
              FROM offer_group og
             WHERE og.OFFER_GROUP_ID BETWEEN 10000 AND 200000
               and og.state !='X'
               and og.offer_group_id not in (38452,38456,38457,38458,38461,38463)
               AND NOT EXISTS
                   (SELECT 1
                     FROM subs_plan_offer_select spos
                    WHERE spos.OFFER_GROUP_ID = og.OFFER_GROUP_ID)"

    OFFER_GROUP_NO_MEM:
        des: offer group no member
        sql: "SELECT *
              FROM offer_group og
             WHERE og.OFFER_GROUP_ID BETWEEN 10000 AND 200000
               AND NOT EXISTS
                   (SELECT 1
                     FROM offer_group_mem ogm
                    WHERE ogm.OFFER_GROUP_ID = og.OFFER_GROUP_ID)"

    DPP_MANDATORY:
        des: the default price plan should be mandatory
        sql: "SELECT *
               FROM subs_plan_offer_select
              WHERE offer_group_id IN
                    (SELECT offer_group_id
                       FROM offer_group
                      WHERE offer_group_type='6')
                        AND necessary != 1"

    SERV_TYPE_IS_NULL:
        des: the service type is null for main product
        sql: "select * from INDEP_PROD_SPEC where SERV_TYPE is null"

    MAIN_PROD_IS_NULL:
        des: the main product is null
        sql: "select * from SUBS_PLAN where INDEP_PROD_SPEC_ID is null"

    OFFER_DUPLICATE_IN_SUBS_PLAN:
        des: offer duplicate in subs plan
        sql: "SELECT sp1.OFFER_VER_ID, sp2.OFFER_VER_ID, ogm2.OFFER_ID
               FROM subs_plan_offer_select sp1, subs_plan_offer_select sp2, offer_group_mem ogm1, offer_group_mem ogm2
              WHERE sp1.OFFER_VER_ID = sp2.OFFER_VER_ID
                AND sp1.OFFER_GROUP_ID = ogm1.OFFER_GROUP_ID
                AND sp2.OFFER_GROUP_ID = ogm2.OFFER_GROUP_ID
                AND sp1.OFFER_GROUP_ID != sp2.OFFER_GROUP_ID
                AND ogm1.OFFER_ID = ogm2.OFFER_ID"

    OFFER_DUPLICATE_IN_OFFER_GROUP:
        des: offer duplicate in offer group
        sql: "SELECT * FROM offer_group_mem b WHERE (offer_group_id, offer_id) IN (
             SELECT offer_group_id, offer_id
               FROM offer_group_mem
              where offer_id between 5000 and 400000
                and offer_group_id between 10000 and 200000
              GROUP BY offer_group_id, offer_id HAVING COUNT(*)>1)"

    SUBS_PLAN_MAIN_PROD_MULTI_ATTR:
        des: the attr is multiplicate in subs plan
        sql: "SELECT spoa.OFFER_VER_ID, spoa.ATTR_ID, COUNT(*)
               FROM subs_plan_offer_attr spoa, offer o
              WHERE spoa.OFFER_ID = o.OFFER_ID
                AND o.offer_type = 2
                GROUP BY spoa.OFFER_VER_ID, spoa.ATTR_ID
                HAVING COUNT(1)>1"

    OFFER_CODE_DUPLICATED:
        des: the OFFER CODE is duplicated
        sql: "SELECT o.offer_code, COUNT(*)
               FROM offer o
              where o.offer_id between 5000 and 400000
               GROUP BY o.offer_code
                HAVING COUNT(1)>1"

    GOODS_OFFER_NO_SPEC:
        des: goods offer no goods_prod_spec
        sql: "select *
               from offer a
              where a.offer_type = 5
                and a.offer_id not in (select goods_prod_spec_id from goods_prod_spec b)"

    DEFAULT_OFFER_GROUP_ERROR:
        des: default offer group have not set default offer
        sql: "select *
               from offer_group og
              where og.offer_group_type = '6'
                and og.offer_group_id between 10000 and 1000000
                and not exists (
                    select 1
                      from offer_group_mem ogm
                     where ogm.offer_group_id = og.offer_group_id
                       and ogm.default_flag = 'Y')"

    DEFAULT_OFFER_GROUP_MEM_ERROR:
        des: default offer group have set more than one default offer
        sql: "select *
               from offer_group og
              where og.offer_group_type = '6'
                and og.offer_group_id between 10000 and 1000000
                and exists (
                    select ogm.offer_group_id
                      from offer_group_mem ogm,offer o
                     where ogm.offer_group_id = og.offer_group_id
                       and ogm.default_flag = 'Y'
                       and ogm.offer_id = o.offer_id and (o.exp_date is null or o.exp_date>sysdate)
                       group by ogm.offer_group_id having count(1)>1)"

    BUNDLE_MEMBER_ONLY_SOLD_IN_BUNDLE:
        des: bundle member should be set bundle flag to Yes
        sql: "select o.*
               from subs_plan a, offer o
              where a.is_bundle_flag = 'N'
                and a.subs_plan_id = o.offer_id
                and a.subs_plan_id not in ('175948', '175922', '175875', '175886', '175953', '175895', '175872', '175851',
             '175935', '170006', '175833', '175832', '175835', '175834', '175923', '175852',
             '175831', '175952', '170005', '170004', '176705')
                and a.subs_plan_id in (
                    select b.subs_plan_id
                      from bundle_unit_subs_plan b)"

    ACCOUNT_ITEM_TYPE_CODE_NULL:
        des: Account item type code should not be null
        sql: "select a.*
               from acct_item_type a, dc_revenue_code_acct_item_map b
              where a.acct_item_type_code is null
                and a.acct_item_type_id = b.acct_item_type_id"

    BUNDLE_MEMBER_NO_NEED_OTC:
        des: Bundle member should not have one time charge
        sql: "select /*+ parallel(12)*/ mm.*
                from bundle_unit_subs_plan busp, offer_ver ov, subs_plan_offer_select spos,
                     offer_group_mem ogm, offer_ver ovi, rate_plan rp, re r, offer mm, subs_price_plan spp
              where busp.subs_plan_id = ov.offer_id
                and ov.offer_ver_id = spos.offer_ver_id
                and spos.offer_group_id = ogm.offer_group_id
                and ogm.offer_id = ovi.offer_id
                and ovi.offer_ver_id = rp.offer_ver_id
                and rp.re_id = r.re_id
                and re_type in ('3', 'A')
                and r.re_id != '1006'
                and ogm.offer_id = mm.offer_id
                and mm.offer_id = spp.price_plan_id
                and spp.price_plan_type = '2'"

    BUNDLE_MEMBER_NO_NEED_DEPOSIT_PRICE:
        des: Bundle member no need configure BSNL_DEPOSIT_PRICE attribute
        sql: "select /*+ parallel(12)*/ mm.*
                from bundle_unit_subs_plan busp, offer_ver ov, subs_plan_offer_select spos,
                     offer_group_mem ogm, offer_ver ovi, rate_plan rp, re r, offer mm, subs_price_plan spp,
                     offer_attr oa, attr ar
              where busp.subs_plan_id = ov.offer_id
                and ov.offer_ver_id = spos.offer_ver_id
                and spos.offer_group_id = ogm.offer_group_id
                and ogm.offer_id = ovi.offer_id
                and ovi.offer_ver_id = rp.offer_ver_id
                and rp.re_id = r.re_id
                and re_type in ('3', 'A')
                and r.re_id != '1006'
                and ogm.offer_id = mm.offer_id
                and mm.offer_id = spp.price_plan_id
                and spp.price_plan_type = '2'
                and oa.offer_id = mm.offer_id
                and oa.attr_id = ar.attr_id
                and ar.attr_code = 'BSNL_DEPOSIT_PRICE'"

    ACCT_ITEM_TYPE_APPLY_TAX:
        des: account item type not apply tax
        sql: "select /*+ parallel(12)*/
               case when substr(a.acct_item_type_code, 3, 2) in ('00') then
                  'ZangRuirui'
                 when substr(a.acct_item_type_code, 3, 2) in ('08') then
                  'WuZonglin'
                 when substr(a.acct_item_type_code, 3, 2) in
                      ('02','06','07','10','11','12','13','14','15','16','17','20') then
                  'GuSitao'
                 when substr(a.acct_item_type_code, 3, 2) in
                      ('01', '09', '21', '22') then
                  'HeWenbo'
                 else
                  'ZangRuirui'
               end owner, a.* from acct_item_type a 
                where a.acct_item_type_id not in (select b.acct_item_type_id from acct_item_tax_apply b) 
                and substr(a.acct_item_type_code, 3, 2) != '09' 
                and (a.parent_id not in (30101, 220) or a.parent_id is null) 
                and a.acct_item_type_id not between 59000 and 59999 
                and a.acct_item_type_id not between 68001 and 68013 
                and a.acct_item_type_id not in ('30001', '122', '123', '10137', '16141', '111', '116','22087', '30401')"

    ACCT_ITEM_TYPE_USAGE_TYPE:
        des: account item type usage type should not be null
        sql: "select /*+ parallel(12)*/*
               from acct_item_type
              where acct_item_type_id between 30001 and 40000
                and usage_type is null
                and comments in ('Additional Rental Charge', 'Leased Line Advance RC', 'VSAT Site Advance RC',
                    'VSAT Other Advance RC', 'Advance Rental', 'FMT Advance Rental')"

    BSNL_FMC_CHARGE:
        des: BSNL_FMC_CHARGE missing
        sql: "select /*+ parallel(12)*/a.price_plan_id, o.offer_name, sp.*
               from subs_price_plan        a,
                    offer_group_mem        ogm,
                    subs_plan_offer_select spos,
                    subs_plan              sp,
                    offer o
              where a.price_plan_type = '2'
                and a.price_plan_id between 600 and 400000
                and a.price_plan_id = ogm.offer_id
                and ogm.offer_group_id = spos.offer_group_id
                and spos.offer_ver_id = sp.subs_plan_id
                and a.price_plan_id = o.offer_id
                and (sp.sale_flag = '0' or
                    (sp.sale_flag = '2' and
                    sp.indep_prod_spec_id not in
                    (200007, 200003, 200005, 200031, 200009, 200010, 200011)))
                and sp.indep_prod_spec_id not in (200028, 200014, 200015, 200092, 200056,200019,200037,200047,200063,200060,200061,200068,
                    200062,200067,200065,200059,200057,200058,200064,200066,200069,200070,200071,200072,200073,200074,200075,200076,200077,
                    200078,200079,200080,200081,200091,200093,200095)
                and a.price_plan_id not in (122402,123936,123938,123937,123939,133794,133795)
                and not exists (select 1
                       from offer_attr oa, attr ar
                      where oa.attr_id = ar.attr_id
                        and ar.attr_code in ('BSNL_FMC_CHARGE', 'BSNL_TOTAL_FMC_CHARGE')
                        and oa.offer_id = a.price_plan_id)"

    COMBO_VOICE_DPP:
        des: only need one dpp for combo voice subs plan
        sql: "select /*+ parallel(12)*/offer_group_id, count(1) from 
              ( select distinct ogm.offer_group_id, ogm.offer_id 
                from offer_group_mem ogm, subs_plan_offer_select spos, offer_group og, subs_plan sp, offer o 
                where ogm.offer_group_id = og.offer_group_id and og.offer_group_type = 6 
                and og.offer_group_id = spos.offer_group_id and spos.offer_ver_id = sp.subs_plan_id 
                and sp.indep_prod_spec_id in ('200007', '200005', '200003', '200031', '200010', '200011', '200009') 
                and sp.sale_flag = '2' and ogm.offer_id = o.offer_id and (o.exp_date is null or o.exp_date > sysdate)) tt 
                group by tt.offer_group_id having count(1)>1"

    ANNUAL_SUBS_PLAN_MERGET_INTO_MONTHLY:
        des: ANNUAL plan should merget into montly plan
        area: A019
        sql: "select /*+ parallel(12)*/b.*
               from dc_tariff_dpp_rela a, dc_tariff_id_mapping_west b
              where a.type_of_plan in ('ANNUAL', 'HALF YEARLY', 'QUARTERLY')
                and a.tariff_id_billing = b.org_id
                and b.map_type = 'SUBS_PLAN_OFFER_ID'
                and b.deal_flag = '1'
                and a.tariff_in_monthly != a.tariff_id_billing
                and a.dpp_type = 'TARIFF'
                and b.org_code in ('802', '6', '335', '734')"

    COMBO_ANNUAL_PRICE_PLAN_MERGET_INTO_MONTHLY:
        des: Combo annual price plan should merget into montly price plan
        area: A019
        sql: "select /*+ parallel(12)*/b.*
               from dc_tariff_dpp_rela a, dc_tariff_id_mapping_west b
              where a.type_of_plan in ('ANNUAL', 'HALF YEARLY', 'QUARTERLY')
                and a.tariff_id_billing = b.org_id
                and b.map_type = 'PRICE_PLAN_OFFER_ID'
                and b.deal_flag = '1'
                and a.tariff_in_monthly != a.tariff_id_billing
                and a.dpp_type = 'TARIFF'
                and b.org_code in ('802', '6', '335', '734')
                and b.ext_str6 = 'COMBO'"

    COMBO_MEMBER:
        des: Combo must have three subs plan
        sql: "select /*+ parallel(12)*/bundle_unit_id
               from bundle_unit_subs_plan a
              where not exists (
                    select 1
                      from bundle_unit bu, subs_plan sp
                     where bu.bundle_unit_id = a.bundle_unit_id
                       and bu.offer_ver_id = sp.subs_plan_id
                       and sp.indep_prod_spec_id = '200082')
              group by a.bundle_unit_id having count(1) != 3"

    COMBO_MEMBER_WIFI:
        des: Combo must have two subs plan for wifi
        sql: "select /*+ parallel(12)*/bundle_unit_id
               from bundle_unit_subs_plan a
              where exists (
                    select 1
                      from bundle_unit bu, subs_plan sp
                     where bu.bundle_unit_id = a.bundle_unit_id
                       and bu.offer_ver_id = sp.subs_plan_id
                       and sp.indep_prod_spec_id = '200082')
              group by a.bundle_unit_id having count(1) != 2"

    COMBO_MEMBER_INDEPEND:
        des: Combo must have three independ product
        sql: "select /*+ parallel(12)*/bundle_unit_id
                from bundle_unit_indep_prod_spec a
               where not exists (
                     select 1
                       from bundle_unit bu, subs_plan sp
                      where bu.bundle_unit_id = a.bundle_unit_id
                        and bu.offer_ver_id = sp.subs_plan_id
                        and sp.indep_prod_spec_id = '200082')
                 group by a.bundle_unit_id having count(1) != 3"

    COMBO_MEMBER_INDEPEND_WIFI:
        des: Combo must have three independ product for wifi
        sql: "select /*+ parallel(12)*/bundle_unit_id
               from bundle_unit_indep_prod_spec a
              where exists (
                    select 1
                      from bundle_unit bu, subs_plan sp
                     where bu.bundle_unit_id = a.bundle_unit_id
                       and bu.offer_ver_id = sp.subs_plan_id
                       and sp.indep_prod_spec_id = '200082')
                group by a.bundle_unit_id having count(1) != 2"

#    NO_TARIFFELEMENT_SUBSPLAN:
#        des: should remove those subs plan as not in tariffelement table
#        area: A019
#        sql: "select /*+ parallel(12)*/*
#               from dc_tariff_id_mapping_west a
#              where a.map_type in ('SUBS_PLAN_OFFER_ID')
#                and a.deal_flag = '1'
#                and a.org_code not like 'D%'
#                and a.org_id is not null
#                and a.org_id not in ('2870', '2871', '2872', '2873', '2874', '2875')
#                and a.org_code not in ('PERMANENT', '296', '100111', '100112', '100113', '100114', '100115', '586')
#                and a.ext_str1 not in ('CASUAL')
#                and (a.comments is null or a.comments not in
#                ('caigh:have some subscriber', 'caigh:for migration','caigh:not in tariffelement','hxp: 有实例数据，手动插入','for magration'))
#                and not exists (
#                    select 1
#                      from west.tariffelement b
#                     where b.catalogue_change_id = 860
#                       and to_char(b.tariff_id) = a.org_id
#                       and to_char(b.product_id) = a.org_code
#                       and b.end_dat is null)"

#    NO_TARIFFELEMENT_PRICEPLAN:
#        des: should remove those price plan as not in tariffelement table
#        area: A019
#        sql: "select /*+ parallel(12)*/*
#               from dc_tariff_id_mapping_west a
#              where a.map_type in ('PRICE_PLAN_OFFER_ID')
#                and a.deal_flag = '1'
#                and a.org_code not like 'D%'
#                and a.org_id not in ('2870', '2871', '2872', '2873', '2874', '2875')
#                and a.org_code not in ('RATING_TARIFF', '239', 'RATING_TARIFF_SPECIAL', '296', '586')
#                and a.ext_str1 not in ('SCHEME', 'CUG_DPP', 'OTC-SCHEME', 'RELATED_IPP', 'Bearing DPP', 'ACCOUNT_IPP')
#                and a.target_id not in (122402)
#                and (a.comments is null or a.comments not in
#                    ('caigh:have some subscriber', 'caigh:for migration','for magration','caigh:not in tariffelement','hxp: 有实例数据，手动插入'))
#                and not exists (
#                    select 1
#                      from west.tariffelement b
#                     where b.catalogue_change_id = 860
#                       and to_char(b.tariff_id) = a.org_id
#                       and to_char(b.product_id) = a.org_code
#                       and b.end_dat is null)"

    COMBO_LL_MEMBER_RENTAL_ZERO:
        des: the rental of LL member of combo should be zero
        area: A020
        sql: "select /*+ parallel(12)*/*
               from dc_tariff_id_mapping a
              where a.map_type = 'PRICE_PLAN_OFFER_ID'
                and a.ext_str6 = 'SOUTH'
                and a.deal_flag = '1'
                and a.ext_str3 in ('COMBO-MEMBER-LL')
                and a.ext_str2 != '0'"

#    OFFER_NEED_RENAME:
#        des: offer need rename
#        sql: "select *
#               from offer o
#              where o.offer_type = 7
#                and not exists (
#                    select 1
#                      from DC_OFFER_DETAIL b
#                     where b.offer_id = o.offer_id)
#                and o.offer_id between 70000 and 370000
#             union all
#             select *
#               from offer o
#              where o.offer_type = 4
#                and not exists (
#                    select 1
#                      from DC_OFFER_DETAIL b
#                     where b.offer_id = o.offer_id)
#                and exists (
#                    select 1
#                      from subs_price_plan c
#                     where c.price_plan_id = o.offer_id
#                       and c.price_plan_type = '2')
#                and o.offer_id between 20000 and 370000"

    OFFER_GROUP_MEM_OFFER_NOT_EXIST:
        des: Offer id not exist
        sql: "SELECT *
              FROM offer_group_mem og
             WHERE og.OFFER_GROUP_ID BETWEEN 10000 AND 200000
               AND og.offer_id between 1000 and 400000
               AND NOT EXISTS
                   (SELECT 1
                     FROM offer o
                    WHERE o.offer_id = og.offer_id)"

    ISD_IPP_CHECK:
        des: subs plan configured ISD, but haven't configure ISD usage price
        sql: "select o.*
               from subs_plan_offer_select spoa, offer_group_mem ogm,
                    depend_prod_spec dps, offer o
              where spoa.offer_group_id = ogm.offer_group_id
                and ogm.offer_id = dps.depend_prod_spec_id
                and dps.serv_type = 193
                and spoa.offer_ver_id = o.offer_id
                and o.offer_id not in (170002,171700,171701,171702,171703,171704,171705,171036,171181,171611,176980,176981,170568,177767,177768,177769,171208,170292)
                and not exists (
                    select 1
                      from subs_plan_offer_select spos, offer_group_mem ogmi, offer_group og, offer oi
                     where spos.offer_ver_id = spoa.offer_ver_id
                       and spos.offer_group_id = ogmi.offer_group_id
                       and ogmi.offer_group_id = og.offer_group_id
                       and og.offer_group_type = '4'
                       and og.offer_group_name like '%RATING GRP'
                       and ogmi.offer_id = oi.offer_id
                       and oi.offer_name like '%ISD%')"

    DPP_GROUP_CHECK:
        des: dpp offer group shouldn't have ipp
        sql: "select *
               from offer_group og, offer_group_mem ogm, subs_price_plan spp
              where og.offer_group_type = 6
                and og.offer_group_id = ogm.offer_group_id
                and ogm.offer_id = spp.price_plan_id
                and spp.price_plan_type != '2'"

    OFFER_APPLY_CATG_CHECK:
        des: catg haven't defined
        sql: "select *
               from offer_apply_catg oac
              where not exists (
                    select 1
                      from catg c
                     where c.catg_id = oac.catg_id)"

    UOS_TACHE_DEF_IP:
        des: can't have IP address
        sql: "select * from uosflow.UOS_TACHE_DEF t where t.serviceurl like '%ttp%'"

    UOS_PROCESSDEFINE_XML:
        des: can't have IP address
        sql: "select * from uosflow.UOS_PROCESSDEFINE_XML a where dbms_lob.instr(a.detail,'ServiceType=\"HTTP\" ServiceUrl=\"http:')>0"

    OFFER_CATG_MEM_SALES:
        des: child category can't in multiple category
        sql: "select count(*) from offer_catg_mem ocm where ocm.child_offer_catg_id is not null group by ocm.child_offer_catg_id having count(*)>1"

    CHECK_DUPLICATE_MONTHLY_DPP:
        des: Can't have two montly dpp in one offer group
        sql: "select * from offer   WHERE offer_id IN
                 (select SUBS_PLANID from (
                 select SUBS_PLANID,count(1) cnt from (
                 select distinct so.offer_id Subs_planid,so.offer_code subs_plan_code, so.offer_name subs_plan_name,
                 po.offer_id DPP_id,po.offer_code DPP_code, po.offer_name DPP_name
                 from offer so,  offer po, subs_plan sp, offer_group og, offer_group_mem om,OFFER_CATG_MEM ocm,offer_catg oc
                 where so.offer_id = sp.subs_plan_id
                 and so.offer_id=ocm.offer_id
                 and sp.subs_plan_id != '170947'
                 and ocm.offer_catg_id=oc.offer_catg_id
                 and og.offer_group_type = '6'
                 and og.offer_ver_id = sp.subs_plan_id
                 and og.offer_group_id = om.offer_group_id
                 and po.offer_id = om.offer_id
                 and oc.state='A'
                 and oc.comments not in ('SubsPlan Child Catg For SDC Plans')
                 and (po.exp_date is null or po.exp_date > sysdate)) WHERE DPP_NAME  LIKE '%MONTHLY%' and DPP_NAME not LIKE '%SIX-MONTHLY%'
                 GROUP BY SUBS_PLANID)  WHERE cnt >1)"

    CHECK_DUPLICATE_ANNUALLY_DPP:
        des: Can't have two annually dpp in one offer group
        sql: "select * from offer   WHERE offer_id IN
                 (select SUBS_PLANID from (
                 select SUBS_PLANID,count(1) cnt from (
                 select distinct so.offer_id Subs_planid,so.offer_code subs_plan_code, so.offer_name subs_plan_name,
                 po.offer_id DPP_id,po.offer_code DPP_code, po.offer_name DPP_name
                 from offer so,  offer po, subs_plan sp, offer_group og, offer_group_mem om,OFFER_CATG_MEM ocm,offer_catg oc
                 where so.offer_id = sp.subs_plan_id
                 and so.offer_id=ocm.offer_id
                 and ocm.offer_catg_id=oc.offer_catg_id
                 and og.offer_group_type = '6'
                 and og.offer_ver_id = sp.subs_plan_id
                 and og.offer_group_id = om.offer_group_id
                 and po.offer_id = om.offer_id
                 and oc.state='A'
                 and so.offer_id!= '171816'
                 and oc.comments not in ('SubsPlan Child Catg For SDC Plans')
                 ) WHERE DPP_NAME  LIKE '%ANNUAL%' AND DPP_NAME NOT  LIKE '%BI-ANNUAL%' and  DPP_NAME NOT  LIKE '%BIANNUAL%'
                 GROUP BY SUBS_PLANID)  WHERE cnt >1)"

    CHECK_RENTAL_CYCLE_DPP:
        des: Rental cycle is different with legacy
        area: A019
        sql: "select * from (
              SELECT DISTINCT   tim.TARGET_ID ,t1.tariff_id,t1.tariff_name,t2.product_id,t2.charge_period,t2.charge_period_units,  o2.DEFAULT_VALUE AS value217,
              CASE o1.DEFAULT_VALUE WHEN '1' THEN 'D'
              WHEN '2' THEN  'W'
              WHEN '3' THEN  'M'
              WHEN '6' THEN  'M'
              WHEN '4' THEN  'Y'
              ELSE  o1.DEFAULT_VALUE END AS value216 
            from west.tariff t1,west.product t11,west.tariffelement t2,west.TARIFFELEMENTBAND t3
            ,(select * from DC_TARIFF_ID_MAPPING_WEST UNION ALL select * from DC_TARIFF_ID_MAPPING_WEST_NEW) tim,OFFER_ATTR o1 , OFFER_ATTR o2
          where t1.tariff_id=t2.tariff_id and t2.tariff_id=t3.tariff_id
          and t2.product_id=t3.product_id and t2.catalogue_change_id=t1.catalogue_change_id and t3.catalogue_change_id=t1.catalogue_change_id 
          and t2.end_dat is null and t2.catalogue_change_id =860 and t3.catalogue_change_id=860  
          and t2.product_id=t11.product_id and t2.start_dat=t3.start_dat  AND o1.OFFER_ID =tim.TARGET_ID  AND o2.OFFER_ID =tim.TARGET_ID 
          AND tim.ORG_ID = to_char(t1.TARIFF_ID) AND tim.ORG_CODE = to_char(t11.product_id) and tim.map_type='PRICE_PLAN_OFFER_ID'
          and tim.target_val='2' and tim.deal_flag='1' AND tim.DEAL_FLAG ='1'
          AND o1.ATTR_ID = '216' AND o2.ATTR_ID = '217' 
          and tim.org_id!='3173')  a WHERE charge_period <> value217 OR charge_period_units <> value216"

    HSN_CODE_CONFIGURE:
        des: the relationship should be there between acct item type and HSN
        area: A019
        sql: "select *
                 from dc_hsn_ait_mapping_west
                 where hsn_code not in ('851762', '997316', '998412')
                    or acct_item_type_id is null
                    or (hsn_code = '851762' and substr(acct_item_type_code, 3, 2) != '14')
                    or (hsn_code = '997316' and substr(acct_item_type_code, 3, 2) not in ('07', '22'))
                    or substr(acct_item_type_code, 3, 2) in ('09')"

    AAA_ATTRIBUTE_CHECK:
        des: 3A feature should be configured
        area: A019
        sql: "select *
                   from subs_plan_offer_attr spo, subs_plan sp,dc_tariff_id_mapping_west tim
                  where spo.offer_ver_id = sp.subs_plan_id
                  and tim.target_id = sp.subs_plan_id
                  and tim.map_type='SUBS_PLAN_OFFER_ID'
                  and tim.deal_flag='1'
                  and spo.attr_id = (select attr_id from attr where attr_CODE = 'BSNL_AAA_DESC')
                  and sp.indep_prod_spec_id in (select ids.indep_prod_spec_id from indep_prod_spec ids where ids.serv_type in (79,903,931))
                  and spo.default_value is null
                  and exists(select 1 from offer_catg_mem ocm, offer_catg oc
                             where ocm.offer_catg_id = oc.offer_catg_id
                             and oc.offer_catg_class = 'B'
                             and ocm.offer_id = spo.offer_ver_id)"

    ACCOUNT_TYPE_CHECK_FROM_SALES_RULE:
        des: Account type for scheme sales rule should be configured in attr_value table
        sql: "select * 
                   from  TABULAR_SALES_RULE_ATTR_VALUE tv,TABULAR_SALES_RULE se,SALES_RULE s
                  where tv.rule_attr_code in ('ACCOUNT_TYPE')
                    and not exists(select 1 from attr_value av where av.base_attr_id='77' and av.value = tv.value)
                    and tv.tabular_rule_id = se.tabular_rule_id
                    and se.sales_rule_id = s.sales_rule_id
                    and tv.tabular_rule_attr_value_id not in (108489,109661)"

    ACCOUNT_SUB_TYPE_CHECK_FROM_SALES_RULE:
        des: Account sub type for scheme sales rule should be configured in attr_value table
        sql: "select * from  TABULAR_SALES_RULE_ATTR_VALUE tv,TABULAR_SALES_RULE se,SALES_RULE s
                  where tv.rule_attr_code in ('ACCOUNT_SUBS_TYPE')
                    and not exists(select 1 from attr_value av where av.base_attr_id='768' and ( regexp_like(tv.value,av.value) or tv.value=av.value))
                    and tv.tabular_rule_id = se.tabular_rule_id
                    and se.sales_rule_id = s.sales_rule_id"

    ACCOUNT_TYPE_CHECK_FROM_SALES_CATG:
        des: Account type for sales catgory should be configured in attr_value table
        sql: "select * from  ACCT_CATG_ATTR_VALUE gv
                  where gv.base_attr_id='77'
                    and not exists(select 1 from attr_value av where av.base_attr_id='77' and av.value = gv.value)"

    ACCOUNT_SUB_TYPE_CHECK_FROM_SALES_CATG:
        des: Account sub type for sales catgory should be configured in attr_value table
        sql: "select * from  ACCT_CATG_ATTR_VALUE gv
                  where gv.base_attr_id='768'
                    and not exists(select 1 from attr_value av where av.base_attr_id='768' and av.value = gv.value)"

    STD_LOCAL_USAGE_IPP:
        des: STD AND LOCAL usage IPP should not duplicately apply under a subs_plan
        area: A019
        sql: "select d.org_id, o7.offer_id, o7.offer_name, count(1)
                   from dc_tariff_id_mapping_west d,
                        offer                     o7,
                        subs_plan_offer_select    spos,
                        offer_group_mem           ogm,
                        offer_group               og,
                        offer                     o4
                  where d.deal_flag = '1'
                  and d.map_type = 'SUBS_PLAN_OFFER_ID'
                  and d.target_id = o7.offer_id
                  and o7.offer_id = spos.offer_ver_id
                  and spos.offer_group_id = ogm.offer_group_id
                  and ogm.offer_group_id = og.offer_group_id
                  and og.offer_group_name like '%RATING GRP'
                  and ogm.offer_id = o4.offer_id
                  and o4.offer_name like '%_LCL_%'
                  and o4.offer_name not like '%_SPECIAL%'
                  and d.org_id not in ('1215','1844')
                  and d.target_val not in ('200036','200098')
                group by d.org_id, o7.offer_id, o7.offer_name
               having count(1) > 1"

    ISD_USAGE_IPP:
        des: ISD usage IPP should not duplicately apply under a subs_plan
        area: A019
        sql: "select d.org_id, o7.offer_id, o7.offer_name, count(1)
                   from dc_tariff_id_mapping_west d,
                        offer                     o7,
                        subs_plan_offer_select    spos,
                        offer_group_mem           ogm,
                        offer_group               og,
                        offer                     o4
                  where d.deal_flag = '1'
                  and d.map_type = 'SUBS_PLAN_OFFER_ID'
                  and d.target_id = o7.offer_id
                  and o7.offer_id = spos.offer_ver_id
                  and spos.offer_group_id = ogm.offer_group_id
                  and ogm.offer_group_id = og.offer_group_id
                  and og.offer_group_name like '%RATING GRP'
                  and ogm.offer_id = o4.offer_id
                  and o4.offer_name like '%_ISD_%'
                  and o4.offer_name not like '%_SPECIAL'
                group by d.org_id, o7.offer_id, o7.offer_name
               having count(1) > 1"

    SPECIAL_USAGE_IPP:
        des: LCL special usage IPP should be configured for subs pan that have LCL usage IPP
        sql: "select distinct og.* from offer_group og, offer_group_mem ogm
                  where og.offer_group_id=ogm.offer_group_id
                    and og.comments ='RATING TARIFF IPP WDC'
                    and exists(select 1 from offer o,offer_group_mem oga
                                where o.offer_id = oga.offer_id
                                  and ogm.offer_group_id = oga.offer_group_id
                                  and o.offer_name like '%_LCL_%')
                    and not exists(select 1 from offer p,offer_group_mem ogb
                                    where p.offer_id = ogb.offer_id
                                      and ogm.offer_group_id = ogb.offer_group_id
                                      and p.offer_name like '%SPECIAL%')"

    ACCOUNT_ITEM_HSN_CODE_NEED_ADD_CZ:
        des: Account item should have HSN_CODE
        area: A019
        sql: "select distinct a.*
              from acct_item_type a
              where substr(a.acct_item_type_code, 1, 2) not in ('43', '46', '51', '54', '71')
              and substr(a.acct_item_type_code, 3, 2) not in ('09', '10')
              and a.acct_item_type_id not in (select b.acct_item_type_id from bsnl_hsn_ait_mapping_west b)"

    ACCOUNT_ITEM_HSN_CODE_NEED_DELETE_CZ:
        des: Account item should DELETE HSN_CODE
        area: A019
        sql: "select *
                   from bsnl_hsn_ait_mapping_west a
                  where a.acct_item_type_id not in (select b.acct_item_type_id from acct_item_type b)
                  order by a.acct_item_type_id"

    BSNL_PACKAGE_ID_ATTR_VALUE:
        des: Package id should in attr value
        sql: "select * from subs_plan_offer_attr spa
                  where spa.attr_id = (select attr_id from attr where attr_code ='BSNL_PACKAGE_ID')
                    and spa.default_value is not null
                    and not exists(select 1 from attr_value av
                    where av.base_attr_id = spa.attr_id
                     and av.value = spa.default_value)"

    ADVANCE_RANTAL_CHECK:
        des: Monthly/Daily/weekly DPP should not have BSNL_ADVANCE_RENTAL
        sql: "select * from offer_attr oo
                  where oo.attr_id = 1127
                    and  exists 
                (select 1 
                  from offer_attr oa, offer_attr ob
                 where oa.offer_id = oo.offer_id
                   and oa.offer_id = ob.offer_id
                   and oa.attr_id = 216
                   and ob.attr_id = 217
                   and oa.offer_id not in (132332,132341,132601,133231,133748,133741,133819)
                   and ((oa.default_value in ('6', '3') and ob.default_value = '1')
                       or oa.default_value in ('1', '2')))
                 and not exists(select 1 from dc_tariff_id_mapping_west_new tim
               where tim.target_id = oo.offer_id
               and tim.map_type='PRICE_PLAN_OFFER_ID'
               AND tim.comments='ADV')"

#    STAFF_DEFAULT_OGG_CHECK:
#        des: One staff should not be set as default duplicately
#        sql: "select staff_id, a.state from ftf.bfm_staff_org a where a.is_default = 'Y'
#                and a.staff_id !='101531'
#                and a.state !='X'
#                 group by a.staff_id, a.state having count(1)>1"

#    STAFF_ORG_CHECK:
#        des: One staff and one ORG should not have multiple records
#        sql:
#            "select a.staff_id, a.org_id,a.state from ftf.bfm_staff_org a
#            WHERE state<>'X' and a.staff_id !=19259
#            group by a.staff_id, a.org_id, a.state having count(1)>1"

    DPP_NAME_CHECK:
        des: DPP name should end with rental cycle
        sql: "select * from offer WHERE OFFER_TYPE = '4' 
              AND OFFER_NAME NOT LIKE '%MONTHLY' AND OFFER_NAME NOT LIKE '%YEARLY' and OFFER_NAME  NOT LIKE '%MONTHLY-AR'
              AND OFFER_NAME NOT LIKE '%ANNUAL' AND OFFER_NAME NOT LIKE '%TRIENNIAL'  
              AND OFFER_NAME NOT LIKE '%QUARTERLY' AND OFFER_NAME NOT LIKE '%YEAR%' AND OFFER_NAME NOT LIKE '%WEEKLY'
              AND OFFER_NAME NOT LIKE '%-ADV' and OFFER_NAME NOT LIKE '%75-DAYS'
              AND OFFER_ID IN (select OFFER_ID from OFFER_ATTR WHERE ATTR_ID = '216')
              AND OFFER_ID IN (select spp.price_plan_id from subs_price_plan spp where spp.price_plan_type='2')
              and offer_id < 200000"

    DPP_RENTAL_ATTR_CHECK:
        des: DPP should have 216 and 217 attr
        sql: "select * from dc_hewb_rcrate_west a 
            where not exists (select 1 from offer_attr b where a.price_plan_id=b.offer_id and b.attr_id=216)
            and exists (select 1 from offer c where a.price_plan_id=c.offer_id)"

    PP_PARAM_SEQ_CHECK_GST:
        des: QT_PP_PARAM_VER_GROUP_MEM SEQ should not duplicated
        sql: "select * from (
              select a.PP_PARAM_VER_ID ,a.GROUP_ID ,a.SEQ,count(1) cnt from quot.QT_PP_PARAM_VER_GROUP_MEM a GROUP BY
              a.PP_PARAM_VER_ID ,a.GROUP_ID ,a.SEQ
              ) WHERE cnt > 1"

    PARAM_CODE_DEFINE_CHECK_GST:
        des: PARAM_CODE should define for quot
        sql: "select PARAM_CODE from simple_param_define a WHERE PARAM_CODE NOT  IN 
              (select PARAM_CODE from dc_quot_code_seq) AND a.SIMPLE_PARAM_ID  BETWEEN 1000 AND 6000"

    OTT_OFFER_GROUP_ADD_CHECK:
        des: Need Inform Comc to Update The View Of MID_VIEW_OTT_INFO
        sql: "SELECT OGM.OFFER_GROUP_ID,'Need Inform Comc to Update The View Of MID_VIEW_OTT_INFO,Also Need Update This Check Script' COMMENTS 
             FROM OFFER O
             JOIN OFFER_ATTR OA ON O.OFFER_ID = OA.OFFER_ID
             JOIN OFFER_GROUP_MEM OGM ON O.OFFER_ID = OGM.OFFER_ID
            WHERE OA.ATTR_ID = '10036'
              AND   OA.DEFAULT_VALUE = 'bundle'
              and ogm.offer_group_id not in (37314,35410,35408,36023,37190,36024,38210,38451)"

    serv_type_event_rela_CHECK:
        des: erv_type_event_rela_CHECK
        sql: "select distinct o.subs_event_id, t.subs_event_id 
              from crm.serv_type_event_rela o, crm.serv_type_event_rela t
              where not exists (
             select 1
              from crm.subs_event_rela b
            where ((o.subs_event_id = b.subs_event_id
               and t.subs_event_id = b.rela_subs_event_id)
              or (o.subs_event_id = b.rela_subs_event_id
             and t.subs_event_id = b.subs_event_id)))"

    usage_type<>A_CHECK_ZRR:
        des: the tax revenuecode should usage_type<>A
        sql: "select
               case 
              when substr(t.acct_item_type_code,3,2) in ('00') then 'ZangRuirui'
                when substr(t.acct_item_type_code,3,2) in ('08') then 'WuZonglin'
                  when substr(t.acct_item_type_code,3,2) in ('02','06','07','10','11','12','13','14','15','16','17','20') then 'Gusitao'
                    when substr(t.acct_item_type_code,3,2) in ('01','09','21','22') then 'HeWenbo'
                      else 'ZangRuirui' end owner,t.*
              from cc.acct_item_type t
             where t.acct_item_type_code in
                   (select a.acct_item_type_code
                      from acct_item_type a
                     where a.acct_item_type_code is not null
                     group by a.acct_item_type_code
                    having count(1) > 1)
             order by t.acct_item_type_code"

    SIP_LAST_MAIL_CHECK:
        des: the last mail attr of sip in zsip_int_plan should not be MPLS
        sql: "select * from westcrm.zsip_int_plan zp,dc_tariff_id_mapping_west tim,subs_plan_offer_attr sps
             where zp.plan_id = 'D1'||tim.org_id
             and tim.map_type = 'SUBS_PLAN_OFFER_ID'
             and sps.offer_ver_id = tim.target_id and sps.attr_id = (select attr_id from attr where attr_code = 'EXP_LAST_MILE_TYPE')
             and sps.default_value = 'MPLS'"

    OFFER_GROUP_CODE_CHECK:
        des: OFFER_GROUP_CODE should not duplicate
        sql: "select og.offer_group_code,listagg(og.offer_group_name,', '),count(*) 
             from offer_group og  
             where og.offer_group_code is not null
             group by og.offer_group_code having count(*)>1"

    DPP_OFFER_GROUP_CHECK:
        des: DPP should only in one offer group
        sql: "select spp.price_plan_id, listagg(ogm.offer_group_id,','),count(*) 
             from subs_price_plan spp, offer_group_mem ogm
             where spp.price_plan_type = '2'
              and ogm.offer_id = spp.price_plan_id
              and not exists(select 1 from subs_plan_offer_select sps, offer o
              where ogm.offer_group_id = sps.offer_group_id
              and sps.offer_ver_id=o.offer_id
              and o.state='X')
              group by spp.price_plan_id having count(*) > 1"

    ACCT_ITEM_MAPPING_CHECK:
        des: acct_item should have mapping
        sql: "select case
                 when substr(a.acct_item_type_code, 3, 2) in ('00') then
                  'ZangRuirui'
                 when substr(a.acct_item_type_code, 3, 2) in ('08') then
                  'WuZonglin'
                 when substr(a.acct_item_type_code, 3, 2) in
                      ('02','06','07','10','11','12','13','14','15','16','17','20') then
                  'GuSitao'
                 when substr(a.acct_item_type_code, 3, 2) in
                      ('01', '09', '21', '22') then
                  'HeWenbo'
                 else
                  'ZangRuirui'
               end owner, a.*
              from acct_item_type a
             where a.revenue_code_id is not null
               and a.revenue_code_id not in (-99999)
               and not exists (
                   select 1
                     from dc_revenue_code_acct_item_map b
                    where a.acct_item_type_id = b.acct_item_type_id
                      and a.revenue_code_id = b.revenue_code_id)
               and not exists (
                   select 1
                     from dc_revenue_code_acct_item_no_map b
                    where a.acct_item_type_id = b.acct_item_type_id)"

    SUBS_PLAN_OFFER_ATTR_CHECK:
        des: SUBS_PLAN_OFFER_ATTR should not duplicate while group by offer_ver_id,offer_id,attr_id
        sql: "select  spo.offer_ver_id,spo.offer_id,spo.attr_id,count(*) 
                from subs_plan_offer_attr spo  
               group by spo.offer_ver_id,spo.offer_id,spo.attr_id having count(*)>1"

    ISDN_FACILITY_CHECK:
        des: ISDN plans should have the facility group which include ISD/LOCAL/STD..
        sql: "select distinct sp.subs_plan_id
                from subs_plan sp
                where sp.indep_prod_spec_id in ('200017','200018')
                and not exists(select 1 from subs_plan_offer_select sps, offer_group og
                where sp.subs_plan_id=sps.offer_ver_id
                and sps.offer_group_id = og.offer_group_id
                and og.offer_group_name like 'ISDN%FACILITIES%')"

    ISDN_ACCESSORY_CHECK:
        des: ISDN plans should have the ACCESSORY group if it have specific ACCESSORY in legacy system
        sql: "  select distinct tim.target_id,zb.product_id,zb.shtext_large
                  from dc_tariff_id_mapping_west tim,dc_childprod_servtype_map_west dw,westcrm.zprod_ibin_link zb 
                where tim.target_val in ('200017','200018')
                and tim.map_type='SUBS_PLAN_OFFER_ID' 
                and tim.deal_flag='1'
                and to_char(replace(dw.monthly_plan_product_id,'D','')-10000)=tim.org_id
                and zb.product_id=dw.product_id and dw.product_type='04'
                and not exists(select 1 from subs_plan_offer_select sps, offer_group og
                where tim.target_id=sps.offer_ver_id
                and sps.offer_group_id = og.offer_group_id
                and og.offer_group_name like 'ISDN%ACCESSORIES%')"

    ACCT_ITEM_TYPE_CHECK:
        des: acct_item_type_id should in revenue_code table
        sql: "  select case
                 when substr(t.acct_item_type_code, 3, 2) in ('00') then
                  'ZangRuirui'
                 when substr(t.acct_item_type_code, 3, 2) in ('08') then
                  'WuZonglin'
                 when substr(t.acct_item_type_code, 3, 2) in
                      ('02','06','07','10','11','12','13','14','15','16','17','20') then
                  'GuSitao'
                 when substr(t.acct_item_type_code, 3, 2) in
                      ('01', '09', '21', '22') then
                  'HeWenbo'
                 else
                  'ZangRuirui'
               end owner,
               t.*
               from cc.acct_item_type t
               where t.acct_item_type_id not in
               (select acct_item_type_id from revenue_code)"

    SSA_CODE and GST_STATE_CODE:
        des: SSA_CODE + GST_STATE_CODE should be unique
        sql: "select SSA_CODE,GST_STATE_CODE,count(*) 
              from BSNL_SSA_STATE_MAP group by SSA_CODE,GST_STATE_CODE having count(*)>1"

    DPP_OFFER_CYCLE_CHECK:
        des: SSA_CODE + GST_STATE_CODE should be unique
        sql: " select o.offer_id,o.offer_name,o.cycle_quantity,obb.default_value
               from  offer o, offer_attr obb
               where (o.cycle_quantity != obb.default_value or o.cycle_quantity is null)
               and  obb.offer_id=o.offer_id 
               and obb.attr_id=217
               and exists (select 0 from subs_price_plan spp,offer_attr oa, offer_attr ob
                            where spp.price_plan_id = o.offer_id
                              and spp.price_plan_type='2'
                              and oa.attr_id='216'
                              and spp.price_plan_id=oa.offer_id
                              and spp.price_plan_id=ob.offer_id
                              and ob.attr_id='217'
                              and to_number(ob.default_value) >=12
                              and oa.default_value = '3')
              and o.state='A'
              and upper(o.offer_name) not like 'SIP-CPABX%'
              and lower(o.offer_name) not like 'webhosting%'"