UserList:
    cc


BadData:
    AcctItem_No_Define:
        sql:
            "select *
                  from cc.ref_value a
                 where a.ref_value_type = '8'
                   and not exists (select 1
                          from cc.acct_item_type b
                         where a.value_string = b.acct_item_type_id)"

    AcmAcctItem_RefValue_Error:
        sql:
            "select *
              from cc.acm a, cc.price_ver b, cc.rate_plan c, cc.ref_value d
             where a.price_ver_id = b.price_ver_id
               and b.rate_plan_id = c.rate_plan_id
               and a.ref_value_id = d.ref_value_id
               and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"

    AcmTemplet_No_Catalog:
        sql:
            "select *
                from cc.acm a, cc.price_ver c
                where a.template_flag = 'Y'
                    and not exists (select * from cc.price_catalog_element b where a.price_id = b.price_id)
                    and a.price_ver_id = c.price_ver_id and c.rate_plan_id is null"

    AcmValue_RefValue_Error:
        sql:
            "select *
              from cc.acm a, cc.price_ver b, cc.rate_plan c, cc.ref_value d
             where a.price_ver_id = b.price_ver_id
               and b.rate_plan_id = c.rate_plan_id
               and a.value = d.ref_value_id
               and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"

    BenefitTemplet_No_Catalog:
        sql:
            "select *
                from cc.event_benefit a
                where a.template_flag = 'Y'
                    and not exists (select * from cc.price_catalog_element b where a.price_id = b.price_id)
                    and a.price_ver_id is null"

    EventBenefit_RefValue_Error:
        sql:
            "select *
              from cc.event_benefit a, cc.price_ver b, cc.rate_plan c, cc.ref_value d
             where a.price_ver_id = b.price_ver_id
               and b.rate_plan_id = c.rate_plan_id
               and a.value = d.ref_value_id
               and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"

    Offer_No_Offer_Ver:
        sql:
            "select *
                  from cc.offer a
                 where offer_type in (4, 6)
                   and not exists (select 1
                          from cc.offer_ver b
                         where a.offer_id = b.offer_id
                           and (b.exp_date is null or b.exp_date > sysdate))
                           and state <>'X'"

    Price_and_RatePlan_Re_NotMatch:
        sql:
      # 检查资费模板和真正的资费的对应的事件是否一致
            "select f.offer_name, g.re_name, d.rate_plan_name, a.price_id, b.price_name
                  from cc.price_template_mapping_re a, cc.price b, cc.price_ver c, cc.rate_plan d, cc.offer_ver e, cc.offer f,cc.re g
                 where ((a.price_id = b.price_id and b.template_flag = 'Y') or
                       (a.price_id = b.src_price_id and b.template_flag = 'N'))
                   and b.price_ver_id = c.price_ver_id
                   and c.rate_plan_id = d.rate_plan_id
                   and a.re_id <> d.re_id
                   and d.offer_ver_id=e.offer_ver_id
                   and e.offer_id=f.offer_id
                   and d.re_id=g.re_id"

    PricePlan_No_Offer:
        sql:
            "select * from cc.price_plan a
                where not exists (select 1 from cc.offer b where a.price_plan_id = b.offer_id and b.offer_type = 4)"

    PricePlan_Offer_No_Price_Plan:
        sql:
            "select * from cc.offer a
            where not exists (select 1 from cc.price_plan b where b.price_plan_id = a.offer_id) and a.offer_type = 4"

    PricePlan_Re_No_Reserve:
        sql:
            "select distinct b.*
               from cc.rate_plan_mapping a, cc.re b
              where a.re_id = b.re_id
                and b.re_type = '1'
                and not exists (select 1 from cc.reserve_policy c where a.re_id = c.re_id)
                and not exists (select 1 from cc.RESERVE_POLICY_PROD_SPEC d where a.re_id = d.re_id)
                and upper(b.re_name) not like '%%SMS%%'
                and upper(b.re_name) not like '%%MMS%%'"

    PriceTemplate_No_Catalog:
        sql:
            "select * from cc.price a
            where a.template_flag = 'Y' and not exists (select * from cc.price_catalog_element b where a.price_id = b.price_id) and a.price_ver_id is null"

    PriceTemplate_One_Mapping_Multi_Re:
        sql:
      # 一个模板被多个Rate_plan所引用，但是Re_id不一样
          "select distinct d.rate_plan_id, d.rate_plan_name, b.price_id, b.price_name
             from cc.price_template_mapping_re a, cc.price b, cc.price_ver c, cc.rate_plan d , cc.re e
             where a.price_id = b.src_price_id
             and b.price_ver_id = c.price_ver_id
             and c.rate_plan_id = d.rate_plan_id
             and d.re_id = e.re_id
             and e.re_type <>'9'
             and a.re_id <> d.re_id"

    PriceValue_RefValue_Error:
        sql:
            "select *
              from cc.price a, cc.price_ver b, cc.rate_plan c, cc.ref_value d
             where a.price_ver_id = b.price_ver_id
               and b.rate_plan_id = c.rate_plan_id
               and a.value = d.ref_value_id
               and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"

    PriceVer_No_Use:
        sql:
            "select *
              from cc.price_ver a
             where not exists (select * from cc.price b where a.price_ver_id = b.price_ver_id)
               and not exists (select * from cc.event_benefit b where a.price_ver_id = b.price_ver_id)
               and not exists (select * from cc.acm b where a.price_ver_id = b.price_ver_id)
               and (a.exp_date is null or a.exp_date > sysdate)"

    RatePlan_No_PriceVer:
        sql:
            "select r.re_name,d.offer_name,d.offer_id,a.*
                  from cc.rate_plan a,cc.re r,cc.offer_ver c,cc.offer d
                 where not exists
                 (select * from cc.price_ver b where a.rate_plan_id = b.rate_plan_id)
                   and a.rate_plan_id <> -1
                 and a.re_id=r.re_id
                 and a.offer_ver_id=c.offer_ver_id
                 and d.state='A'
                 and c.offer_id=d.offer_id
                 order by a.offer_ver_id"
    #        "select * from rate_plan a where not exists (select * from price_ver b where a.rate_plan_id = b.rate_plan_id) and a.rate_plan_id <> -1"

    RatePlanTemplet_No_Catalog:
        sql:
            "select * from cc.rate_plan a
            where a.template_flag = 'Y'and a.rate_plan_id <> -1 and not exists (select 1 from cc.rate_plan_catalog_element b where a.rate_plan_id = b.rate_plan_id)"

    RefValue_No_OfferVerId:
        sql:
            "select * from cc.REF_VALUE a
            where not exists (select * from cc.offer_ver b where a.offer_ver_id = b.offer_ver_id) and a.offer_ver_id is not null and a.offer_ver_id <> -1 and a.state != 'X'"

    RefValue_No_PriceId:
        sql:
            "select *
             from cc.REF_VALUE a
            where not exists (select * from cc.price b where a.price_id = b.price_id)
              and not exists
            (select * from cc.event_benefit b where a.price_id = b.price_id)
              and not exists (select * from cc.acm b where a.price_id = b.price_id)
              and a.price_id is not null
              and a.state='A'
              and a.price_id<>999999"

    RefValue_No_RatePlanId:
        sql:
            "select *
             from cc.REF_VALUE a
            where not exists
            (select 1 from cc.rate_plan b where a.rate_plan_id = b.rate_plan_id)
              and a.rate_plan_id != -1
              and a.state != 'X'"

    RefValueToOfferVer_No_OfferVerId:
        sql:
            "select *
            from cc.REF_VALUE_TO_OFFER_VER a
            where not exists (select 1 from cc.offer_ver b where a.offer_ver_id = b.offer_ver_id)"

    RefValueToOfferVer_NoUse_RefValue:
        sql:
            "select *
              from cc.ref_value_to_offer_ver a
             where not exists (select *
                      from cc.REF_VALUE b, cc.rate_plan_mapping c
                     where a.ref_value_id = b.ref_value_id
                       and b.rate_plan_id = c.rate_plan_id
                       and a.offer_ver_id = c.offer_ver_id)
               and a.offer_ver_id <> -1"

    RefValueToOfferVer_MissSomeData:
        sql:
            "select * from cc.ref_value c, cc.rate_plan_mapping d
            where exists (select 1 from cc.rate_plan d where c.rate_plan_id = d.rate_plan_id and d.template_flag = 'Y')
              and not exists (
            select * from cc.rate_plan_mapping a, cc.ref_value_to_offer_ver b
            where a.offer_ver_id = b.offer_ver_id
              and a.offer_ver_id <> -1
              and c.ref_value_id = b.ref_value_id
              and c.rate_plan_id = a.rate_plan_id)
              and c.rate_plan_id <> -1
              and c.rate_plan_id = d.rate_plan_id
              and d.offer_ver_id <> -1"

    RePricePlan_No_RatePlanMapping:
        sql:
            "select * from cc.re_price_plan a
            where not exists (select 1 from cc.rate_plan_mapping b where a.offer_ver_id = b.offer_ver_id and a.re_id = b.re_id) and a.offer_ver_id != -1"

    ScriptTemplet_No_Catalog:
        sql:
            "select * from cc.script_templet a
            where not exists (select * from cc.script_templet_catalog_element b where a.script_templet_id = b.script_templet_id)"

    SortRule_Not_Output_Re_Have_Tariff:
        sql:
      # add by fangyueming 检查配置了资费，但是没有分拣的
            "select distinct rpp.re_id, r.re_name
                  from cc.re_price_plan rpp, cc.re r, cc.offer_ver ov, cc.offer o
                 where rpp.re_id = r.re_id
                   and r.re_type = '1'
                   and not exists (select ba.param1
                          from cc.def_re_attr dra, cc.bwf_action ba
                         where ba.param1 = rpp.re_id
                           and dra.def_re_attr = '21'
                           and dra.re_attr = ba.src_re_attr
                           and ba.function = 'assign')
                   and rpp.offer_ver_id = ov.offer_ver_id
                   and ov.offer_id = o.offer_id
                   and o.offer_id > 0"

    SortRule_OutputRe_No_Reserve:
        sql:
            "select f.workflow_name, a.PARAM1 as re_id, c.RE_NAME,d.sort_rule_name, e.NODE_NAME
                          from cc.bwf_action   a,
                               cc.def_re_attr  b,
                               cc.re           c,
                               cc.bwf_step     d,
                               cc.bwf_node     e,
                               cc.bwf_workflow f
                         where a.src_re_attr = a.obj_re_attr
                           and a.src_re_attr = b.re_attr
                           and b.def_re_attr = 21
                           and a.PARAM1 = TO_CHAR(c.re_id)
                           and a.PARAM1 not in (select re_id from cc.reserve_policy)
                           and a.step_id = d.STEP_ID
                           and d.NODE_ID = e.NODE_ID
                           and e.workflow_id = f.workflow_id
                           and f.workflow_type in ('A','B')
                           and a.param1 not in ('900','972','973')"

    TempletAcm_No_Use:
        sql:
            "select * from cc.acm a, cc.price_ver b
            where not exists (select 1 from cc.acm c where a.price_id = c.src_price_id) and a.price_ver_id = b.price_ver_id and b.rate_plan_id is null"

    TempletAcmAcctItem_RefValue_Error:
        sql:
            "select *
              from cc.acm a, cc.ref_value b, cc.price_ver c
             where a.price_ver_id = c.price_ver_id
               and c.rate_plan_id is null
               and a.ref_value_id = b.ref_value_id
               and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"

    TempletAcmValue_RefValue_Error:
        sql:
            "select *
              from cc.acm a, cc.ref_value b, cc.price_ver c
             where a.price_ver_id = c.price_ver_id
               and c.rate_plan_id is null
               and a.value = b.ref_value_id
               and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"

    TempletEventBenefit_No_Use:
        sql:
            "select * from cc.event_benefit a
            where not exists (select 1 from cc.event_benefit b where a.price_id = b.src_price_id) and a.price_ver_id is null"

    TempletEventBenefit_RefValue_Error:
        sql:
            "select *
              from cc.event_benefit a, cc.ref_value b
             where a.price_ver_id is null
               and a.value = b.ref_value_id
               and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"

    TempletPrice_No_Use:
        sql:
            "select * from cc.price a
            where not exists (select * from cc.price b where a.price_id = b.src_price_id) and a.price_ver_id is null"

    TempletPriceValue_RefValue_Error:
        sql:
            "select *
              from cc.price a, cc.ref_value b
             where a.price_ver_id is null
               and a.value = b.ref_value_id
               and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"

    TemplateRatePlan_No_Use:
        sql:
            "select * from cc.rate_plan_mapping a
            where not exists (select * from cc.rate_plan_mapping b where a.rate_plan_id = b.rate_plan_id and b.offer_ver_id != -1) and a.offer_ver_id = -1"

    Zone_same_zone_id_multiple_value:
        sql:
        # 一个value 在同一个zone_item中出现，数据冗余，无功能错误:
            "select a.zone_map_name , b.zone_name, c.value
         from cc.zone_map a, cc.zone b, cc.zone_value c
         where a.zone_map_id=b.zone_map_id
         and b.zone_id=c.zone_id
         and c.zone_id  in (select zone_id from (select zone_id,value,count(1) from cc.zone_value d group by zone_id,value having count(1)>1))
         and c.value in (select value from (select zone_id,value,count(1) from cc.zone_value d group by zone_id,value having count(1)>1))
         order by c.value"

ErrorData:
    AcctItem_No_Define_ErrorData:
        sql:
            "select *
                     from cc.offer a, cc.offer_ver b,cc.rate_plan c,cc.price_ver d, cc.price e, cc.ref_value f
                     where a.offer_type=4
                     and a.offer_id=b.offer_id
                     and b.offer_ver_id=c.offer_ver_id
                     and c.rate_plan_id=d.rate_plan_id
                     and d.price_ver_id=e.price_ver_id
                     and e.PRICE_ID = f.ref_value_id
                     and f.ref_value_type ='8'
                     and not exists (select 1 from cc.acct_item_type g where f.value_string = g.acct_item_type_id)"

    AcmAcctItem_RefValueId_NotExists:
        sql:
            "select * from cc.acm a
            where not exists (select * from cc.ref_value b where a.ref_value_id = b.ref_value_id)"

    AcmValue_RefValueId_NotExists:
        sql:
            "select * from cc.acm a
            where not exists (select * from cc.ref_value b where a.value = b.ref_value_id)"

    BenefitValue_RefValueId_NotExists:
        sql:
            "select * from cc.event_benefit a
            where not exists (select * from cc.ref_value b where a.value = b.ref_value_id)"

    IndepProdSpec_No_Migration:
        sql:
            "select b.cond_group_id,b.operand,d.sort_rule_name, e.NODE_NAME, f.workflow_name
             from cc.bwf_action   a,
                  cc.bwf_cond     b,
                  cc.bwf_cond_group c,
                  cc.bwf_step     d,
                  cc.bwf_node     e,
                  cc.bwf_workflow f
            where  a.step_id = d.STEP_ID
              and d.NODE_ID = e.NODE_ID
              and b.cond_group_id=c.cond_group_id
              and c.step_id=d.step_id
              and e.workflow_id = f.workflow_id
              and b.function = 'GetIndepProdSpecId'
              and b.operand is not null
              and not exists (select 1
                     from cc.indep_prod_spec bb
                    where b.operand = bb.indep_prod_spec_id)
              and e.workflow_id in (1001, 1002, 110066, 110083)"

    IndepProdSpec_No_Migration_Zone:
        sql:
            "select g.zone_id,g.value,d.sort_rule_name, e.NODE_NAME, f.workflow_name
                 from cc.bwf_action   a,
                      cc.bwf_cond     b,
                      cc.bwf_cond_group c,
                      cc.bwf_step     d,
                      cc.bwf_node     e,
                      cc.bwf_workflow f,
                      cc.zone_value   g
                where  a.step_id = d.STEP_ID
                  and d.NODE_ID = e.NODE_ID
                  and b.cond_group_id=c.cond_group_id
                  and c.step_id=d.step_id
                  and e.workflow_id = f.workflow_id
                  and b.function = 'GetIndepProdSpecId'
                  and b.zone_id=g.zone_id
                  and not exists (select 1
                         from cc.indep_prod_spec bb
                        where g.value = bb.indep_prod_spec_id)
                  and e.workflow_id in (1001, 1002, 110066, 110083)"

    OneACMPriceTemplet_Mapping_Muti_Re:
        sql:
            "select distinct d.rate_plan_id, d.rate_plan_name, b.price_id, b.acm_name
                  from cc.price_template_mapping_re a, cc.acm b, cc.price_ver c, cc.rate_plan d
                 where a.price_id = b.src_price_id
                   and b.price_ver_id = c.price_ver_id
                   and c.rate_plan_id = d.rate_plan_id
                   and a.re_id <> d.re_id"

    OneBenefitPriceTemplet_Mapping_Muti_Re:
        sql:
            "select distinct d.rate_plan_id, d.rate_plan_name, b.price_id, b.price_name
                  from cc.price_template_mapping_re a, cc.event_benefit b, cc.price_ver c, cc.rate_plan d
                 where a.price_id = b.src_price_id
                   and b.price_ver_id = c.price_ver_id
                   and c.rate_plan_id = d.rate_plan_id
                   and a.re_id <> d.re_id"

    OneRatePlan_Mapping_Muti_Re:
        sql:
            "select a.rate_plan_id
            from (select distinct re_id, rate_plan_id from cc.rate_plan_mapping) a group by a.rate_plan_id having count(1)>1"

    OneScriptTemplet_Mapping_Muti_ReType:
        sql:
            "select script_templet_id from (
                select distinct temp.script_templet_id, decode(d.re_type, 3, 3, 1)
                    from (select 'UP_RULE' table_name, price_id, price_ver_id, script_templet_id
                            from cc.up_rule, cc.price
                           where up_id = price_id
                          union
                          select 'OP' table_name, price_id, price_ver_id, script_templet_id
                            from cc.op, cc.price
                           where op_id = price_id
                          union
                          select 'RP' table_name, price_id, price_ver_id, script_templet_id
                            from cc.rp, cc.price
                           where rp_id = price_id
                          union
                          select 'EVENT_BENEFIT' table_name, price_id, price_ver_id, script_templet_id
                            from cc.event_benefit
                          union
                          select 'ACM_RULE' table_name, b.price_id,b.price_ver_id, script_templet_id
                            from cc.acm_rule a, cc.acm b
                           where a.price_ver_id = b.price_ver_id) temp, cc.price_ver b, cc.rate_plan c, cc.re d
              where temp.price_ver_id = b.price_ver_id
                AND b.rate_plan_id = c.rate_plan_id
                AND c.re_id = d.re_id
                and temp.script_templet_id is not null) t
              group by t.script_templet_id
              having count(1) > 1"

    PriceValue_RefValueId_NotExists:
        sql:
            "select * from cc.price a
            where not exists (select * from cc.ref_value b where a.value = b.ref_value_id)"

    ProdSpec_No_Migration:
        sql:
            "SELECT a.*
                  FROM cc.bwf_cond a
                 where function in ('GetProdStateByNumAndProdSpecID', 'judgedependprod')
                   and a.param1 is not null
                   and not exists (select 1
                          from cc.offer b
                         where a.param1 = b.offer_id
                           and b.offer_type in (2, 3))"

    RatePlan_OfferVer_Re_Err:
        sql:
            "select t.*, t1.*
                      from cc.rate_plan_mapping t,
                           (select *
                              from cc.rate_plan a
                             where not exists (select *
                                      from cc.rate_plan_mapping b
                                     where a.re_id = b.re_id
                                       and a.offer_ver_id = b.offer_ver_id
                                       and a.rate_plan_id = b.rate_plan_id)
                               and a.rate_plan_id <> -1) t1
                     where t.offer_ver_id = t1.offer_ver_id
                       and t.re_id = t1.re_id
                       and not exists (select *
                              from cc.rate_plan c
                             where t.offer_ver_id = c.offer_ver_id
                               and t.rate_plan_id = c.rate_plan_id
                               and t.re_id = c.re_id)
                     order by t.offer_ver_id, t.re_id, t.rate_plan_id"

    ReReserve_Policy_No_Limit:
        sql:
            "select f.workflow_name, a.PARAM1 as re_id, c.RE_NAME,d.sort_rule_name, e.NODE_NAME
                from cc.bwf_action   a,
                cc.def_re_attr  b,
                cc.re           c,
                cc.bwf_step     d,
                cc.bwf_node     e,
                cc.bwf_workflow f
                where a.src_re_attr = a.obj_re_attr
                and a.src_re_attr = b.re_attr
                and b.def_re_attr = 21
                and a.PARAM1 = TO_CHAR(c.re_id)
                and a.PARAM1  in (select re_id from cc.reserve_policy)
                and a.step_id = d.STEP_ID
                and d.NODE_ID = e.NODE_ID
                and e.workflow_id = f.workflow_id
                and f.workflow_type in ('A','B')
                and a.param1 not in ('900','972','973')
                and not exists (select 1 from cc.reserve_limit b where b.re_id=a.param1 )"

    SortRule_OutputRe_No_Tariff:
        sql:
          "select a.PARAM1, c.RE_NAME,d.sort_rule_name, e.NODE_NAME, f.workflow_name
                 from cc.bwf_action   a,
                      cc.def_re_attr  b,
                      cc.re           c,
                      cc.bwf_step     d,
                      cc.bwf_node     e,
                      cc.bwf_workflow f
                where a.src_re_attr = a.obj_re_attr
                  and a.src_re_attr = b.re_attr
                  and b.def_re_attr = 21
                  and a.PARAM1 = TO_CHAR(c.re_id)
                  and a.PARAM1 not in (select re_id from cc.re_price_plan)
                  and a.step_id = d.STEP_ID
                  and d.NODE_ID = e.NODE_ID
                  and e.workflow_id = f.workflow_id
                  and a.param1 not in ('900','972','973')
                  /*and e.workflow_id in (1001, 1002, 110066, 110083)*/"

    TemplateRatePlan_No_RatePlanMapping:
        sql:
            "select * from cc.rate_plan a
            where a.template_flag = 'Y'
            and not exists (select 1 from cc.rate_plan_mapping b where a.rate_plan_id = b.rate_plan_id and a.re_id = b.re_id and b.offer_ver_id = -1)
            and a.rate_plan_id <> -1"

    TemplateRatePlan_OfferVerId_Error:
        sql:
            "select * from cc.rate_plan a
            where a.template_flag = 'Y' and a.offer_ver_id <> -1"

    The re_attr of reservation rule is different with the re_attr configured in price plan:
        sql:
          #使用批价单位是次，但是批价的值是多次，比如每60次计费多少，这个基本确定是配置问题 add by fangyueming
            "select a.offer_name,h.re_name,e.price_name
                        from cc.offer a,cc.offer_ver b,cc.rate_plan c,cc.price_ver d,cc.price e,cc.re_attr f,cc.def_re_attr g,cc.re h
                        where a.offer_id=b.offer_id
                          and b.offer_ver_id=c.offer_ver_id
                          and c.rate_plan_id=d.rate_plan_id
                          and d.price_ver_id=e.price_ver_id
                          and e.re_attr=f.re_attr
                          and f.re_attr=g.re_attr
                          and c.re_id=h.re_id
                          and g.def_re_attr=74
                          and e.rum>1
                          and (b.exp_date is null or b.exp_date > sysdate)
                          and (d.exp_date is null or d.exp_date > sysdate)"

    ZoneId_No_Migration:
        sql:
            "SELECT * FROM cc.bwf_cond a
            where function='GetIndepProdSpecId' and a.zone_id is not null
            and not exists (select 1 from cc.zone b where a.zone_id = b.zone_id)"

    Zone Same zone value exists in different zone:
        sql:
            "select d.zone_map_id,d.zone_map_name,d.value from (
            select c.zone_map_id,c.zone_map_name,a.zone_id,a.zone_name,b.value from cc.zone a,cc.zone_value b,cc.zone_map c
            where a.zone_id=b.zone_id
            and a.zone_map_id=c.zone_map_id ) d
            group by d.zone_map_id,d.zone_map_name,d.value
            having count(1)>1"
