UserList:
  cc

BadData:
    AcctItem_No_Define:
      sql:
        "select *
              from ref_value a
             where a.ref_value_type = '8'
               and not exists (select 1
                      from acct_item_type b
                     where a.value_string = b.acct_item_type_id)"
    AcmAcctItem_RefValue_Error:
      sql:
        "select *
          from acm a, price_ver b, rate_plan c, ref_value d
         where a.price_ver_id = b.price_ver_id
           and b.rate_plan_id = c.rate_plan_id
           and a.ref_value_id = d.ref_value_id
           and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"
    AcmTemplet_No_Catalog:
      sql:
        "select * from acm a, price_ver c where a.template_flag = 'Y' and not exists (select * from price_catalog_element b where a.price_id = b.price_id) and a.price_ver_id = c.price_ver_id and c.rate_plan_id is null"
    AcmValue_RefValue_Error:
      sql:
        "select *
          from acm a, price_ver b, rate_plan c, ref_value d
         where a.price_ver_id = b.price_ver_id
           and b.rate_plan_id = c.rate_plan_id
           and a.value = d.ref_value_id
           and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"
    BenefitTemplet_No_Catalog:
      sql:
        "select * from event_benefit a where a.template_flag = 'Y' and not exists (select * from price_catalog_element b where a.price_id = b.price_id) and a.price_ver_id is null"
    EventBenefit_RefValue_Error:
      sql:
        "select *
          from event_benefit a, price_ver b, rate_plan c, ref_value d
         where a.price_ver_id = b.price_ver_id
           and b.rate_plan_id = c.rate_plan_id
           and a.value = d.ref_value_id
           and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"
    Offer_Exists_Multi_offerGroup_Under_Same_SubsPlan:
      sql:
        "select count(1),
                pr.offer_id,
                pr.offer_name,
                pr.offer_type,
                sp.offer_id   subs_plan_id,
                sp.offer_name subs_plan
           from offer_group_mem        ogm,
                offer                  pr,
                offer_group            og,
                subs_plan_offer_select spos,
                offer_ver              ov,
                offer                  sp
          where ogm.offer_id = pr.offer_id
            and pr.state = 'A'
            and ogm.offer_group_id = og.offer_group_id
            and ogm.offer_group_id = spos.offer_group_id
            and spos.offer_ver_id = ov.offer_ver_id
            and ov.offer_id = sp.offer_id
            and sp.state = 'A'
          group by pr.offer_id, pr.offer_name,pr.offer_type, sp.offer_id, sp.offer_name
         having count(1) > 1"
    Price_and_RatePlan_Re_NotMatch:
      sql:
      # 检查资费模板和真正的资费的对应的事件是否一致
        "select f.offer_name, g.re_name, d.rate_plan_name, a.price_id, b.price_name
                   from price_template_mapping_re a, price b, price_ver c, rate_plan d, offer_ver e, offer f,re g
                  where ((a.price_id = b.price_id and b.template_flag = 'Y') or
                        (a.price_id = b.src_price_id and b.template_flag = 'N'))
                    and b.price_ver_id = c.price_ver_id
                    and c.rate_plan_id = d.rate_plan_id
                    and a.re_id <> d.re_id
                    and d.offer_ver_id=e.offer_ver_id
                    and e.offer_id=f.offer_id
                    and d.re_id=g.re_id"
    PricePlan_No_Offer:
      sql:
        "select * from price_plan a where not exists (select 1 from offer b where a.price_plan_id = b.offer_id and b.offer_type = 4)"
    PricePlan_Offer_No_Price_Plan:
      sql:
        "select * from offer a where not exists (select 1 from price_plan b where b.price_plan_id = a.offer_id) and a.offer_type = 4"
    PricePlan_Re_No_Reserve:
      sql:
        "select distinct d.offer_id, d.offer_name, e.rate_plan_name, b.re_name
          from rate_plan_mapping a, re b, offer_ver c, offer d, rate_plan e
         where a.re_id = b.re_id
           and b.re_type = '1'
           and a.offer_ver_id = c.offer_ver_id
           and (c.exp_date > sysdate or c.exp_date is null)
           and c.offer_id = d.offer_id
           and a.rate_plan_id = e.rate_plan_id
           and e.rate_plan_type = 1
           and not exists
         (select 1 from reserve_policy c1 where a.re_id = c1.re_id)
           and not exists
         (select 1 from RESERVE_POLICY_PROD_SPEC c1 where a.re_id = c1.re_id)
           and upper(b.re_name) not like '%%SMS%%'
           and upper(b.re_name) not like '%%MMS%%'"
    PriceAcctItem_RefValue_Error:
      sql:
        "select *
          from price a, price_ver b, rate_plan c, ref_value d
         where a.price_ver_id = b.price_ver_id
           and b.rate_plan_id = c.rate_plan_id
           and a.acct_item_type_id_param = d.ref_value_id
           and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"
    PriceTemplate_No_Catalog:
      sql:
        "select * from price a where a.template_flag = 'Y' and not exists (select * from price_catalog_element b where a.price_id = b.price_id) and a.price_ver_id is null"
    PriceTemplate_One_Mapping_Multi_Re:
      # 一个模板被多个Rate_plan所引用，但是Re_id不一样
      sql:
        "select distinct d.rate_plan_id, d.rate_plan_name, b.price_id, b.price_name
         from price_template_mapping_re a, price b, price_ver c, rate_plan d , re e
         where a.price_id = b.src_price_id
         and b.price_ver_id = c.price_ver_id
         and c.rate_plan_id = d.rate_plan_id
         and d.re_id = e.re_id
         and e.re_type <>'9'
         and a.re_id <> d.re_id"
    PriceValue_RefValue_Error:
      sql:
        "select *
          from price a, price_ver b, rate_plan c, ref_value d
         where a.price_ver_id = b.price_ver_id
           and b.rate_plan_id = c.rate_plan_id
           and a.value = d.ref_value_id
           and (a.price_id <> d.price_id or c.rate_plan_id <> d.rate_plan_id or c.offer_ver_id <> d.offer_ver_id)"
    PriceVer_No_Use:
      sql:
        "select *
          from price_ver a
         where not exists (select * from price b where a.price_ver_id = b.price_ver_id)
           and not exists (select * from event_benefit b where a.price_ver_id = b.price_ver_id)
           and not exists (select * from acm b where a.price_ver_id = b.price_ver_id)
           and (a.exp_date is null or a.exp_date > sysdate)"
    RatePlan_No_PriceVer:
      sql:
        "select r.re_name,d.offer_name,d.offer_id,a.*
              from rate_plan a,re r,offer_ver c,offer d, rate_plan_mapping e
             where not exists
             (select * from price_ver b where a.rate_plan_id = b.rate_plan_id)
               and a.rate_plan_id <> -1
             and a.re_id=r.re_id
             and a.re_id = e.re_id
             and a.rate_plan_id = e.rate_plan_id
             and e.offer_ver_id = c.offer_ver_id
             and (d.state = 'A' or d.state is null)
             and c.offer_id=d.offer_id
             order by a.offer_ver_id"
    #        "select * from rate_plan a where not exists (select * from price_ver b where a.rate_plan_id = b.rate_plan_id) and a.rate_plan_id <> -1"
    RatePlanTemplet_No_Catalog:
      sql:
        "select * from rate_plan a where a.template_flag = 'Y'and a.rate_plan_id <> -1 and not exists (select 1 from rate_plan_catalog_element b where a.rate_plan_id = b.rate_plan_id)"
    RefValue_No_OfferVerId:
      sql:
        "select *
				  from REF_VALUE a
				 where not exists
				 (select * from offer_ver b where a.offer_ver_id = b.offer_ver_id)
				   and a.offer_ver_id is not null
				   and a.offer_ver_id <> -1
				   and a.state != 'X'"
    RefValue_No_PriceId:
      sql:
        "select *
         from REF_VALUE a
        where not exists (select * from price b where a.price_id = b.price_id)
          and not exists
        (select * from event_benefit b where a.price_id = b.price_id)
          and not exists (select * from acm b where a.price_id = b.price_id)
          and a.price_id is not null
          and a.state='A'
          and a.price_id<>999999"
    RefValue_No_RatePlanId:
      sql:
        "select *
				  from REF_VALUE a
				 where not exists
				 (select 1 from rate_plan b where a.rate_plan_id = b.rate_plan_id)
				   and a.rate_plan_id != -1
				   and a.state != 'X'"
    RefValueToOfferVer_No_OfferVerId:
      sql:
        "select * from REF_VALUE_TO_OFFER_VER a where not exists (select 1 from offer_ver b where a.offer_ver_id = b.offer_ver_id)"
    RefValueToOfferVer_NoUse_RefValue:
      sql:
        "select *
          from ref_value_to_offer_ver a
         where not exists (select *
                  from REF_VALUE b, rate_plan_mapping c
                 where a.ref_value_id = b.ref_value_id
                   and b.rate_plan_id = c.rate_plan_id
                   and a.offer_ver_id = c.offer_ver_id)
           and a.offer_ver_id <> -1
           and not exists (select 1 from REF_VALUE b where b.ref_value_id = a.ref_value_id and b.rate_plan_id is null)"
    RefValueToOfferVer_MissSomeData:
      sql:
        "select * from ref_value c, rate_plan_mapping d
        where exists (select 1 from rate_plan d where c.rate_plan_id = d.rate_plan_id and d.template_flag = 'Y')
          and not exists (
        select * from rate_plan_mapping a, ref_value_to_offer_ver b
        where a.offer_ver_id = b.offer_ver_id
          and a.offer_ver_id <> -1
          and c.ref_value_id = b.ref_value_id
          and c.rate_plan_id = a.rate_plan_id)
          and c.rate_plan_id <> -1
          and c.rate_plan_id = d.rate_plan_id
          and d.offer_ver_id <> -1"
    RePricePlan_No_RatePlanMapping:
      sql:
        "select * from re_price_plan a where not exists (select 1 from rate_plan_mapping b where a.offer_ver_id = b.offer_ver_id and a.re_id = b.re_id) and a.offer_ver_id != -1"
    ScriptTemplet_No_Catalog:
      sql:
        "select * from script_templet a where not exists (select * from script_templet_catalog_element b where a.script_templet_id = b.script_templet_id)"
    SortRule_Not_Output_Re_Have_Tariff:
      sql:
      # add by fangyueming 检查配置了资费，但是没有分拣的
        "select distinct rpp.re_id, r.re_name
                  from re_price_plan rpp, re r, offer_ver ov, offer o
                 where rpp.re_id = r.re_id
                   and r.re_type = '1'
                   and not exists (select ba.param1
                          from def_re_attr dra, bwf_action ba
                         where ba.param1 = rpp.re_id
                           and dra.def_re_attr = '21'
                           and dra.re_attr = ba.src_re_attr
                           and ba.function = 'assign')
                   and rpp.offer_ver_id = ov.offer_ver_id
                   and ov.offer_id = o.offer_id
                   and o.offer_id > 0"
    TempletAcm_No_Use:
      sql:
        "select * from acm a, price_ver b where not exists (select 1 from acm c where a.price_id = c.src_price_id) and a.price_ver_id = b.price_ver_id and b.rate_plan_id is null"
    TempletAcmAcctItem_RefValue_Error:
      sql:
        "select *
          from acm a, ref_value b, price_ver c
         where a.price_ver_id = c.price_ver_id
           and c.rate_plan_id is null
           and a.ref_value_id = b.ref_value_id
           and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"
    TempletAcmValue_RefValue_Error:
      sql:
        "select *
          from acm a, ref_value b, price_ver c
         where a.price_ver_id = c.price_ver_id
           and c.rate_plan_id is null
           and a.value = b.ref_value_id
           and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"
    TempletEventBenefit_No_Use:
      sql:
        "select * from event_benefit a where not exists (select 1 from event_benefit b where a.price_id = b.src_price_id) and a.price_ver_id is null"
    TempletEventBenefit_RefValue_Error:
      sql:
        "select *
          from event_benefit a, ref_value b
         where a.price_ver_id is null
           and a.value = b.ref_value_id
           and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"
    TempletPrice_No_Use:
      sql:
        "select * from price a where not exists (select * from price b where a.price_id = b.src_price_id) and a.price_ver_id is null"
    TempletPriceAcctItem_RefValue_Error:
      sql:
        "select *
          from price a, ref_value b
         where a.price_ver_id is null
           and a.acct_item_type_id_param = b.ref_value_id
           and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"
    TempletPriceValue_RefValue_Error:
      sql:
        "select *
          from price a, ref_value b
         where a.price_ver_id is null
           and a.value = b.ref_value_id
           and (a.price_id <> b.price_id or b.rate_plan_id <> -1 or b.offer_ver_id <> -1)"
    TemplateRatePlan_No_Use:
      sql:
        "select * from rate_plan a where not exists (select 1 from rate_plan_mapping b where a.rate_plan_id = b.rate_plan_id and b.offer_ver_id != -1) and a.offer_ver_id = -1"
    Zone_same_zone_id_multiple_value:
      sql:
        # 一个value 在同一个zone_item中出现，数据冗余，无功能错误:
        "select a.zone_map_name , b.zone_name, c.value
            from zone_map a, zone b, zone_value c
            where a.zone_map_id=b.zone_map_id
            and b.zone_id=c.zone_id
            and c.zone_id  in (select zone_id from (select zone_id,value,count(1) from zone_value d group by zone_id,value having count(1)>1))
            and c.value in (select value from (select zone_id,value,count(1) from zone_value d group by zone_id,value having count(1)>1))
            order by c.value"
    Usage_price_used_res_type_not_exists_in_OTC:
      sql:
        # 资费中使用的账本，是否都在赠送中有了，赠送需要考虑一次性和租费
        "SELECT *
          FROM (SELECT a3.acct_res_id,
                       a8.offer_name,
                       a6.re_name,
                       a9.rate_plan_name,
                       a.price_name
                  FROM price             a,
                       ref_value         a1,
                       acct_item_type    a3,
                       price_ver         a4,
                       rate_plan_mapping a5,
                       re                a6,
                       offer_ver         a7,
                       offer             a8,
                       rate_plan         a9
                 where a.acct_item_type_id_param = a1.ref_value_id
                   and a1.value_string = a3.acct_item_type_id
                   and a.price_ver_id = a4.price_ver_id
                   and a4.rate_plan_id = a5.rate_plan_id
                   and a5.re_id = a6.re_id
                   and a5.offer_ver_id = a7.offer_ver_id
                   and a7.offer_id = a8.offer_id
                   and a5.rate_plan_id = a9.rate_plan_id
                   and a5.re_id = a9.re_id
                   and a8.offer_id > 0
                   and (a4.exp_date is null or a4.exp_date > sysdate)
                   and (a7.exp_date is null or a7.exp_date > sysdate)
                union
                SELECT aa3.acct_res_id,
                       aa8.offer_name,
                       aa6.re_name,
                       aa9.rate_plan_name,
                       aa.price_name
                  FROM price             aa,
                       acct_item_type    aa3,
                       price_ver         aa4,
                       rate_plan_mapping aa5,
                       re                aa6,
                       offer_ver         aa7,
                       offer             aa8,
                       rate_plan         aa9
                 where aa.acct_item_type_id = aa3.acct_item_type_id
                   and aa.price_ver_id = aa4.price_ver_id
                   and aa4.rate_plan_id = aa5.rate_plan_id
                   and aa5.re_id = aa6.re_id
                   and aa5.offer_ver_id = aa7.offer_ver_id
                   and aa7.offer_id = aa8.offer_id
                   and aa5.rate_plan_id = aa9.rate_plan_id
                   and aa5.re_id = aa9.re_id
                   and aa8.offer_id > 0
                   and (aa4.exp_date is null or aa4.exp_date > sysdate)
                   and (aa7.exp_date is null or aa7.exp_date > sysdate)) ttt
         where ttt.acct_res_id not in
             (SELECT distinct t1.acct_res_id
                FROM event_benefit t, sub_bal_type t1
               where t.sub_bal_type_id = t1.sub_bal_type_id)
           and ttt.acct_res_id <> '1'"

ErrorData:
    AcctItem_No_Define_ErrorData:
      sql:
        "select *
         from offer a, offer_ver b,rate_plan c,price_ver d, price e, ref_value f
         where a.offer_type=4
         and a.offer_id=b.offer_id
         and b.offer_ver_id=c.offer_ver_id
         and c.rate_plan_id=d.rate_plan_id
         and d.price_ver_id=e.price_ver_id
         and e.PRICE_ID = f.ref_value_id
         and f.ref_value_type ='8'
         and not exists (select 1 from acct_item_type g where f.value_string = g.acct_item_type_id)"
    AcmAcctItem_RefValueId_NotExists:
      sql:
        "select * from acm a where not exists (select * from ref_value b where a.ref_value_id = b.ref_value_id)"
    AcmValue_RefValueId_NotExists:
      sql:
        "select * from acm a where not exists (select * from ref_value b where a.value = b.ref_value_id)"
    Benefit_HaveNo_python_configured_PositiveValue:
      sql:
        "select o.offer_id,
            o.offer_name,
            rp.rate_plan_name,
            eb.price_name,
            rv.ref_value_id,
            rv.value_string
            from offer         o,
            offer_ver     ov,
            rate_plan     rp,
            price_ver     pv,
            event_benefit eb,
            ref_value     rv
            where o.offer_id = ov.offer_id
            and ov.offer_ver_id = rp.offer_ver_id
            and rp.rate_plan_id = pv.rate_plan_id
            and rp.rate_plan_type = '3'
            and pv.price_ver_id = eb.price_ver_id
            and eb.value = rv.ref_value_id
            and to_char(eb.rule_script) is null
            and rv.value_string > 0"
    BenefitValue_RefValueId_NotExists:
      sql:
        "select * from event_benefit a where not exists (select * from ref_value b where a.value = b.ref_value_id)"

    CycleOffer_re_HaveNo_SortRecurring:
      sql:
        "select o.offer_id, o.offer_name, re.re_id, re.re_name
           from offer o, offer_ver ov, re_price_plan rpp, re re
          where o.offer_id = ov.offer_id
            and ov.offer_ver_id = rpp.offer_ver_id
            and rpp.re_id = re.re_id
            and re.re_type in('9','2')
            and not exists
          (select * from sort_recurring sr where sr.re_id = re.re_id)"
    DEFAULT_OFFER_GROUP-PRICEP_PLAN_TYPE-ERROR:
      sql:
        "select og.*
          from offer_group og, offer_group_mem ogm, subs_price_plan spp
         where og.offer_group_type = '6'
           and og.offer_group_id = ogm.offer_group_id
           and ogm.offer_id = spp.price_plan_id
           and spp.price_plan_type != '2'"

    discount_obj_acctitemtype_not_parent_id_and_refvaluestring:
      sql:
        "select o.offer_id,o.offer_name,dp.dp_id,dp.dp_name,d.acct_item_type_id,a.acct_item_type_name
        from offer o,offer_ver ov,dp dp,tab_dp td,disct_obj_aitid d, acct_item_type a
        where o.offer_id=ov.offer_id
        and ov.offer_ver_id=dp.offer_ver_id
        and dp.dp_id=td.dp_id
        and td.ref_disct_obj_id=d.disct_obj_id
        and d.acct_item_type_id = a.acct_item_type_id
        and not exists (select 1
        from ref_value r
        where r.ref_value_type = '8'
        and r.value_string = d.acct_item_type_id)
        and not exists
        (select 1
        from acct_item_type ap, acct_item_type ac
        where ap.acct_item_type_id = ac.parent_id
        and ap.acct_item_type_id = d.acct_item_type_id)"

    IndepProdSpec_No_Migration:
      sql:
        "select b.cond_group_id,b.operand,d.sort_rule_name, e.NODE_NAME, f.workflow_name
         from bwf_action   a,
              bwf_cond     b,
              bwf_cond_group c,
              bwf_step     d,
              bwf_node     e,
              bwf_workflow f
        where  a.step_id = d.STEP_ID
          and d.NODE_ID = e.NODE_ID
          and b.cond_group_id=c.cond_group_id
          and c.step_id=d.step_id
          and e.workflow_id = f.workflow_id
          and b.function = 'GetIndepProdSpecId'
          and b.operand is not null
          and not exists (select 1
                 from indep_prod_spec bb
                where b.operand = bb.indep_prod_spec_id)
          and e.workflow_id in (1001, 1002, 110066, 110083)"
    IndepProdSpec_No_Migration_Zone:
      sql:
        "select g.zone_id,g.value,d.sort_rule_name, e.NODE_NAME, f.workflow_name
             from bwf_action   a,
                  bwf_cond     b,
                  bwf_cond_group c,
                  bwf_step     d,
                  bwf_node     e,
                  bwf_workflow f,
                  zone_value   g
            where  a.step_id = d.STEP_ID
              and d.NODE_ID = e.NODE_ID
              and b.cond_group_id=c.cond_group_id
              and c.step_id=d.step_id
              and e.workflow_id = f.workflow_id
              and b.function = 'GetIndepProdSpecId'
              and b.zone_id=g.zone_id
              and not exists (select 1
                     from indep_prod_spec bb
                    where g.value = bb.indep_prod_spec_id)
              and e.workflow_id in (1001, 1002, 110066, 110083)"
    
    Mapping_Tariff_Duplicate2:
      sql:
        "select distinct a.rate_plan_id, m1.mapping_id
          from price_ver a, price b, mapping_unit m1, rate_plan_zone r1, mapping_unit m2, rate_plan_zone r2, ref_value e
         where a.price_ver_id = b.price_ver_id
           and (a.exp_date is null or a.exp_date > sysdate)
           and a.mapping_id = m1.mapping_id
           and a.rate_plan_id = r1.rate_plan_id
           and a.rate_plan_id = r2.rate_plan_id
           and b.acct_item_type_id_param = e.ref_value_id
           and m1.rate_plan_zone_id = r1.rate_plan_zone_id
           and m2.rate_plan_zone_id = r2.rate_plan_zone_id
           and r1.rate_plan_zone_id <> r2.rate_plan_zone_id
           and m1.mapping_id = m2.mapping_id
           and r1.mapping_des_value > r2.mapping_des_value
           and exists (select 1 from price_ver a1, price b1, mapping_unit m11, rate_plan_zone r11, mapping_unit m21, rate_plan_zone r21, ref_value e1
         where a1.price_ver_id = b1.price_ver_id
           and (a1.exp_date is null or a1.exp_date > sysdate)
           and a1.mapping_id = m11.mapping_id
           and a1.rate_plan_id = r11.rate_plan_id
           and a1.rate_plan_id = r21.rate_plan_id
           and b1.acct_item_type_id_param = e1.ref_value_id
           and m11.rate_plan_zone_id = r11.rate_plan_zone_id
           and m21.rate_plan_zone_id = r21.rate_plan_zone_id
           and r11.rate_plan_zone_id <> r21.rate_plan_zone_id
           and m11.mapping_id = m21.mapping_id
           and r11.mapping_des_value > r21.mapping_des_value
           and a.rate_plan_id = a1.rate_plan_id
           and e.value_string = e1.value_string
           and r1.mapping_des_value = r11.mapping_des_value
           and r2.mapping_des_value = r21.mapping_des_value
           and m1.mapping_value = m11.mapping_value
           and m2.mapping_value = m21.mapping_value
           and r1.mapping_src_value = r11.mapping_src_value
           and r2.mapping_src_value = r21.mapping_src_value
           and a.mapping_id != a1.mapping_id)"
    OFFER_CATG_MEM_DUPLICAT:
      sql:
        "select a.child_offer_catg_id
          from offer_catg_mem a
         where a.child_offer_catg_id is not null
          group by a.child_offer_catg_id having count(1)>1"
    Offer_VariableCycle_HaveNo_VariableCycle_Attr:
      sql:
        "select o.offer_id, o.offer_name
           from offer             o,
                offer_ver         ov,
                re_price_plan     rpp,
                re_pp_recurring   rpr,
                recurring_re_type rrt
          where o.offer_id = ov.offer_id
            and ov.offer_ver_id = rpp.offer_ver_id
            and rpp.re_id = rpr.re_id
            and rpr.recurring_re_type = rrt.recurring_re_type
            and rrt.recurring_re_type in ('5','6')
            and not exists
          (select oa.offer_id
                   from offer_attr oa
                  where oa.offer_id = o.offer_id
                    and oa.attr_id in
                        (select a.attr_id
                           from attr a
                          where a.attr_code in ('EXP_RENTAL_DAYS','EXP_RENTAL_TYPE')))"
    OneACMPriceTemplet_Mapping_Muti_Re:
      sql:
        "select distinct d.rate_plan_id, d.rate_plan_name, b.price_id, b.acm_name
              from price_template_mapping_re a, acm b, price_ver c, rate_plan d
             where a.price_id = b.src_price_id
               and b.price_ver_id = c.price_ver_id
               and c.rate_plan_id = d.rate_plan_id
               and a.re_id <> d.re_id"
    OneBenefitPriceTemplet_Mapping_Muti_Re:
      sql:
        "select distinct d.rate_plan_id, d.rate_plan_name, b.price_id, b.price_name
              from price_template_mapping_re a, event_benefit b, price_ver c, rate_plan d
             where a.price_id = b.src_price_id
               and b.price_ver_id = c.price_ver_id
               and c.rate_plan_id = d.rate_plan_id
               and a.re_id <> d.re_id"
    OneRatePlan_Mapping_Muti_Re:
      sql:
        "select a.rate_plan_id from (select distinct re_id, rate_plan_id from rate_plan_mapping) a group by a.rate_plan_id having count(1)>1"
    OneScriptTemplet_Mapping_Muti_ReType:
      sql:
        "select script_templet_id from (
            select distinct temp.script_templet_id, decode(d.re_type, '3', '3','C', 'C', '1')
                from (select 'UP_RULE' table_name, price_id, price_ver_id, script_templet_id
                        from up_rule, price
                       where up_id = price_id
                      union
                      select 'OP' table_name, price_id, price_ver_id, script_templet_id
                        from op, price
                       where op_id = price_id
                      union
                      select 'RP' table_name, price_id, price_ver_id, script_templet_id
                        from rp, price
                       where rp_id = price_id
                      union
                      select 'EVENT_BENEFIT' table_name, price_id, price_ver_id, script_templet_id
                        from event_benefit
                      union
                      select 'ACM_RULE' table_name, b.price_id,b.price_ver_id, script_templet_id
                        from acm_rule a, acm b
                       where a.price_ver_id = b.price_ver_id) temp, price_ver b, rate_plan c, re d
          where temp.price_ver_id = b.price_ver_id
            AND b.rate_plan_id = c.rate_plan_id
            AND c.re_id = d.re_id
            and temp.script_templet_id is not null) t
          group by t.script_templet_id
          having count(1) > 1"
    OTC/Rent_exists_res_not_use_in_usage_price:
      sql:
    # 赠送里面的账本，在资费中是否都已经使用了
        "SELECT distinct t1.acct_res_id,t4.offer_name,t4.offer_id,t6.re_name,t7.rate_plan_name,t.price_name
        FROM event_benefit t, sub_bal_type t1,rate_Plan_mapping t2,offer_ver t3,offer t4,price_ver t5,re t6,rate_plan t7
        where t.sub_bal_type_id = t1.sub_bal_type_id
        and t.price_ver_id=t5.price_ver_id
        and t5.rate_plan_id=t2.rate_plan_id
        and t2.offer_ver_id=t3.offer_ver_id
        and t2.re_id=t6.re_id
        and t3.offer_id=t4.offer_id
        and t2.rate_plan_id=t7.rate_plan_id
        and t2.re_id = t7.re_id
        and t1.acct_res_id not in
        (SELECT distinct a3.acct_res_id
        FROM price a, ref_value a1, acct_item_type a3
        where a.acct_item_type_id_param = a1.ref_value_id
        and a1.value_string = a3.acct_item_type_id
        union
        SELECT distinct a3.acct_res_id
        FROM price a, acct_item_type a3
        where a.acct_item_type_id= a3.acct_item_type_id )
        and t4.offer_id>0
        and (t5.exp_date is null or t5.exp_date > sysdate)
        and (t3.exp_date is null or t3.exp_date > sysdate)"
    Price_ChargeUnit_Occurrence:
      sql:
      #使用批价单位是次，但是批价的值是多次，比如每60次计费多少，这个基本确定是配置问题 add by fangyueming
        "select a.offer_name,h.re_name,e.price_name
                from offer a,offer_ver b,rate_plan c,price_ver d,price e,re_attr f,def_re_attr g,re h
                where a.offer_id=b.offer_id
                  and b.offer_ver_id=c.offer_ver_id
                  and c.rate_plan_id=d.rate_plan_id
                  and d.price_ver_id=e.price_ver_id
                  and e.re_attr=f.re_attr
                  and f.re_attr=g.re_attr
                  and c.re_id=h.re_id
                  and g.def_re_attr=74
                  and e.rum>1
                  and (b.exp_date is null or b.exp_date > sysdate)
                  and (d.exp_date is null or d.exp_date > sysdate)"
    PriceAcctItem_RefValueId_NotExists:
      sql:
        "select * from price a where not exists (select * from ref_value b where a.acct_item_type_id_param = b.ref_value_id) and acct_item_type_id_param is not null"
    PriceIdIsSameInEvent_benefitAndAcm:
      sql:
        "select e1.offer_id, e1.offer_name, f1.re_name, g1.rate_plan_name, a1.price_id,
               e2.offer_id, e2.offer_name, f2.re_name, g2.rate_plan_name, a2.price_name
           from acm               a1,
                event_benefit     a2,
                price_ver         b1,
                price_ver         b2,
                rate_plan_mapping c1,
                rate_plan_mapping c2,
                offer_ver         d1,
                offer_ver         d2,
                offer             e1,
                offer             e2,
                re                f1,
                re                f2,
                rate_plan         g1,
                rate_plan         g2
          where a1.price_id = a2.price_id
            and a1.price_ver_id = b1.price_ver_id
            and a2.price_ver_id = b2.price_ver_id
            and (b1.exp_date is null or b1.exp_date > sysdate)
            and (b2.exp_date is null or b2.exp_date > sysdate)
            and b1.rate_plan_id = c1.rate_plan_id
            and b2.rate_plan_id = c2.rate_plan_id
            and c1.offer_ver_id = d1.offer_ver_id
            and c2.offer_ver_id = d2.offer_ver_id
            and (d1.exp_date is null or d1.exp_date > sysdate)
            and (d2.exp_date is null or d2.exp_date > sysdate)
            and d1.offer_id = e1.offer_id
            and d2.offer_id = e2.offer_id
            and c1.re_id = f1.re_id
            and c2.re_id = f2.re_id
            and c1.rate_plan_id = g1.rate_plan_id
            and c2.rate_plan_id = g2.rate_plan_id"
    PriceIdIsSameInPriceAndAcm:
      sql:
        "select e1.offer_id, e1.offer_name, f1.re_name, g1.rate_plan_name, a1.price_name,
               e2.offer_id, e2.offer_name, f2.re_name, g2.rate_plan_name, a2.price_id
           from price             a1,
                acm               a2,
                price_ver         b1,
                price_ver         b2,
                rate_plan_mapping c1,
                rate_plan_mapping c2,
                offer_ver         d1,
                offer_ver         d2,
                offer             e1,
                offer             e2,
                re                f1,
                re                f2,
                rate_plan         g1,
                rate_plan         g2
          where a1.price_id = a2.price_id
            and a1.price_ver_id = b1.price_ver_id
            and a2.price_ver_id = b2.price_ver_id
            and (b1.exp_date is null or b1.exp_date > sysdate)
            and (b2.exp_date is null or b2.exp_date > sysdate)
            and b1.rate_plan_id = c1.rate_plan_id
            and b2.rate_plan_id = c2.rate_plan_id
            and c1.offer_ver_id = d1.offer_ver_id
            and c2.offer_ver_id = d2.offer_ver_id
            and (d1.exp_date is null or d1.exp_date > sysdate)
            and (d2.exp_date is null or d2.exp_date > sysdate)
            and d1.offer_id = e1.offer_id
            and d2.offer_id = e2.offer_id
            and c1.re_id = f1.re_id
            and c2.re_id = f2.re_id
            and c1.rate_plan_id = g1.rate_plan_id
            and c2.rate_plan_id = g2.rate_plan_id"
    PriceIdIsSameInPriceAndEvent_benefit:
      sql:
        "select e1.offer_id, e1.offer_name, f1.re_name, g1.rate_plan_name, a1.price_name,
               e2.offer_id, e2.offer_name, f2.re_name, g2.rate_plan_name, a2.price_name
           from price             a1,
                event_benefit     a2,
                price_ver         b1,
                price_ver         b2,
                rate_plan_mapping c1,
                rate_plan_mapping c2,
                offer_ver         d1,
                offer_ver         d2,
                offer             e1,
                offer             e2,
                re                f1,
                re                f2,
                rate_plan         g1,
                rate_plan         g2
          where a1.price_id = a2.price_id
            and a1.price_ver_id = b1.price_ver_id
            and a2.price_ver_id = b2.price_ver_id
            and (b1.exp_date is null or b1.exp_date > sysdate)
            and (b2.exp_date is null or b2.exp_date > sysdate)
            and b1.rate_plan_id = c1.rate_plan_id
            and b2.rate_plan_id = c2.rate_plan_id
            and c1.offer_ver_id = d1.offer_ver_id
            and c2.offer_ver_id = d2.offer_ver_id
            and (d1.exp_date is null or d1.exp_date > sysdate)
            and (d2.exp_date is null or d2.exp_date > sysdate)
            and d1.offer_id = e1.offer_id
            and d2.offer_id = e2.offer_id
            and c1.re_id = f1.re_id
            and c2.re_id = f2.re_id
            and c1.rate_plan_id = g1.rate_plan_id
            and c2.rate_plan_id = g2.rate_plan_id"
    PriceValue_RefValueId_NotExists:
      sql:
        "select * from price a where not exists (select * from ref_value b where a.value = b.ref_value_id)"
    ProdSpec_No_Migration:
      sql:
        "SELECT a.*
              FROM bwf_cond a
             where function in ('GetProdStateByNumAndProdSpecID', 'judgedependprod')
               and a.param1 is not null
               and not exists (select 1
                      from offer b
                     where a.param1 = b.offer_id
                       and b.offer_type in (2, 3))"
    RatePlan_OfferVer_Re_Err:
      sql:
        "select t.*, t1.*
                  from rate_plan_mapping t,
                       (select *
                          from rate_plan a
                         where not exists (select *
                                  from rate_plan_mapping b
                                 where a.re_id = b.re_id
                                   and a.offer_ver_id = b.offer_ver_id
                                   and a.rate_plan_id = b.rate_plan_id)
                           and a.rate_plan_id <> -1) t1
                 where t.offer_ver_id = t1.offer_ver_id
                   and t.re_id = t1.re_id
                   and not exists (select *
                          from rate_plan c
                         where t.offer_ver_id = c.offer_ver_id
                           and t.rate_plan_id = c.rate_plan_id
                           and t.re_id = c.re_id)
                 order by t.offer_ver_id, t.re_id, t.rate_plan_id"
    ReReserve_Policy_No_Limit:
      sql:
        "select f.workflow_name, a.PARAM1 as re_id, c.RE_NAME,d.sort_rule_name, e.NODE_NAME
        from bwf_action   a,
        def_re_attr  b,
        re           c,
        bwf_step     d,
        bwf_node     e,
        bwf_workflow f
        where a.src_re_attr = a.obj_re_attr
        and a.src_re_attr = b.re_attr
        and b.def_re_attr = 21
        and a.PARAM1 = TO_CHAR(c.re_id)
        and a.PARAM1  in (select re_id from reserve_policy)
        and a.step_id = d.STEP_ID
        and d.NODE_ID = e.NODE_ID
        and e.workflow_id = f.workflow_id
        and f.workflow_type in ('A','B')
        and a.param1 not in ('900','972','973')
        and not exists (select 1 from reserve_limit b where b.re_id=a.param1 )"
    SortRule_OutputRe_No_Reserve:
      sql:
        "select f.workflow_name, a.PARAM1 as re_id, c.RE_NAME,d.sort_rule_name, e.NODE_NAME
                      from bwf_action   a,
                           def_re_attr  b,
                           re           c,
                           bwf_step     d,
                           bwf_node     e,
                           bwf_workflow f
                     where a.src_re_attr = a.obj_re_attr
                       and a.src_re_attr = b.re_attr
                       and b.def_re_attr = 21
                       and a.PARAM1 = TO_CHAR(c.re_id)
                       and a.PARAM1 not in (select re_id from reserve_policy)
                       and a.PARAM1 not in (select re_id from RESERVE_POLICY_PROD_SPEC)
                       and a.step_id = d.STEP_ID
                       and d.NODE_ID = e.NODE_ID
                       and e.workflow_id = f.workflow_id
                       and f.workflow_type in ('A','B')
                       and a.param1 not in ('900','972','973')"
    SortRule_OutputRe_No_Tariff:
      sql:
        "select a.PARAM1, c.RE_NAME,d.sort_rule_name, e.NODE_NAME, f.workflow_name
             from bwf_action   a,
                  def_re_attr  b,
                  re           c,
                  bwf_step     d,
                  bwf_node     e,
                  bwf_workflow f
            where a.src_re_attr = a.obj_re_attr
              and a.src_re_attr = b.re_attr
              and b.def_re_attr = 21
              and a.PARAM1 = TO_CHAR(c.re_id)
              and a.PARAM1 not in (select re_id from re_price_plan)
              and a.step_id = d.STEP_ID
              and d.NODE_ID = e.NODE_ID
              and e.workflow_id = f.workflow_id
              and a.param1 not in ('900','972','973')
              /*and e.workflow_id in (1001, 1002, 110066, 110083)*/"
    SUBS_PLAN_SHOULD_HAVE_DEFAULT_OFFER_GROUP:
      sql:
        "select o.*
              from offer o
             where o.offer_type = 7
               and not exists
             (select 1
                      from offer_ver ov, subs_plan_offer_select a, offer_group b
                     where o.offer_id = ov.offer_id
                       and ov.offer_ver_id = a.offer_ver_id
                       and a.offer_group_id = b.offer_group_id
                       and b.offer_group_type = '6'
                       and (ov.exp_date is null or ov.exp_date > sysdate))
               and o.state <>'X' "
    TemplateRatePlan_No_RatePlanMapping:
      sql:
        "select * from rate_plan a where a.template_flag = 'Y' and not exists (select 1 from rate_plan_mapping b where a.rate_plan_id = b.rate_plan_id and a.re_id = b.re_id and b.offer_ver_id = -1) and a.rate_plan_id <> -1"
    TemplateRatePlan_OfferVerId_Error:
      sql:
        "select * from rate_plan a where a.template_flag = 'Y' and a.offer_ver_id <> -1"

    WorkFlow_Expression_No_Match_ZoneMap:
      sql:
        "select bs.sort_rule_name, ba.function, ba.param1
          from bwf_step bs, bwf_action ba
          where bs.step_id = ba.step_id
          and upper(ba.function) like '%ZONE%'
          and not exists
          (select 1 from zone_map zm where zm.zone_map_id = ba.param1)"

    WorkFlow_Result_No_Match_ZoneMap:
      sql:
        "select bs.sort_rule_name, bc.cond_group_id, bc.function, bc.param1
          from bwf_step bs, bwf_cond_group bcg, bwf_cond bc
          where bs.step_id = bcg.step_id
          and bcg.cond_group_id = bc.cond_group_id
          and upper(bc.function) like '%ZONE%'
          and not exists
          (select 1 from zone_map zm where zm.zone_map_id = bc.param1)"

    Zone_Same zone value exists in different zone:
      sql:
        "select d.zone_map_id,d.zone_map_name,d.value from (
        select c.zone_map_id,c.zone_map_name,a.zone_id,a.zone_name,b.value from zone a,zone_value b,zone_map c
        where a.zone_id=b.zone_id
        and a.zone_map_id=c.zone_map_id ) d
        group by d.zone_map_id,d.zone_map_name,d.value
        having count(1)>1"
    RECURRING_RATING_NO_RECURRING_TYPE:
      sql:
        "select distinct e.offer_name, e.offer_id, d.re_id, d.re_name
         from offer e, offer_ver b, re_price_plan c, re d, rate_plan_mapping f
         where e.offer_id = b.offer_id
         and b.offer_ver_id = c.offer_ver_id
         and c.re_id = d.re_id
         and d.re_type = '9'
         and c.re_id = f.re_id
         and c.offer_ver_id = f.offer_ver_id
           and not exists (select 1 from re_pp_recurring a
         where a.price_plan_id = b.offer_id
           and a.re_id = c.re_id
           and (a.state = 'A'or a.state is null))
           and (e.state = 'A'or e.state is null)"
    RECURRING_PP_NO_RECURRING_RATE:
      sql:
        "select * from re_pp_recurring a, offer e
         where e.offer_id = a.price_plan_id
           and not exists (select 1 from offer_ver b, re_price_plan c, re d, rate_plan_mapping f
         where a.price_plan_id = b.offer_id
           and a.re_id = c.re_id
           and b.offer_ver_id = c.offer_ver_id
           and c.re_id = d.re_id
           and d.re_type = '9'
           and c.re_id = f.re_id
           and c.offer_ver_id = f.offer_ver_id)
           and (e.state = 'A' or e.state is null)
           and (a.state = 'A' or a.state is null)"

    ATTRID_NOT_EXIST:
      sql:
        "select * from offer_attr a where not exists (select 1 from attr b where a.attr_id = b.attr_id)"

    ATTRID_NOT_EXIST_SUBS_PLAN:
      sql:
        "select * from subs_plan_offer_attr a where not exists (select 1 from attr b where a.attr_id = b.attr_id)"
    ADVICE_TYPE_NOT_EXIST_BAL:
      sql:
        "select * from bal_advice a where not exists (select 1 from advice_type b where a.advice_type = b.advice_type)"
    ADVICE_TYPE_NOT_EXIST_ACM:
      sql:
        "select * from acm_advice a where not exists (select 1 from advice_type b where a.advice_type = b.advice_type)"

