A001:
    CPCTopic:
        UserList:
            cc

        BadData:
            A001 Service_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_features_groups a
                 where not exists (select 1
                          from mid_ocm_noipp_list b
                         where a.feature_name = b.features_name)
                   and not exists (select 1
                          from mid_ocm_relate_prod c
                         where a.feature_name = c.features)
                   and a.feature_type = 'Service'
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 3
                           and a.feature_name = a1.service_name
                           and a.service_code = a1.service_code
                           and a.feature_type = a1.service_type)"
            A001 Device_SingleOfferId_NotIn_Mapping:
                "select *
                from mid_ocm_features_groups a
               where a.feature_type = 'Device'
                 and a.groupe_name not in ('Leased Lines Accessoires')
                 and exists
               (select 1 from crm.gm_model b where a.service_code = b.mode_code)
                 and not exists
               (select 1
                        from mid_ocm_offerid_mapping a1
                       where a1.offer_type = 5
                         and a.feature_name = a1.service_name
                         and 'Single Sale ' || a.service_code = a1.service_code
                         and a.feature_type = a1.service_type)"
            A001 Device_BundleOfferId_NotIn_Mapping:
                "select *
                from mid_ocm_features_groups a
               where a.feature_type = 'Device'
                 and a.groupe_name not in ('Leased Lines Accessoires')
                 and exists
               (select 1 from crm.gm_model b where a.service_code = b.mode_code)
                 and exists (select 1 from mid_ocm_leasing_goods a2 where a.service_code = a2.goods_code)
                 and not exists
               (select 1
                        from mid_ocm_offerid_mapping a1
                       where a1.offer_type = 5
                         and a.feature_name = a1.service_name
                         and 'Bundle Offer ' || a.service_code = a1.service_code
                         and a.feature_type = a1.service_type)"
            A001 NewIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_offer_specification b
                 where b.remark in ('LEASED LINE', 'VPN','SVA ONLY', 'MOBILE PRO','PRE-PERSO', 'ROUTAGE', 'MIX', 'SCHLUMBERGER')
                   and not exists (select 1
                          from mid_ocm_offerid_mapping c
                         where b.offer_name = c.service_name
                           and c.offer_type = 4
                           and (b.remark = c.service_code or c.service_code = '0'))"

            A001 BundleIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_features_groups a
                 where a.feature_type = 'Bundle'
                   and a.feature_name like 'IPP Benefit%%'
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 4
                           and a1.service_name = a.feature_name
                           and a1.service_type = a.feature_type)"

            A001 LeasedLineIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_features_groups a
                 where a.feature_type = 'Device'
                   and a.groupe_name = 'Leased Lines Accessoires'
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 4
                           and a1.service_name = a.feature_name
                           and a1.service_code = a.service_code)"

            A001 LeasingIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_offer_specification a
                 where a.remark in ('LEASING12', 'LEASING24', 'LEASING BUNDLE')
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 4
                           and a1.service_name = a.offer_name
                           and a1.service_code = a.remark)"
            A001 LeasingIPPGroup_Is_Missing:
                "select distinct a.offer_id, b.offer_ver_id, a.lifecycle_type
                  from lifecycle_apply a, offer_ver b, offer_group d, subs_plan e
                 where a.lifecycle_type in (2, 4)
                   and a.offer_id = b.offer_id
                   and (b.exp_date is null or b.exp_date > sysdate)
                   and a.offer_id = e.subs_plan_id
                   and e.indep_prod_spec_id not in ('200001', '200002', '200012')
                   and d.offer_group_name in
                       ('LEASING 12Month Individual',
                        'LEASING 24Month Individual',
                        'LEASING WITH BUNDLE 12Month Individual')
                   and not exists (select 1
                          from subs_plan_offer_select c
                         where c.offer_group_id = d.offer_group_id
                           and b.offer_ver_id = c.offer_ver_id)"
            A001 RelatedProd_Need_PricePlan:
                "select *
                from offer a
               where a.offer_type = 3
                 and a.offer_id not in (300000)
                 and not exists (select 1
                        from offer_rela b
                       where b.dest_offer_id = a.offer_id
                         and b.rela_type = 'D')"
            A001 AntiBillShock_Group_Is_Not_Single_Choice:
                "select *
                from offer_group a1
               where exists (select *
                        from offer_group_mem a, offer b
                       where a.offer_id = b.offer_id
                         and b.offer_name like '%%AntiBillShock%%'
                         and a1.offer_group_id = a.offer_group_id)
                 and a1.group_type != 'B'"
            A001 SubsPlan_No_OfferGroup_Core:
                "select *
                  from offer a
                 where a.offer_type = 7
                   and (a.comments not in ('GSM CUG', 'LEASED LINE', 'VPN', 'GSM VPN', 'ROUTAGE')
                    or a.comments is null)
                   and a.offer_id not in (700143, 700105)
                   and not exists
                 (select 1
                          from offer_ver b, subs_plan_offer_select c, offer_group d
                         where a.offer_id = b.offer_id
                           and b.offer_ver_id = c.offer_ver_id
                           and c.offer_group_id = d.offer_group_id
                           and d.offer_group_name = 'Service Core GSM')"

            A001 SubsPlan_No_OfferGroup_Additionel:
                "select *
                  from offer a
                 where a.offer_type = 7
                   and (a.comments not in ('GSM CUG', 'LEASED LINE', 'VPN', 'GSM VPN', 'ROUTAGE')
                    or a.comments is null)
                   and a.offer_id not in (700143, 700105)
                   and not exists
                 (select 1
                          from offer_ver b, subs_plan_offer_select c, offer_group d
                         where a.offer_id = b.offer_id
                           and b.offer_ver_id = c.offer_ver_id
                           and c.offer_group_id = d.offer_group_id
                           and d.offer_group_name = 'Service Additionel GSM')"
            A001 OFFER_NOIN_OFFER_GROUP:
                "select *
                from offer a
               where a.offer_type = 4
                 and not exists
               (select 1 from offer_group_mem b where a.offer_id = b.offer_id)
                 and not exists (select * from acct_price_plan c where a.offer_id = c.price_plan_id)
                 and a.offer_id not in (400180, -100, 400160, 400080, 400000)
               order by a.offer_name"

            A001 OFFER_DUPLICATE_IN_OFFER_GROUP:
                "select *
                  from offer_group_mem a
                 where exists (select 1
                          from offer_group_mem b
                         where a.offer_group_id = b.offer_group_id
                           and a.offer_id = b.offer_id
                           and a.offer_group_mem_id != b.offer_group_mem_id)"

            A001 RECURRING_RE_NO_SORT_RULE:
                "select *
                  from re_pp_recurring a
                 where not exists (select 1 from sort_recurring b where a.re_id = b.re_id)"

            A001 OFFER_CATG_MEM_OFFER_DUPLICAT:
                "select offer_id
               from offer_catg_mem a, offer_catg b
               where a.offer_catg_id = b.offer_catg_id
                 and b.offer_catg_class = 'B'
                 and a.offer_id is not null
               group by a.offer_id having count(1)>1"

A002:
    Topic001:
        UserList:
            cc
        BadData:
            A002 M-CheckNumberGradeAttr:
                "SELECT t2.offer_id
                       FROM offer t2
                      where t2.offer_type = '2'
                        and t2.state = 'A'
                        and t2.offer_id not in
                            (select t.offer_id
                               from offer_attr t
                              where t.attr_id in
                                    (SELECT t1.attr_id
                                       FROM attr t1
                                      where t1.attr_code = 'EXP_NBRGRADE_FEE'))"
            A002 M-CheckOfferName:
                "SELECT * FROM offer a
                     where a.offer_id in (SELECT a.offer_id
                                             FROM offer a, offer b
                                            where a.offer_id = b.offer_id + 500000
                                              and a.offer_type = 7
                                              and b.offer_type = 2
                                              and b.offer_name <> 'Business Flex'
                                              and a.offer_name <> b.offer_name)"
            A002 M-CheckNotDeleteOffer:
                "SELECT a.offer_id,a.offer_name
                     FROM  offer a
                     where a.offer_type=7
                     and length(a.offer_id)=6
                     and a.offer_id not in (select distinct main_product_id+700000 from mig_total_priceplan_list where main_product_id is not null)
                     union
                     SELECT a.offer_id,a.offer_name
                     FROM offer a
                     where a.offer_type = 2
                     and length(a.offer_id)=6
                     and a.offer_id not in (select distinct main_product_id+200000 from mig_total_priceplan_list where main_product_id is not null)"
            A002 M-CheckTriggerEvent982:
                "SELECT a.subs_event_id FROM bal_subs_event a
                     where a.subs_event_id=2
                     and a.ext_attr not like '982%%'
                     union
                     SELECT a.subs_event_id FROM acm_subs_event a
                     where a.subs_event_id=2
                     and a.ext_attr not like '982%%'"
            A002 M-CheckCustAttr:
                "SELECT * FROM CUST_TYPE_ATTR a
                     where CUST_TYPE = 'C'
                       and CUST_ATTR_ID = 806
                       and DEFAULT_VALUE <> 'serviceclients@orange.cd'"
            A002 M-CheckDuplicatedPriceTemplate:
                "SELECT a.price_name,count(1)
                     FROM PRICE A
                     WHERE A.PRICE_VER_ID IS NULL
                     and a.template_flag='Y'
                     group by a.price_name
                     having count(1)>1"
            A002 M-CheckDuplicatedRatePlanTemplate:
                "SELECT a.rate_plan_name,count(1)
                     FROM rate_plan a
                     where a.offer_ver_id=-1
                     group by a.rate_plan_name
                     having count(1)>1"
            A002 M-CheckDuplicatedAcctItemTypeCode:
                "SELECT acct_item_type_code,count(1)
                     FROM acct_item_type a
                     where a.acct_item_type_code is not null
                     group by a.acct_item_type_code
                     having count(1)>1"
            A002 M-ExistsIPAddressAttr:
                "SELECT * FROM offer_attr a
                     where a.attr_id=750"
            A002 M-InsertEXP_IS_4G_APNAttrFailed:
                "SELECT 'EXP_IS_4G_APN attr Y insert failed' FROM dual
                     where not exists (select 1 from offer b,offer_attr a
                                   where b.offer_name in ('APN iew.orange.cd','APN mms.orange.cd','APN nomad.orange.cd','APN bew.orange.cd','APN internet.air','APN internet.fly','APN ltef.orange.cd','APN belgium')
                                   and a.offer_id=b.offer_id
                                   and a.attr_id=1321
                                   and a.default_value='Y')
                     union
                     SELECT 'EXP_IS_4G_APN attr N insert failed' FROM dual
                     where not exists (select 1 from offer b,offer_attr a
                                   where b.offer_name in ('APN wap.orange.cd','APN blackberry.net','APN flybox.orange.cd','APN m2m.orange.cd','APN RAWBANK','APN FINCA','APN PROCREDIT','APN TELESAT','APN ISS','APN BRALIMA','BralimaAPN2','APN fsm.orange.cd','APN net.orange.cd','APN tigo.web','APN tigo.wap','APN Helios','APN WinnerBet','APN.ecobank','APN.tmb','APN.vodacom','APN.smico','APN sodeico','APN mlott','APN total','APN oramoney','APN ceni','coopec','ordc.ngenge.cd','ordc.pgames.cd','telenet')
                                   and a.offer_id=b.offer_id
                                   and a.attr_id=1321
                                   and a.default_value='N')"
            A002 M-InsertPDPTypeAttrFailed:
                "SELECT 'PDPType attr insert failed' FROM dual
                     where not exists (select 1 from offer b,offer_attr a
                                   where b.offer_name in ('APN internet.air','APN internet.fly','APN ltef.orange.cd')
                                   and a.offer_id=b.offer_id
                                   and a.attr_id=755
                                   and a.default_value=0)"
            A002 M-InsertEXP_INTERNET_ACCESSIBLEAttrFailed:
                "SELECT 'EXP_INTERNET_ACCESSIBLE attr Y insert failed' FROM dual
                     where not exists (select 1 from offer b,offer_attr a
                                   where b.offer_name in ('Bolt Box SME','Bolt Box','Flybox Bolt')
                                   and a.offer_id=b.offer_id
                                   and a.attr_id=1320
                                   and a.default_value='Y')
                     union
                     SELECT 'EXP_INTERNET_ACCESSIBLE attr N insert failed' FROM dual
                     where not exists (select 1 from offer b,offer_attr a
                                   where b.offer_id in (200222,200072,200074,200389,200311,200435,200436,200456,200380,200328,200375,200381,200142,200231,200339,2634,5939,200387,200376,200167,200140)
                                   and a.offer_id=b.offer_id
                                   and a.attr_id=1320
                                   and a.default_value='N')"
            A002 M-Check_M2M_ThresholdAdvice__PythonOfferName_And_PythoniResourceId:
                "SELECT *
                      FROM (SELECT bb.*,
                                   (case when bb.offer_name = bb.checkpython_OfferName then 'same'
                                     else 'different' end) config_flag
                              FROM (SELECT aa.offer_name,
                                           aa.offer_id,
                                           substr(aa.OfferName, 0, length(aa.OfferName)-1) checkpython_OfferName,
                                           aa.group_member_offer_id,
                                           aa.group_member_offer_name,
                                           aa. rate_plan_name,
                                           aa.rate_plan_id,
                                           aa.re_name,
                                           aa.re_type_name,
                                           aa.iResourceId
                                      FROM (SELECT t9.offer_id,
                                                   t9.offer_name,
                                                   t.offer_id group_member_offer_id,
                                                   t.offer_name group_member_offer_name,
                                                   t2.rate_plan_name,
                                                   t2.rate_plan_id,
                                                   t4.re_name,
                                                   t8.re_type_name,
                                                   regexp_substr(to_char(substr(t5.rule_script, instr(t5.rule_script,'Threshold=') + 10,200)),'[0-9]+.[0-9]+') Threshold,
                                                   regexp_substr(to_char(substr(t5.rule_script, instr(t5.rule_script,'iResourceId=') + 12, 200)),'[0-9]+.[0-9]+') iResourceId,
                                                   regexp_substr(to_char(substr(t5.rule_script,instr(t5.rule_script,'OfferName=''') + 11, 200)),'.+') OfferName
                                              FROM offer                  t,
                                                   offer_ver              t1,
                                                   rate_plan              t2,
                                                   rate_plan_mapping      t3,
                                                   re                     t4,
                                                   up_rule                t5,
                                                   price_ver              t6,
                                                   price                  t7,
                                                   re_type                t8,
                                                   offer                  t9,
                                                   offer_ver              t10,
                                                   subs_plan_offer_select t11,
                                                   offer_group            t12,
                                                   offer_group_mem        t13
                                             where t.offer_id = t1.offer_id
                                               and t3.offer_ver_id = t1.offer_ver_id
                                               and t3.rate_plan_id = t2.rate_plan_id
                                               and t4.re_id = t3.re_id
                                               and t6.rate_plan_id = t3.rate_plan_id
                                               and t7.price_ver_id = t6.price_ver_id
                                               and t5.up_id = t7.price_id
                                               and t8.re_type = t4.re_type
                                               and t9.offer_id = t10.offer_id
                                               and t11.offer_ver_id = t10.offer_ver_id
                                               and t11.offer_group_id = t12.offer_group_id
                                               and t11.offer_group_id = t13.offer_group_id
                                               and t13.offer_id = t.offer_id
                                               and lower(t2.rate_plan_name) like '%%advice%%'
                                               and t12.offer_group_name in
                                                   (SELECT distinct a1.offer_group_name
                                                      FROM subs_plan_offer_select a, offer_group a1
                                                     where a1.offer_group_id = a.offer_group_id
                                                       and (lower(a1.offer_group_name) like
                                                           '%%default%%' or
                                                           lower(a1.offer_group_name) like '%%dpp%%' or
                                                           lower(a1.offer_group_name) like '%%ipp%%'))
                                               and t.offer_name not in ('QOS','ACM','M2M_ODC','Orange Pro Deposit Cancel for Orange Employee')
                                               and t.offer_name not like 'Postpaid SMS Package Tariffs%%'
                                               and t9.offer_name in
                                                   ('Limited M2M (New) Offer',
                                                    'Easy Limited Offer',
                                                    'Easy unlimited Offer',
                                                    'Unlimited M2M (New) Offer',
                                                    'M2M PAYG',
                                                    'M2M Offer (New)',
                                                    'Bralima (New)')) aa) bb) cc
                     where cc.config_flag = 'different' or cc.iResourceId !=444"


            A002 M-Check_M2M_ThresholdAdvice_PythonThreshold:
                "SELECT *
                      FROM (SELECT t9.offer_id,
                                   t9.offer_name,
                                   t.offer_id group_member_offer_id,
                                   t.offer_name group_member_offer_name,
                                   t2.rate_plan_name,
                                   t2.rate_plan_id,
                                   t4.re_name,
                                   t8.re_type_name,
                                   regexp_substr(to_char(substr(t5.rule_script,instr(t5.rule_script,'Threshold=') + 10,200)),'[0-9]+.[0-9]+') Threshold
                              FROM offer                  t,
                                   offer_ver              t1,
                                   rate_plan              t2,
                                   rate_plan_mapping      t3,
                                   re                     t4,
                                   up_rule                t5,
                                   price_ver              t6,
                                   price                  t7,
                                   re_type                t8,
                                   offer                  t9,
                                   offer_ver              t10,
                                   subs_plan_offer_select t11,
                                   offer_group            t12,
                                   offer_group_mem        t13
                             where t.offer_id = t1.offer_id
                               and t3.offer_ver_id = t1.offer_ver_id
                               and t3.rate_plan_id = t2.rate_plan_id
                               and t4.re_id = t3.re_id
                               and t6.rate_plan_id = t3.rate_plan_id
                               and t7.price_ver_id = t6.price_ver_id
                               and t5.up_id = t7.price_id
                               and t8.re_type = t4.re_type
                               and t9.offer_id = t10.offer_id
                               and t11.offer_ver_id = t10.offer_ver_id
                               and t11.offer_group_id = t12.offer_group_id
                               and t11.offer_group_id = t13.offer_group_id
                               and t13.offer_id = t.offer_id
                               and lower(t2.rate_plan_name) like '%%advice%%'
                               and t12.offer_group_name in
                                   (SELECT distinct a1.offer_group_name
                                      FROM subs_plan_offer_select a, offer_group a1
                                     where a1.offer_group_id = a.offer_group_id
                                       and (lower(a1.offer_group_name) like '%%default%%' or
                                           lower(a1.offer_group_name) like '%%dpp%%' or
                                           lower(a1.offer_group_name) like '%%ipp%%'))
                               and t.offer_name not in('QOS','ACM','M2M_ODC','Orange Pro Deposit Cancel for Orange Employee')
                               and t.offer_name not like 'Postpaid SMS Package Tariffs%%'
                               and t9.offer_name in ('Limited M2M (New) Offer',
                                                     'Easy Limited Offer',
                                                     'Easy unlimited Offer',
                                                     'Unlimited M2M (New) Offer',
                                                     'M2M PAYG',
                                                     'M2M Offer (New)',
                                                     'Bralima (New)')) aa

                     where (aa.group_member_offer_name like '%%500%%' and aa.Threshold != '512000')
                        or (aa.group_member_offer_name like '%%200%%' and aa.Threshold != '204800')
                        or ((aa.group_member_offer_name like '%%1,2%%' or aa.group_member_offer_name like '%%1.2 Go%%') and aa.Threshold != '1258291.2')
                        or (aa.group_member_offer_name like '%%10G%%' and aa.Threshold != '10485760')
                        or (aa.group_member_offer_name like '%%3G%%' and aa.Threshold != '3145728')
                        or (aa.group_member_offer_name like '%%3M%%' and aa.Threshold != '3072')
                        or ((aa.group_member_offer_name like '%%5M%%' or aa.group_member_offer_name like '%%PAYG%%') and aa.Threshold != '5120')
                        or (aa.group_member_offer_name like '%%M2M Offer (New)%%' and aa.Threshold != '30720')"
            A002 M-SmartPhoneNewOfferInsertIntoV81GroupFailed:
                "select *
                     from price_plan_selector@linkv7 c,price_plan@linkv7 d
                     where c.price_plan_id=d.price_plan_id
                     and d.price_plan_name like '%%BusiFull Pack%%12Mon Post%%'
                     and not exists (select 1 from offer_group a,offer_group_mem b,offer bb
                                     where a.offer_group_id=b.offer_group_id
                                     and b.offer_id=bb.offer_id
                                     and c.indep_prod_spec_id+200000=a.indep_prod_spec_id
                                     and bb.offer_name='BusiFull Pack 12Mon Post')
                     union
                     select *
                     from price_plan_selector@linkv7 c,price_plan@linkv7 d
                     where c.price_plan_id=d.price_plan_id
                     and d.price_plan_name like '%%BusiFull Pack%%24Mon Post%%'
                     and not exists (select 1 from offer_group a,offer_group_mem b,offer bb
                                     where a.offer_group_id=b.offer_group_id
                                     and b.offer_id=bb.offer_id
                                     and c.indep_prod_spec_id+200000=a.indep_prod_spec_id
                                     and bb.offer_name='BusiFull Pack 24Mon Post')
                     union
                     select *
                     from price_plan_selector@linkv7 c,price_plan@linkv7 d
                     where c.price_plan_id=d.price_plan_id
                     and d.price_plan_name like '%%BusiFull Pack%%12Mon Hyb%%'
                     and not exists (select 1 from offer_group a,offer_group_mem b,offer bb
                                     where a.offer_group_id=b.offer_group_id
                                     and b.offer_id=bb.offer_id
                                     and c.indep_prod_spec_id+200000=a.indep_prod_spec_id
                                     and bb.offer_name='BusiFull Pack 12Mon Hyb')
                     union
                     select *
                     from price_plan_selector@linkv7 c,price_plan@linkv7 d
                     where c.price_plan_id=d.price_plan_id
                     and d.price_plan_name like '%%BusiFull Pack%%24Mon Hyb%%'
                     and not exists (select 1 from offer_group a,offer_group_mem b,offer bb
                                     where a.offer_group_id=b.offer_group_id
                                     and b.offer_id=bb.offer_id
                                     and c.indep_prod_spec_id+200000=a.indep_prod_spec_id
                                     and bb.offer_name='BusiFull Pack 24Mon Hyb')"
            A002 M-SmartPhoneOldOfferRemoveFailed:
                "SELECT * FROM offer_group_mem bb
                     where bb.offer_id in
                     (select offer_id
                       from offer a
                      where (a.offer_name like 'BusiFull Pack%%' or a.offer_name like '%%Business Full Pack Cancel Deposit%%')
                        and offer_type = 4
                        and a.offer_name not in ('BusiFull Pack 24Mon Post','BusiFull Pack 12Mon Post','BusiFull Pack 24Mon Hyb','BusiFull Pack 12Mon Hyb'))"
            A002 M-CheckEXP_NEED_UPLOADAttr:
                "SELECT a.offer_id FROM offer_attr a
                     where exists (select 1 from attr b
                                   where a.attr_id=b.attr_id
                                   and b.attr_code='EXP_NEED_UPLOAD')
                     and exists (select 1 from offer c
                                 where a.offer_id=c.offer_id
                                 and c.offer_type=3
                                 and c.offer_name in ('iSMS','AOC','CII'))
                     union
                     SELECT c.offer_id FROM  offer c
                     where c.offer_type=3
                     and c.offer_name not in ('iSMS','AOC','CII')
                     and not exists (select 1 from offer_attr a,attr b
                                     where a.attr_id=b.attr_id
                                     and a.offer_id=c.offer_id
                                     and b.attr_code='EXP_NEED_UPLOAD')
                     union
                     SELECT b.offer_id
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and b.state='A'
                     and a.offer_id+100000=b.offer_id
                     and exists (select 1 from prod_spec@linkv7 c
                                 where b.offer_id=c.prod_spec_id+400000
                                 and c.prod_spec_type='R'
                                 and b.offer_name=c.prod_spec_name)
                     and not exists (select 1 from offer_attr d
                                     where b.offer_id=d.offer_id
                                     and d.attr_id=(select attr_id from attr c where c.attr_code='EXP_NEED_UPLOAD'))"
            A002 M-AcctItemTypeBillPriorityNotNull:
                "SELECT * FROM acct_item_type a
                     where a.bill_priority is not null"
            A002 M-MigratedOfferOTBModeError:
                "SELECT a.offer_id,a.offer_name,a.offer_type
                      FROM offer a
                      where a.offer_type=4
                      and a.state='A'
                      and length(a.offer_id)=6
                      and not exists (select 1 from offer_rela b
                                      where a.offer_id=b.ori_offer_id
                                      and b.rela_type='D')
                      and exists (select 1 from price_plan_selector@linkv7 c,mig_total_priceplan_list d
                                  where a.offer_id=c.price_plan_id+400000
                                  and c.INDEP_PROD_SPEC_ID=d.main_product_id)
                      union
                      SELECT a.offer_id,a.offer_name,a.offer_type
                      FROM offer a
                      where a.offer_type=3
                      and a.state='A'
                      and length(a.offer_id)=6
                      and not exists (select 1 from offer_rela b
                                      where a.offer_id=b.dest_offer_id
                                      and b.rela_type='D')
                      and exists (select 1 from prod_selector@linkv7 c,mig_total_priceplan_list d
                                  where a.offer_id=c.DEPEND_PROD_SPEC_ID+300000
                                  and c.INDEP_PROD_SPEC_ID=d.main_product_id)"
            A002 M-V81NewOfferOTBModeError:
                "SELECT a.offer_id,a.offer_name,a.offer_type
                     FROM offer a
                     where a.offer_type=4
                     and a.state='A'
                     and not exists (select 1 from offer_rela b
                                     where a.offer_id=b.ori_offer_id
                                     and b.rela_type='D')
                     and length(a.offer_id)=4
                     and a.offer_id<>'-100'
                     and a.offer_name<>'TAX'
                     and a.offer_name not like '%%bundle%%'
                     union
                     SELECT a.offer_id,a.offer_name,a.offer_type
                     FROM offer a
                     where a.offer_type=3
                     and a.state='A'
                     and not exists (select 1 from offer_rela b
                                     where a.offer_id=b.dest_offer_id
                                     and b.rela_type='D')
                     and length(a.offer_id)=4
                     and a.offer_id<>'-100'
                     and a.offer_name<>'TAX'
                     and a.offer_name not like '%%bundle%%'"
            A002 M-DelayTimeIsNullInAdviceType:
                "SELECT * FROM advice_type a
                     where a.delay_time is null"
            A002 M-Check_dependOfferCode:
                "SELECT * FROM offer a
                     where a.offer_code='_depend'"
            A002 M-OtbOfferNameCodeCheck:
                "SELECT a.offer_id depend_offer_id,a.offer_name depend_offer_name,b.offer_id price_offer_id,b.offer_name price_offer_name
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and a.state='A'
                     and a.offer_name<>b.offer_name
                     and a.offer_id+100000=b.offer_id
                     and exists (select 1 from price_plan@linkv7 c
                                 where a.offer_id=c.price_plan_id+300000
                                 and a.offer_name=c.price_plan_name)
                     union
                     SELECT a.offer_id depend_offer_id,a.offer_code depend_offer_code,b.offer_id price_offer_id,b.offer_code price_offer_code
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and a.state='A'
                     and a.offer_code<>b.offer_code||'_depend'
                     and a.offer_id+100000=b.offer_id
                     and exists (select 1 from price_plan@linkv7 c
                                 where a.offer_id=c.price_plan_id+300000
                                 and a.offer_name=c.price_plan_name)
                     union
                     SELECT a.offer_id depend_offer_id,a.offer_name depend_offer_name,b.offer_id price_offer_id,b.offer_name price_offer_name
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and b.state='A'
                     and a.offer_id+100000=b.offer_id
                     and a.offer_name<>b.offer_name
                     and a.offer_id not in (300114,300111,300277,300112,300355)
                     and exists (select 1 from prod_spec@linkv7 c
                                 where b.offer_id=c.prod_spec_id+400000
                                 and c.prod_spec_type='R'
                                 and b.offer_name=c.prod_spec_name)
                     union
                     SELECT a.offer_id depend_offer_id,a.offer_name depend_offer_name,b.offer_id price_offer_id,b.offer_name price_offer_name
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and b.state='A'
                     and a.offer_id+110000=b.offer_id
                     and a.offer_name<>b.offer_name
                     and a.offer_id in (300114,300111,300277,300112,300355)
                     and exists (select 1 from prod_spec@linkv7 c
                                 where b.offer_id=c.prod_spec_id+410000
                                 and c.prod_spec_type='R'
                                 and b.offer_name=c.prod_spec_name)
                     union
                     SELECT a.offer_id depend_offer_id,a.offer_code depend_offer_code,b.offer_id price_offer_id,b.offer_code price_offer_code
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and b.state='A'
                     and a.offer_id+100000=b.offer_id
                     and a.offer_code<>b.offer_code||'_depend'
                     and a.offer_id not in (300114,300111,300277,300112,300355)
                     and exists (select 1 from prod_spec@linkv7 c
                                 where b.offer_id=c.prod_spec_id+400000
                                 and c.prod_spec_type='R'
                                 and b.offer_name=c.prod_spec_name)
                     union
                     SELECT a.offer_id depend_offer_id,a.offer_code depend_offer_code,b.offer_id price_offer_id,b.offer_code price_offer_code
                     FROM offer a,offer b
                     where a.offer_type=3
                     and b.offer_type=4
                     and b.state='A'
                     and a.offer_id+110000=b.offer_id
                     and a.offer_code<>b.offer_code||'_depend'
                     and a.offer_id in (300114,300111,300277,300112,300355)
                     and exists (select 1 from prod_spec@linkv7 c
                                 where b.offer_id=c.prod_spec_id+410000
                                 and c.prod_spec_type='R'
                                 and b.offer_name=c.prod_spec_name)"
            A002 M-CheckMigratedOfferNameCode:
                "SELECT a.offer_id,a.offer_type,a.offer_name,b.prod_spec_id,b.prod_spec_type,b.prod_spec_name
                     FROM offer a,prod_spec@linkv7 b
                     where a.offer_type in (2,7)
                     and length(a.offer_id)=6
                     and b.prod_spec_type='M'
                     and a.offer_id-decode(a.offer_type,2,200000,7,700000)=b.prod_spec_id
                     and a.offer_name<>b.prod_spec_name
                     union
                     SELECT a.offer_id,a.offer_type,a.offer_code,b.prod_spec_id,b.prod_spec_type,b.std_code
                     FROM offer a,prod_spec@linkv7 b
                     where a.offer_type in (2,7)
                     and length(a.offer_id)=6
                     and b.prod_spec_type='M'
                     and a.offer_id-decode(a.offer_type,2,200000,7,700000)=b.prod_spec_id
                     and a.offer_code<>b.std_code
                     union
                     SELECT a.offer_id,a.offer_type,a.offer_name,b.prod_spec_id,b.prod_spec_type,b.prod_spec_name
                     FROM offer a,prod_spec@linkv7 b
                     where a.offer_type in (3)
                     and length(a.offer_id)=6
                     and b.prod_spec_type='R'
                     and a.offer_id-decode(a.offer_type,3,300000)=b.prod_spec_id
                     and a.offer_name<>b.prod_spec_name
                     union
                     SELECT a.offer_id,a.offer_type,a.offer_code,b.prod_spec_id,b.prod_spec_type,b.std_code
                     FROM offer a,prod_spec@linkv7 b
                     where a.offer_type in (3)
                     and length(a.offer_id)=6
                     and b.prod_spec_type='R'
                     and a.offer_id-decode(a.offer_type,3,300000)=b.prod_spec_id
                     and a.offer_code<>b.std_code||'_depend'
                     union
                     SELECT a.offer_id,a.offer_type,a.offer_name,b.price_plan_id,'1',b.price_plan_name
                     FROM offer a,price_plan@linkv7 b
                     where a.offer_type in (4)
                     and length(a.offer_id)=6
                     and a.offer_id-400000=b.price_plan_id
                     and a.offer_name<>b.price_plan_name
                     union
                     SELECT a.offer_id,a.offer_type,a.offer_name,b.price_plan_id,'1',b.price_plan_name
                     FROM offer a,price_plan@linkv7 b
                     where a.offer_type in (4)
                     and length(a.offer_id)=6
                     and a.offer_id-400000=b.price_plan_id
                     and a.offer_code<>b.price_plan_code"
            A002 M-DependProductAndPricePlanBoundAttrCheck:
                "SELECT * FROM
                     (SELECT a.offer_id,b.offer_name,count(1) cnt
                     FROM offer_attr a,offer b
                     where a.offer_id=b.offer_id
                     and exists (select 1 from depend_prod_spec@linkv7 c
                                 where a.offer_id=c.depend_prod_spec_id+300000)
                     and exists (select 1 from mig_total_priceplan_list a1,offer_group_mem aa,offer_group bb
                                 where bb.indep_prod_spec_id = a1.main_product_id+200000
                                 and a.offer_id+100000=aa.offer_id
                                 and aa.offer_group_id=bb.offer_group_id
                                 and bb.offer_group_name like '%%Related Product Group')
                     group by a.offer_id,b.offer_name) aa,
                     (SELECT a.offer_id,b.offer_name,count(1) cnt
                     FROM offer_attr a,offer b
                     where a.offer_id=b.offer_id
                     and exists (select 1 from depend_prod_spec@linkv7 c
                                 where a.offer_id=c.depend_prod_spec_id+400000)
                     group by a.offer_id,b.offer_name) bb
                     where aa.offer_id+100000=bb.offer_id
                     and aa.cnt<>bb.cnt"
            A002 M-OfferVpnAttrCheck:
                "SELECT oa.offer_id
                     FROM  offer_attr oa
                     where exists (SELECT 1 FROM offer a
                     where a.offer_type=2
                     and a.offer_name in ('Fleet Offer','Business GFU(In Build)')
                     and oa.offer_id=a.offer_id)
                     and exists (select 1 from attr r
                                 where r.attr_name in ('VPN NAME','Brand Type','VPMN PRIORITY')
                                 and oa.attr_id=r.attr_id)
                     union
                     SELECT * FROM
                     (SELECT count(1) cnt FROM offer_attr oa
                        where exists
                        (SELECT 1
                                 FROM offer a
                                where a.offer_type = 2
                                  and a.offer_name in ('Fleet Offer', 'Business GFU(In Build)')
                                  and oa.offer_id = a.offer_id)
                         and exists (select 1 from attr r
                                 where r.attr_name in ('CUG(IT) Code','CUG(IT) Name')
                                 and oa.attr_id=r.attr_id))
                     where cnt<>4"
            A002 M-CheckSystemOfferConnectionEvent:
                "SELECT a.offer_id FROM offer a
                     where a.offer_name='Overlap System Price Plan'
                     union
                     SELECT a.offer_ver_id
                     FROM re_price_plan a
                     where a.offer_ver_id=550356
                     and exists (select * from re b
                                 where b.re_name ='connection'
                                 and a.re_id=b.re_id)"
            A002 M-CheckSubsCreditLimitAttr:
                "SELECT * FROM  offer_attr aa
                     where aa.attr_id=387
                     and aa.offer_id in
                     (SELECT a.offer_id
                     FROM offer_attr a,attr b
                     where a.attr_id=b.attr_id
                     and b.attr_name='Credit Limit'
                     minus
                     (select distinct indep_prod_spec_id
                     from (select a.indep_prod_spec_id from subs_plan a
                     where a.paid_flag='Y'
                     union
                     SELECT a.offer_id indep_prod_spec_id
                     FROM offer_attr a,attr b
                     where a.attr_id=b.attr_id
                     and b.attr_code='EXP_IS_HYBRID'
                     and a.default_value='Y')))
                     union
                     SELECT * FROM  offer_attr aa
                     where aa.attr_id=387
                     and aa.offer_id in
                     ((select distinct indep_prod_spec_id
                     from (select a.indep_prod_spec_id from subs_plan a
                     where a.paid_flag='Y'
                     union
                     SELECT a.offer_id indep_prod_spec_id
                     FROM offer_attr a,attr b
                     where a.attr_id=b.attr_id
                     and b.attr_code='EXP_IS_HYBRID'
                     and a.default_value='Y'))
                     minus
                     SELECT a.offer_id
                     FROM offer_attr a,attr b
                     where a.attr_id=b.attr_id
                     and b.attr_name='Credit Limit')"
            A002 M-CheckBusinessBoxHadHybridAttr:
                "SELECT * FROM  offer_attr a
                     where a.offer_id in (2576,7435)
                     and exists (select 1 from attr b
                                 where b.attr_name in ('Hybrid Flag','Is Hybrid Product','Hybrid Acct','Bal Share Group For Hybrid')
                                 and a.attr_id=b.attr_id)"
            A002 NewOffer_SpecialNumberOfferAttrCntError:
                "SELECT * FROM
                     (SELECT count(distinct a.attr_id) cnt
                     FROM offer_attr a
                     where a.offer_id=2504) aa,
                     (select count(1)  cnt
                     from (SELECT a.attr_id
                     FROM offer_attr a
                     where a.offer_id=200380
                     union
                     SELECT a.attr_id
                     FROM offer_attr a
                     where a.offer_id=200381)) bb
                     where aa.cnt<>bb.cnt"
            A002 NewOffer_SpecialNumberOfferGroupMemberCntError:
                "SELECT 'default price plan group error' FROM
                     (SELECT a.offer_group_type,count(1) cnt
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2504
                     group by a.offer_group_type) aa,
                     (SELECT a.offer_group_type,count(1) cnt
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200381
                     group by a.offer_group_type) bb,
                     (SELECT a.offer_group_type,count(1) cnt
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200380
                     group by a.offer_group_type) cc
                     where aa.offer_group_type=bb.offer_group_type
                     and bb.offer_group_type=cc.offer_group_type
                     and aa.offer_group_type=6
                     and aa.cnt<>bb.cnt+cc.cnt
                     union
                     SELECT 'option related product group error' FROM
                     (SELECT a.offer_group_type,count(1) cnt
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2504
                     group by a.offer_group_type) aa,
                     (SELECT a.offer_group_type,count(1) cnt
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200381
                     group by a.offer_group_type
                     union
                     SELECT a.offer_group_type,count(1) cnt
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200380
                     group by a.offer_group_type) bb
                     where aa.offer_group_type=bb.offer_group_type
                     and aa.offer_group_type=4
                     and aa.cnt<>bb.cnt"
            A002 M-CheckTaxAcctAttrValue:
                "SELECT * FROM acct_attr a
                     where a.attr_id in (781,782)
                     and (attr_value<>1 or a.attr_value is null)"
            A002 NewOffer_SpecialNumberOfferGroupMemberError:
                "((SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200381
                     union
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200380)
                     minus
                     (select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2504))
                     union
                     ((select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2504)
                     minus
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200381
                     union
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200380) )"
            A002 Quotation_RecurringDiscountPriorityLessThanRating:
                "SELECT aa.offer_ver_id,aa.re_id FROM
                     (SELECT b.offer_ver_id,b.re_id,b.rate_plan_id,a.rate_plan_name,b.priority
                     FROM rate_plan a,rate_plan_mapping b
                     where a.rate_plan_name like '%%discount for quotation%%'
                     and a.rate_plan_id=b.rate_plan_id) aa,
                     (SELECT b.offer_ver_id,b.re_id,b.rate_plan_id,c.rate_plan_name,b.priority
                     FROM rate_plan a,rate_plan_mapping b,rate_plan c
                     where a.rate_plan_name like '%%discount for quotation%%'
                     and replace(a.rate_plan_name,' discount for quotation')=c.rate_plan_name
                     and b.rate_plan_id=c.rate_plan_id
                     and c.offer_ver_id=b.offer_ver_id
                     and a.offer_ver_id=b.offer_ver_id
                     and a.re_id=b.re_id) bb
                     where aa.offer_ver_id=bb.offer_ver_id
                     and aa.re_id=bb.re_id
                     and nvl(aa.priority,0)<=nvl(bb.priority,0)"
            A002 RatePlan_Priority_Error:
              # 20190710: 1. 2. Rate_plan
              "select *
                          from rate_plan_mapping a, rate_plan b
                         where a.rate_plan_id = b.rate_plan_id
                           and b.rate_plan_type = 1
                           and a.offer_ver_id != -1
                           and exists (select 1
                                  from rate_plan_mapping a1, rate_plan b1
                                 where a1.rate_plan_id = b1.rate_plan_id
                                   and b1.rate_plan_type != 1
                                   and a1.offer_ver_id = a.offer_ver_id
                                   and a1.re_id = a.re_id
                                   and a.priority > a1.priority)"
            A002 NewOffer_M2MUsageAdviceFeeDeductInBenefitBal:
                "SELECT a.price_id,
                            d.offer_id,
                            e.offer_name,
                            c.rate_plan_id,
                            c.rate_plan_name,
                            f.re_id,
                            f.re_name,
                            r.re_attr_name,
                            a.price_name,
                            it.acct_item_type_name,
                            ar.acct_res_name
                       FROM up_rule              o,
                            price  a,
                            price_ver      b,
                            rate_plan      c,
                            rate_plan_mapping m,
                            offer_ver d,
                            offer     e,
                            re        f,
                            re_attr r,
                            ref_value rv,
                            acct_item_type it,
                            acct_res ar
                      where a.price_ver_id = b.price_ver_id
                      and a.re_attr=r.re_attr
                      and o.up_id=a.price_id
                      and o.script_templet_id=490
                      and e.offer_id<>-100
                      and ar.acct_res_name<>'main account US$'
                      and a.acct_item_type_id_param=rv.ref_value_id
                      and rv.value_string=it.acct_item_type_id
                      and it.acct_res_id=ar.acct_res_id
                        and b.rate_plan_id = c.rate_plan_id
                        and c.rate_plan_id=m.rate_plan_id
                        and m.offer_ver_id=d.offer_ver_id
                        and c.re_id=f.re_id
                        and (b.exp_date is null or sysdate between b.eff_date and b.exp_date)
                        and (d.exp_date is null or sysdate between d.eff_date and d.exp_date)
                        and d.offer_id = e.offer_id"
            A002 NewOffer_BusinessEssentialSortRecurringError:
                "  select 're_pp_recurring insert error' from dual
                       where not exists
                       (select 1 from re_pp_recurring a
                       where a.price_plan_id=561367
                       and a.re_id=(select re_id from re where re_name='Cycle Forward ( Business Essential )')
                       and a.recurring_re_type=1)
                       union
                       select 'sort_recurring insert error' from dual
                       where not exists (select 1 from sort_recurring b
                                       where b.re_id=(select re_id from re where re_name='Cycle Forward ( Business Essential )')
                                       and b.workflow_id=1525
                                       and b.post_workflow_id=110073)"
            A002 NewOffer_BusinessEssentialRecurringRatePlanError:
                " select 'rate_plan_mapping error' from  dual
                      where not exists (select 1 from rate_plan_mapping b,rate_plan a
                                      where a.rate_plan_id=b.rate_plan_id
                                      and b.offer_ver_id=561367
                                      and a.rate_plan_name like '%%Business_Essential_Recurr%%')
                      union
                      select 're_price_plan error' from  dual
                         where not exists
                        (select 1
                                 from re_price_plan b
                                where b.re_id =
                                      (SELECT re_id
                                         FROM re a
                                        where a.re_name = 'Cycle Forward ( Business Essential )')
                                  and b.offer_ver_id = 561367) "
            A002 NewOffer_BusinessGFUGroupMemberError:
                "select 1 from
                     (select count(1) cnt from offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.offer_group_name like '%%Business GFU%%'
                     and a.indep_prod_spec_id=2602)
                     where cnt<>6"
            A002 NewOffer_BusinessBoxTwoSubsPlanCheck:
                "SELECT * FROM
                     (SELECT count(1) cnt FROM offer a
                     where a.offer_name like '%%business box prepaid%%')
                     where cnt<>2
                     union
                     SELECT * FROM
                     (SELECT count(1) cnt FROM offer a
                     where a.offer_name like '%%business box postpaid%%')
                     where cnt<>2"
            A002 NewOffer_BusinessBoxOfferAttrDiff:
                "SELECT *
                                FROM (SELECT count(distinct a.attr_id) cnt_new
                                        FROM offer_attr a
                                       where a.offer_id = 2576) aa,
                                     (select count(1) cnt_old
                                        from (SELECT a.attr_id
                                                FROM offer_attr a
                                               where a.offer_id = 200157
                                              union
                                              SELECT a.attr_id
                                              FROM offer_attr a
                                              where a.offer_id = 200438)) bb
                               where aa.cnt_new <> bb.cnt_old
                     union
                     SELECT *
                                FROM (SELECT count(distinct a.attr_id) cnt_new
                                        FROM offer_attr a
                                       where a.offer_id = 7435) aa,
                                     (select count(1) cnt_old
                                        from (SELECT a.attr_id
                                                FROM offer_attr a
                                               where a.offer_id = 200156
                                               and exists (select 1 from attr b
                                               where b.attr_name not in ('Hybrid Flag','Is Hybrid Product','Hybrid Acct','Bal Share Group For Hybrid')
                                               and a.attr_id=b.attr_id)
                                              union
                                              SELECT a.attr_id
                                              FROM offer_attr a
                                              where a.offer_id = 200437
                                              and exists (select 1 from attr b
                                              where b.attr_name not in ('Hybrid Flag','Is Hybrid Product','Hybrid Acct','Bal Share Group For Hybrid')
                                              and a.attr_id=b.attr_id))) bb
                               where aa.cnt_new <> bb.cnt_old"
            A002 NewOffer_BusinessBoxOfferGroupMemberCnt1:
                "SELECT 'Postpaid Default Price Plan Group error'
                                   FROM (SELECT count(1) cnt
                                           FROM offer_group a, offer_group_mem b
                                          where a.offer_group_id = b.offer_group_id
                                            and a.indep_prod_spec_id = 2576
                                            and a.offer_group_name like '%%Default Price Plan Group%%') aa,
                                        (select count(1) cnt
                                           from (SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200157
                                                    and a.offer_group_name like '%%Default Price Plan Group%%'
                                                 union
                                                 SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200438
                                                    and a.offer_group_name like '%%Default Price Plan Group%%')) bb
                                  where aa.cnt <> bb.cnt
                                 union
                                 SELECT 'Postpaid option IPP group error'
                                   FROM (SELECT count(1) cnt
                                           FROM offer_group a, offer_group_mem b
                                          where a.offer_group_id = b.offer_group_id
                                            and a.indep_prod_spec_id = 2576
                                            and a.offer_group_name like '%%Option IPP Group%%') aa,
                                        (select count(1) cnt
                                           from (SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200157
                                                    and a.offer_group_name like '%%Option IPP Group%%'
                                                 union
                                                 SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200438
                                                    and a.offer_group_name like '%%Option IPP Group%%')) bb
                                  where aa.cnt <> bb.cnt
                                 union
                                 SELECT 'Postpaid Option Related Product Group error'
                                   FROM (SELECT count(1) cnt
                                           FROM offer_group a, offer_group_mem b
                                          where a.offer_group_id = b.offer_group_id
                                            and a.indep_prod_spec_id = 2576
                                            and a.offer_group_name like '%%Option Related Product Group%%') aa,
                                        (select count(1) cnt
                                           from (SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200157
                                                    and a.offer_group_name like '%%Option Related Product Group%%'
                                                 union
                                                 SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200438
                                                    and a.offer_group_name like '%%Option Related Product Group%%')) bb
                                  where aa.cnt <> bb.cnt"
            A002 NewOffer_BusinessBoxOfferGroupMemberCnt2:
                "SELECT 'Prepaid Default Price Plan Group error'
                                   FROM (SELECT count(1) cnt
                                           FROM offer_group a, offer_group_mem b
                                          where a.offer_group_id = b.offer_group_id
                                            and a.indep_prod_spec_id = 7435
                                            and a.offer_group_name like '%%Default Price Plan Group%%') aa,
                                        (select count(1) cnt
                                           from (SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200156
                                                    and a.offer_group_name like '%%Default Price Plan Group%%'
                                                 union
                                                 SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200437
                                                    and a.offer_group_name like '%%Default Price Plan Group%%')) bb
                                  where aa.cnt <> bb.cnt
                                 union
                                 SELECT 'Prepaid option IPP group error'
                                   FROM (SELECT count(1) cnt
                                           FROM offer_group a, offer_group_mem b
                                          where a.offer_group_id = b.offer_group_id
                                            and a.indep_prod_spec_id = 7435
                                            and a.offer_group_name like '%%Option IPP Group%%') aa,
                                        (select count(1) cnt
                                           from (SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200156
                                                    and a.offer_group_name like '%%Option IPP Group%%'
                                                 union
                                                 SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200437
                                                    and a.offer_group_name like '%%Option IPP Group%%')) bb
                                  where aa.cnt <> bb.cnt
                                 union
                                 SELECT 'Prepaid Option Related Product Group error'
                                   FROM (SELECT count(1) cnt
                                           FROM offer_group a, offer_group_mem b
                                          where a.offer_group_id = b.offer_group_id
                                            and a.indep_prod_spec_id = 7435
                                            and a.offer_group_name like '%%Option Related Product Group%%') aa,
                                        (select count(1) cnt
                                           from (SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200156
                                                    and a.offer_group_name like '%%Option Related Product Group%%'
                                                 union
                                                 SELECT b.offer_id
                                                   FROM offer_group a, offer_group_mem b
                                                  where a.offer_group_id = b.offer_group_id
                                                    and a.indep_prod_spec_id = 200437
                                                    and a.offer_group_name like '%%Option Related Product Group%%')) bb
                                  where aa.cnt <> bb.cnt"
            A002 NewOffer_BusinessBoxOfferGroupMemberValue:
                "((SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200157
                              union
                              SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200438)
                              minus
                              (select b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=2576))
                              union
                              ((select b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=2576)
                              minus
                              (SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200438
                              union
                              SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200157) )
                     union
                     ((SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200156
                              union
                              SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200437)
                              minus
                              (select b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=7435))
                              union
                              ((select b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=7435)
                              minus
                              (SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200437
                              union
                              SELECT b.offer_id
                              FROM offer_group a,offer_group_mem b
                              where a.offer_group_id=b.offer_group_id
                              and a.indep_prod_spec_id=200156) )"
            A002 NewOffer_BusinessFlexNewSubsPlanCheck:
                "SELECT count(1) FROM offer a
                     where a.offer_name like '%%Business Flex%%'
                     and a.offer_name<>'Business Flex(old)'
                     and a.offer_type=7
                     having count(1)<>5"
            A002 NewOffer_BusinessFlexOfferGroupMemberValue:
                "(SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1257
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296)
                     union
                     (select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296
                     minus
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1257)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1258
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296)
                     union
                     (select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296
                     minus
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1258)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1259
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296)
                     union
                     (select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296
                     minus
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1259)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1260
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296)
                     union
                     (select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296
                     minus
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1260)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1261
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296)
                     union
                     (select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=700296
                     minus
                     SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=1261)"
            A002 NewOffer_BusinessFlexSubsPlanPriority:
                "SELECT * FROM subs_plan a
                     where a.indep_prod_spec_id=200296
                     and a.priority<>1
                     and a.subs_plan_id=(select offer_id from offer b
                                         where b.offer_name='Business Flex'
                                         and b.state='A'
                                         and b.offer_type=7)
                     union
                     SELECT * FROM subs_plan a
                     where a.indep_prod_spec_id=200296
                     and a.priority<>2
                     and a.subs_plan_id=(select offer_id from offer b
                                         where b.offer_name='Business Flex - 1'
                                         and b.state='A'
                                         and b.offer_type=7)
                     union
                     SELECT * FROM subs_plan a
                     where a.indep_prod_spec_id=200296
                     and a.priority<>3
                     and a.subs_plan_id=(select offer_id from offer b
                                         where b.offer_name='Business Flex - 2'
                                         and b.state='A'
                                         and b.offer_type=7)
                     union
                     SELECT * FROM subs_plan a
                     where a.indep_prod_spec_id=200296
                     and a.priority<>4
                     and a.subs_plan_id=(select offer_id from offer b
                                         where b.offer_name='Business Flex - 3'
                                         and b.state='A'
                                         and b.offer_type=7)

                     union
                     SELECT * FROM subs_plan a
                     where a.indep_prod_spec_id=200296
                     and a.priority<>5
                     and a.subs_plan_id=(select offer_id from offer b
                                         where b.offer_name='Business Flex - 4 (EX-Tigo PABX)'
                                         and b.state='A'
                                         and b.offer_type=7)"
            A002 NewOffer_HybridOfferAttrCheck:
                "(SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Business Flybox SME'
                                   and b.offer_type=2)
                     minus
                     SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Business Flybox SME B2B'
                                   and b.offer_type=2))
                     union
                     (SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Business Flybox SME B2B'
                                   and b.offer_type=2)
                     minus
                     SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Business Flybox SME'
                                   and b.offer_type=2))
                     union
                     (SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Hybrid B2B'
                                   and b.offer_type=2)
                     minus
                     SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Hybrid'
                                   and b.offer_type=2))
                     union
                     (SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Hybrid'
                                   and b.offer_type=2)
                     minus
                     SELECT a.attr_id FROM offer_attr a
                     where exists (select 1 from offer b
                                   where a.offer_id=b.offer_id
                                   and b.offer_name='Hybrid B2B'
                                   and b.offer_type=2))"
            A002 NewOffer_HybridOfferGroupMemberValue:
                "(SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2634
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200375)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200375
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2634)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2636
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200156)
                     union
                     (SELECT b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=200156
                     minus
                     select b.offer_id
                     FROM offer_group a,offer_group_mem b
                     where a.offer_group_id=b.offer_group_id
                     and a.indep_prod_spec_id=2636)"
            A002 M-OTCAcctItemCodeIsNull:
                "SELECT a.*,length(a.acct_item_type_name)
                     FROM acct_item_type a
                     where a.acct_item_type_code is null
                     and exists (select 1 from offer_otc_price b
                                 where a.acct_item_type_id=b.acct_item_type_id)"
            A002 ZoneId_No_Migration:
                "SELECT *
                    FROM bwf_cond a
                    where function='GetIndepProdSpecId'
                    and a.zone_id is not null
                    and not exists (select 1 from zone b where a.zone_id = b.zone_id)"

A013:
    CPCTopic:
        UserList:
            cc

        BadData:
            A001 Service_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_features_groups a
                 where not exists (select 1
                          from mid_ocm_noipp_list b
                         where a.feature_name = b.features_name)
                   and not exists (select 1
                          from mid_ocm_relate_prod c
                         where a.feature_name = c.features)
                   and a.feature_type = 'Service'
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 3
                           and a.feature_name = a1.service_name
                           and a.service_code = a1.service_code
                           and a.feature_type = a1.service_type)"
            A001 Device_SingleOfferId_NotIn_Mapping:
                "select *
                from mid_ocm_features_groups a
               where a.feature_type = 'Device'
                 and a.groupe_name not in ('Leased Lines Accessoires')
                 and exists
               (select 1 from crm.gm_model b where a.service_code = b.mode_code)
                 and not exists
               (select 1
                        from mid_ocm_offerid_mapping a1
                       where a1.offer_type = 5
                         and a.feature_name = a1.service_name
                         and 'Single Sale ' || a.service_code = a1.service_code
                         and a.feature_type = a1.service_type)"
            A001 Device_BundleOfferId_NotIn_Mapping:
                "select *
                from mid_ocm_features_groups a
               where a.feature_type = 'Device'
                 and a.groupe_name not in ('Leased Lines Accessoires')
                 and exists
               (select 1 from crm.gm_model b where a.service_code = b.mode_code)
                 and exists (select 1 from mid_ocm_leasing_goods a2 where a.service_code = a2.goods_code)
                 and not exists
               (select 1
                        from mid_ocm_offerid_mapping a1
                       where a1.offer_type = 5
                         and a.feature_name = a1.service_name
                         and 'Bundle Offer ' || a.service_code = a1.service_code
                         and a.feature_type = a1.service_type)"
            A001 NewIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_offer_specification b
                 where b.remark in ('LEASED LINE', 'VPN','SVA ONLY', 'MOBILE PRO','PRE-PERSO', 'ROUTAGE', 'MIX', 'SCHLUMBERGER')
                   and not exists (select 1
                          from mid_ocm_offerid_mapping c
                         where b.offer_name = c.service_name
                           and c.offer_type = 4
                           and (b.remark = c.service_code or c.service_code = '0'))"

            A001 BundleIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_features_groups a
                 where a.feature_type = 'Bundle'
                   and a.feature_name like 'IPP Benefit%%'
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 4
                           and a1.service_name = a.feature_name
                           and a1.service_type = a.feature_type)"

            A001 LeasedLineIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_features_groups a
                 where a.feature_type = 'Device'
                   and a.groupe_name = 'Leased Lines Accessoires'
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 4
                           and a1.service_name = a.feature_name
                           and a1.service_code = a.service_code)"

            A001 LeasingIPP_OfferId_NotIn_Mapping:
                "select *
                  from mid_ocm_offer_specification a
                 where a.remark in ('LEASING12', 'LEASING24', 'LEASING BUNDLE')
                   and not exists (select 1
                          from mid_ocm_offerid_mapping a1
                         where a1.offer_type = 4
                           and a1.service_name = a.offer_name
                           and a1.service_code = a.remark)"
            A001 LeasingIPPGroup_Is_Missing:
                "select distinct a.offer_id, b.offer_ver_id, a.lifecycle_type
                  from lifecycle_apply a, offer_ver b, offer_group d, subs_plan e
                 where a.lifecycle_type in (2, 4)
                   and a.offer_id = b.offer_id
                   and (b.exp_date is null or b.exp_date > sysdate)
                   and a.offer_id = e.subs_plan_id
                   and e.indep_prod_spec_id not in ('200001', '200002', '200012')
                   and d.offer_group_name in
                       ('LEASING 12Month Individual',
                        'LEASING 24Month Individual',
                        'LEASING WITH BUNDLE 12Month Individual')
                   and not exists (select 1
                          from subs_plan_offer_select c
                         where c.offer_group_id = d.offer_group_id
                           and b.offer_ver_id = c.offer_ver_id)"
            A001 RelatedProd_Need_PricePlan:
                "select *
                from offer a
               where a.offer_type = 3
                 and a.offer_id not in (300000)
                 and not exists (select 1
                        from offer_rela b
                       where b.dest_offer_id = a.offer_id
                         and b.rela_type = 'D')"
            A001 AntiBillShock_Group_Is_Not_Single_Choice:
                "select *
                from offer_group a1
               where exists (select *
                        from offer_group_mem a, offer b
                       where a.offer_id = b.offer_id
                         and b.offer_name like '%%AntiBillShock%%'
                         and a1.offer_group_id = a.offer_group_id)
                 and a1.group_type != 'B'"
            A001 SubsPlan_No_OfferGroup_Core:
                "select *
                  from offer a
                 where a.offer_type = 7
                   and (a.comments not in ('GSM CUG', 'LEASED LINE', 'VPN', 'GSM VPN', 'ROUTAGE')
                    or a.comments is null)
                   and a.offer_id not in (700143, 700105)
                   and not exists
                 (select 1
                          from offer_ver b, subs_plan_offer_select c, offer_group d
                         where a.offer_id = b.offer_id
                           and b.offer_ver_id = c.offer_ver_id
                           and c.offer_group_id = d.offer_group_id
                           and d.offer_group_name = 'Service Core GSM')"

            A001 SubsPlan_No_OfferGroup_Additionel:
                "select *
                  from offer a
                 where a.offer_type = 7
                   and (a.comments not in ('GSM CUG', 'LEASED LINE', 'VPN', 'GSM VPN', 'ROUTAGE')
                    or a.comments is null)
                   and a.offer_id not in (700143, 700105)
                   and not exists
                 (select 1
                          from offer_ver b, subs_plan_offer_select c, offer_group d
                         where a.offer_id = b.offer_id
                           and b.offer_ver_id = c.offer_ver_id
                           and c.offer_group_id = d.offer_group_id
                           and d.offer_group_name = 'Service Additionel GSM')"
            A001 OFFER_NOIN_OFFER_GROUP:
                "select *
                from offer a
               where a.offer_type = 4
                 and not exists
               (select 1 from offer_group_mem b where a.offer_id = b.offer_id)
                 and not exists (select * from acct_price_plan c where a.offer_id = c.price_plan_id)
                 and a.offer_id not in (400180, -100, 400160, 400080, 400000)
               order by a.offer_name"

            A001 OFFER_DUPLICATE_IN_OFFER_GROUP:
                "select *
                  from offer_group_mem a
                 where exists (select 1
                          from offer_group_mem b
                         where a.offer_group_id = b.offer_group_id
                           and a.offer_id = b.offer_id
                           and a.offer_group_mem_id != b.offer_group_mem_id)"

            A001 RECURRING_RE_NO_SORT_RULE:
                "select *
                  from re_pp_recurring a
                 where not exists (select 1 from sort_recurring b where a.re_id = b.re_id)"

            A001 OFFER_CATG_MEM_OFFER_DUPLICAT:
                "select offer_id
               from offer_catg_mem a, offer_catg b
               where a.offer_catg_id = b.offer_catg_id
                 and b.offer_catg_class = 'B'
                 and a.offer_id is not null
               group by a.offer_id having count(1)>1"
